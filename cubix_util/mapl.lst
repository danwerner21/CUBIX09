                      (         mapl.asm):00001         ;        TITLE   MICRO APL 1.0
                      (         mapl.asm):00002         ;*
                      (         mapl.asm):00003         ;* MICRO-APL 1.0
                      (         mapl.asm):00004         ;*
                      (         mapl.asm):00005         ;* Simple APL SUBSET for the 6809, using the standard ASCII
                      (         mapl.asm):00006         ;* character set. Lower case characters are used instead of
                      (         mapl.asm):00007         ;* special APL characters to represent some of the primitive
                      (         mapl.asm):00008         ;* functions. The function of the "SHIFT" key is reversed to
                      (         mapl.asm):00009         ;* allow easier operation (SHIFT = special functions)
                      (         mapl.asm):00010         ;*
                      (         mapl.asm):00011         ;* SYSTEM COMMANDS:
                      (         mapl.asm):00012         ;*
                      (         mapl.asm):00013         ;*  )OFF, )LIB, )SI, )REL, )RESET, )LOAD, )SAVE, )WSID, )DROP,
                      (         mapl.asm):00014         ;*  )CLEAR, )SYS, )VARS, )FNS, )LBLS, )STAT
                      (         mapl.asm):00015         ;*
                      (         mapl.asm):00016         ;* MONADIC (SINGLE OPERAND) OPERATORS:
                      (         mapl.asm):00017         ;*
                      (         mapl.asm):00018         ;*  i - INDEX VECTOR GENERATION        ; p - SHAPE OF OPERAND
                      (         mapl.asm):00019         ;*  r - REVERSE OPERAND        ;         c - CLASSIFICATION
                      (         mapl.asm):00020         ;*  e - EXECUTE STRING OPERAND        ; s - CONVERT TO STRING
                      (         mapl.asm):00021         ;*  ? - ROLL RANDOM VECTOR        ; ^ - SORT VECTOR
                      (         mapl.asm):00022         ;*  b - BRANCH TO LABEL
                      (         mapl.asm):00023         ;*
                      (         mapl.asm):00024         ;* DYADIC (TWO OPERAND) OPERATORS:
                      (         mapl.asm):00025         ;*
                      (         mapl.asm):00026         ;*  + - ADDITION        ;        ; - - SUBTRACTION
                      (         mapl.asm):00027         ;*  x - MULTIPLICATION        ;  % - DIVISION
                      (         mapl.asm):00028         ;*  m - MODULUS        ;        ; & - LOGICAL AND
                      (         mapl.asm):00029         ;*  ! - LOGICAL OR        ;      | - EXCLUSIVE OR
                      (         mapl.asm):00030         ;*  g - GREATEST        ;        ; l - LEAST
                      (         mapl.asm):00031         ;* == - TEST FOR EQUALITY        ;-= - TEST FOR INEQUALITY
                      (         mapl.asm):00032         ;*  > - TEST FOR GREATER THAN        ; < - TEST FOR LESS THAN
                      (         mapl.asm):00033         ;* >= - TEST FOR GREATOR OR EQUAL       <= - TEST FOR LESS OR EQUAL
                      (         mapl.asm):00034         ;*  = - ASSIGNMENT        ;      / - EXTRACTION
                      (         mapl.asm):00035         ;*  ; - JOIN        ;        ; t - TAKE
                      (         mapl.asm):00036         ;*  d - DROP        ;        ; f - FIND
                      (         mapl.asm):00037         ;*  | - EXCLUSIVE OR        ;    u - UNION OF SETS
                      (         mapl.asm):00038         ;*  n - TRANSLATE
                      (         mapl.asm):00039         ;*
                      (         mapl.asm):00040         ;* OTHER OPERATORS:
                      (         mapl.asm):00041         ;*
                      (         mapl.asm):00042         ;* [] - INDEX ACCESS        ;   () - NEST
                      (         mapl.asm):00043         ;*  \ - TRAVEL        ;        ; $ - FUNCTION DEFINITION
                      (         mapl.asm):00044         ;*
                      (         mapl.asm):00045         ;* SYSTEM VARIABLES:
                      (         mapl.asm):00046         ;*
                      (         mapl.asm):00047         ;*  B$ - BUFFER SIZE        ;   C$ - CHARACTER VECTOR
                      (         mapl.asm):00048         ;*  F$ - FORMATTED I/O        ; K$ - READ KEYSTROKE
                      (         mapl.asm):00049         ;*  L$ - LINE NUMBER        ;   O$ - ORIGIN VALUE
                      (         mapl.asm):00050         ;*  P$ - PARAMETER        ;     R$ - REMAINDER
                      (         mapl.asm):00051         ;*  S$ - RANDOM SEED        ;   T$ - TERMINAL I/O
                      (         mapl.asm):00052         ;*  W$ - AVAILABEL WORKSPACE
                      (         mapl.asm):00053         ;*
                      (         mapl.asm):00054         ;* Copyright 1984-2005 Dave Dunfield
                      (         mapl.asm):00055         ;* All rights reserved.
                      (         mapl.asm):00056         ;*
                      (         mapl.asm):00057         ;* DATA AREAS
                      (         mapl.asm):00058         ;*
     2000             (         mapl.asm):00059         OSRAM           = $2000                           ;APPLICATION RAM AREA
     DBFF             (         mapl.asm):00060         OSEND           = $DBFF                           ;END OF GENERAL RAM
     D000             (         mapl.asm):00061         OSUTIL          = $D000                           ;UTILITY ADDRESS SPACE
     2000             (         mapl.asm):00062         ROM             = OSRAM                           ;PROGRAMM GOES HERE
     3C00             (         mapl.asm):00063         RAM             = OSRAM+7168    DATA GOES HERE
     CC00             (         mapl.asm):00064         HIRAM           = OSUTIL-1024   TOP OF RAM
                      (         mapl.asm):00065         ;*
     3C82             (         mapl.asm):00066         LEVEL           = RAM+130
     3C83             (         mapl.asm):00067         EXEC            = LEVEL+1
     3C84             (         mapl.asm):00068         TEMP            = EXEC+1
     3C86             (         mapl.asm):00069         TEMP0           = TEMP+2
     3C88             (         mapl.asm):00070         TEMP1           = TEMP0+2
     3C8A             (         mapl.asm):00071         TEMP2           = TEMP1+2
     3C8C             (         mapl.asm):00072         TEMP3           = TEMP2+2
     3C8E             (         mapl.asm):00073         TEMP4           = TEMP3+2
     3C90             (         mapl.asm):00074         TEMP5           = TEMP4+2
     3C92             (         mapl.asm):00075         TXTTMP          = TEMP5+2
     3C94             (         mapl.asm):00076         PARM            = TXTTMP+2
     3C96             (         mapl.asm):00077         LINCT           = PARM+2
     3C98             (         mapl.asm):00078         GOTO            = LINCT+2
     3C9A             (         mapl.asm):00079         NAMPTR          = GOTO+2
     3C9C             (         mapl.asm):00080         DIVREM          = NAMPTR+2
     3C9E             (         mapl.asm):00081         TXTPTR          = DIVREM+2
     3CA0             (         mapl.asm):00082         SAVSTK          = TXTPTR+2
     3CA2             (         mapl.asm):00083         RAMTOP          = SAVSTK+2
     3CA4             (         mapl.asm):00084         ASSFLG          = RAMTOP+2
     3CA5             (         mapl.asm):00085         ERRFLG          = ASSFLG+1
     3CA6             (         mapl.asm):00086         INPSTK          = ERRFLG+1
     3CA8             (         mapl.asm):00087         ID              = INPSTK+2
     4000             (         mapl.asm):00088         STACK           = RAM+1024
                      (         mapl.asm):00089         ;* WORKSPACE CONTENTS
     4000             (         mapl.asm):00090         FREE            = RAM+1024
     4002             (         mapl.asm):00091         ORIGIN          = FREE+2
     4004             (         mapl.asm):00092         SEED            = ORIGIN+2
     4006             (         mapl.asm):00093         BUFSIZ          = SEED+2
     4008             (         mapl.asm):00094         FREMEM          = BUFSIZ+2
     400A             (         mapl.asm):00095         SYMTAB          = FREMEM+2
                      (         mapl.asm):00096         ;*
                      (         mapl.asm):00097                 ORG     ROM
                      (         mapl.asm):00098         ;* PROGRAM ENTRY
2000                  (         mapl.asm):00099         APL
2000 170463           (         mapl.asm):00100                 LBSR    SYSMSG
2003 4D41504C20766572 (         mapl.asm):00101                 FCN     'MAPL version 1.0'
     73696F6E20312E30
     00
2014 4F               (         mapl.asm):00102                 CLRA                                      ;     INDICATE ERR MSGS
2015 3F               (         mapl.asm):00103                 SWI
2016 69               (         mapl.asm):00104                 FCB     105                               ;TURN OFF ERROR MESSAGES
2017 108E3A4C         (         mapl.asm):00105                 LDY     #CONTIN                           ;POINT TO CONTINUE NAME
201B 3F               (         mapl.asm):00106                 SWI
201C 0A               (         mapl.asm):00107                 FCB     10                                ;GET NAME
201D 3108             (         mapl.asm):00108                 LEAY    8,X                               ;POINT TO IT
201F 3F               (         mapl.asm):00109                 SWI
2020 44               (         mapl.asm):00110                 FCB     68                                ;DOES IT EXIST?
2021 102700A0         (         mapl.asm):00111                 LBEQ    LDGO                              ;IF SO, LOAD IT
2025 201C             (         mapl.asm):00112                 BRA     DEFCLR                            ;DEFAULT CLEAR
                      (         mapl.asm):00113         ;* ')CLEAR' COMMAND
2027                  (         mapl.asm):00114         CLEAR
2027 170464           (         mapl.asm):00115                 LBSR    SKIP                              ;LOOK FOR PARAMETER
202A 2717             (         mapl.asm):00116                 BEQ     DEFCLR                            ;ASSUME DEFAULT
202C                  (         mapl.asm):00117         CLER1
202C A6A0             (         mapl.asm):00118                 LDA     ,Y+                               ;GET CHAR
202E 810D             (         mapl.asm):00119                 CMPA    #$0D                              ;CONTINUE
2030 26FA             (         mapl.asm):00120                 BNE     CLER1                             ;TO END OF LINE
2032 313F             (         mapl.asm):00121                 LEAY    -1,Y                              ;BACKUP TO CR
2034 170468           (         mapl.asm):00122                 LBSR    SKBK                              ;BACKUP TO NUMBER
2037 170488           (         mapl.asm):00123                 LBSR    VALNUM                            ;VALID DIGIT?
203A 10261948         (         mapl.asm):00124                 LBNE    UNCMD                             ;INVALID
203E 170496           (         mapl.asm):00125                 LBSR    GETDEC                            ;GET DECIMAL
2041 2003             (         mapl.asm):00126                 BRA     CLRGO                             ;CONTINUE
2043                  (         mapl.asm):00127         DEFCLR
2043 CC03E8           (         mapl.asm):00128                 LDD     #1000                             ;DEFAULT SYMBOL TABLE SIZE
2046                  (         mapl.asm):00129         CLRGO
2046 C3400B           (         mapl.asm):00130                 ADDD    #SYMTAB+1       OFFSET FOR SYMBOL TABLE ADDRESS
2049 FD4008           (         mapl.asm):00131                 STD     FREMEM                            ;POINT TO FREE MEMORY
204C FD4000           (         mapl.asm):00132                 STD     >FREE                             ;INDICATE HOW MUCH IS FREE
204F 7F400A           (         mapl.asm):00133                 CLR     >SYMTAB                           ;REMOVE SYMBOLS
2052 CC0400           (         mapl.asm):00134                 LDD     #1024                             ;DEFAULT BUFFER SIZE
2055 FD4006           (         mapl.asm):00135                 STD     BUFSIZ                            ;SAVE BUFFER SIZE
2058 108E206C         (         mapl.asm):00136                 LDY     #CID                              ;POINT TO NEW ID
205C 1716AD           (         mapl.asm):00137                 LBSR    WSISET                            ;SET UP WSID
205F CC0001           (         mapl.asm):00138                 LDD     #1                                ;GET A 1 ORIGIN
2062 FD4002           (         mapl.asm):00139                 STD     ORIGIN                            ;SAVE ORIGIN VALUE
2065 43               (         mapl.asm):00140                 COMA                                      ;     GARBAGE VALUE
2066 FD4004           (         mapl.asm):00141                 STD     SEED                              ;SET UP SEED
2069                  (         mapl.asm):00142         CLMSG
2069 1703FA           (         mapl.asm):00143                 LBSR    SYSMSG                            ;DISPLAY MESSAGE
206C                  (         mapl.asm):00144         CID
206C 434C454152205753 (         mapl.asm):00145                 FCN     'CLEAR WS'
     00
2075 10CE4000         (         mapl.asm):00146                 LDS     #STACK                            ;POINT TO SYSTEM STACK
2079 10FF3CA0         (         mapl.asm):00147                 STS     SAVSTK                            ;INTIALIZE IT
                      (         mapl.asm):00148         ;* ')RESET' SYSTEM COMMAND
207D                  (         mapl.asm):00149         RESET
207D 171833           (         mapl.asm):00150                 LBSR    DOREST                            ;DO A RESET
                      (         mapl.asm):00151         ;* COMMAND INTERPRETER
2080                  (         mapl.asm):00152         CMD
2080 8D28             (         mapl.asm):00153                 BSR     INIWS                             ;INIT WORKSPACE PARMS
2082 10FE3CA0         (         mapl.asm):00154                 LDS     SAVSTK                            ;SET UP STACK
2086 1703D1           (         mapl.asm):00155                 LBSR    DSPSTR                            ;DISPLAY MESSAGE
2089 20202020202000   (         mapl.asm):00156                 FCN     '      '        SPACE OVER
2090 17036F           (         mapl.asm):00157                 LBSR    GETRAM                            ;GET A LINE OF INPUT
2093 1703F8           (         mapl.asm):00158                 LBSR    SKIP                              ;SKIP TO COMMAND
2096 27E8             (         mapl.asm):00159                 BEQ     CMD                               ;IF NONE, TRY AGAIN
2098 812A             (         mapl.asm):00160                 CMPA    #'*'                              ;COMMENT?
209A 27E4             (         mapl.asm):00161                 BEQ     CMD                               ;IF SO, GO FOR IT
209C 8129             (         mapl.asm):00162                 CMPA    #')'                              ;SYSTEM COMMAND?
209E 10260077         (         mapl.asm):00163                 LBNE    EDIT                              ;NO, PROCESS EXPRESSION
20A2 8E39D5           (         mapl.asm):00164                 LDX     #CMDTAB                           ;POINT TO COMMAND TABLE
20A5 1712AF           (         mapl.asm):00165                 LBSR    CLOOK                             ;LOOK UP AND EXECUTE COMMAND
20A8 20D6             (         mapl.asm):00166                 BRA     CMD                               ;GET NEXT
20AA                  (         mapl.asm):00167         INIWS
20AA 7F3C83           (         mapl.asm):00168                 CLR     EXEC                              ;INSURE NOTHING RUNNING
20AD CC0000           (         mapl.asm):00169                 LDD     #0
20B0 FD3CA6           (         mapl.asm):00170                 STD     INPSTK                            ;SAVE INPUT STACK POINTER
20B3 FC3CA2           (         mapl.asm):00171                 LDD     RAMTOP                            ;GET TOP OF RAM
20B6 FD3C90           (         mapl.asm):00172                 STD     TEMP5                             ;SAVE FREE MEMORY INDICATOR
20B9 39               (         mapl.asm):00173                 RTS
                      (         mapl.asm):00174         ;* ')LOAD' COMMAND
20BA                  (         mapl.asm):00175         LOAD
20BA 170513           (         mapl.asm):00176                 LBSR    FILNAM                            ;GET FILENAME
20BD 3F               (         mapl.asm):00177                 SWI
20BE 0A               (         mapl.asm):00178                 FCB     10                                ;TELL DOS
20BF 102618C3         (         mapl.asm):00179                 LBNE    UNCMD                             ;GET UPSET IF BAD
20C3 3108             (         mapl.asm):00180                 LEAY    8,X                               ;POINT TO NAME
20C5                  (         mapl.asm):00181         LDGO
20C5 8E4000           (         mapl.asm):00182                 LDX     #FREE                             ;POINT TO FREE SPACE
20C8 3F               (         mapl.asm):00183                 SWI
20C9 35               (         mapl.asm):00184                 FCB     53                                ;LOAD FILE
20CA 2711             (         mapl.asm):00185                 BEQ     LOA2                              ;IT'S OK, CONTINUE
20CC                  (         mapl.asm):00186         LOA1
20CC 170397           (         mapl.asm):00187                 LBSR    SYSMSG                            ;INDICATE SYSTEM ERROR
20CF 5753204E4F542046 (         mapl.asm):00188                 FCN     'WS NOT FOUND'
     4F554E4400
20DC 39               (         mapl.asm):00189                 RTS
                      (         mapl.asm):00190         ;* PERFORM INIT
20DD                  (         mapl.asm):00191         LOA2
20DD 17162C           (         mapl.asm):00192                 LBSR    WSISET                            ;SET NAME
20E0 10CE4000         (         mapl.asm):00193                 LDS     #STACK                            ;RESET STACK
20E4 10FF3CA0         (         mapl.asm):00194                 STS     SAVSTK                            ;SAVE NEW
20E8 1717C8           (         mapl.asm):00195                 LBSR    DOREST                            ;PERFORM RESET
20EB 8DBD             (         mapl.asm):00196                 BSR     INIWS                             ;INIT WORKSPACE
20ED 17036A           (         mapl.asm):00197                 LBSR    DSPSTR                            ;DISPLAY STRING
20F0 5753494420495320 (         mapl.asm):00198                 FCN     'WSID IS '      MESSAGE TO DISPLAY
     00
20F9 171624           (         mapl.asm):00199                 LBSR    DWSID                             ;DISPLAY
20FC 108E3A4A         (         mapl.asm):00200                 LDY     #LXNAME                           ;POINT TO LATENT EXPRESSION
2100 170408           (         mapl.asm):00201                 LBSR    LOOKUP                            ;IS IT FOUND?
2103 2603             (         mapl.asm):00202                 BNE     CMD1                              ;NO, SKIP IT
2105                  (         mapl.asm):00203         PROCMD
2105 1704E5           (         mapl.asm):00204                 LBSR    EXPR                              ;EVALUATE EXPRESSION
2108                  (         mapl.asm):00205         CMD1
2108 16FF75           (         mapl.asm):00206                 LBRA    CMD                               ;PERFORM COMMAND
                      (         mapl.asm):00207         ;* ')DROP' COMMAND
210B                  (         mapl.asm):00208         DROP
210B 1704C2           (         mapl.asm):00209                 LBSR    FILNAM                            ;GET FILENAME
210E 3F               (         mapl.asm):00210                 SWI
210F 0A               (         mapl.asm):00211                 FCB     10                                ;TELL DOS
2110 10261872         (         mapl.asm):00212                 LBNE    UNCMD                             ;GET UPSET IF INVALID
2114 3F               (         mapl.asm):00213                 SWI
2115 49               (         mapl.asm):00214                 FCB     73                                ;THROW IT AWAY
2116 26B4             (         mapl.asm):00215                 BNE     LOA1                              ;IF NOT FOUND
2118 39               (         mapl.asm):00216                 RTS
                      (         mapl.asm):00217         ;*
                      (         mapl.asm):00218         ;* FUNCTION EDITOR
                      (         mapl.asm):00219         ;*
2119                  (         mapl.asm):00220         EDIT
2119 8124             (         mapl.asm):00221                 CMPA    #'$'                              ;CREATE A FUNCTION?
211B 1026FFE6         (         mapl.asm):00222                 LBNE    PROCMD                            ;PROCESS COMMAND
211F 10BF3C84         (         mapl.asm):00223                 STY     TEMP                              ;SAVE POINTER
2123 17038F           (         mapl.asm):00224                 LBSR    SFSYM                             ;SKIP FORWARD
2126 2611             (         mapl.asm):00225                 BNE     NAMOK                             ;NAME IS OK
2128                  (         mapl.asm):00226         DEFERR
2128 17033B           (         mapl.asm):00227                 LBSR    SYSMSG                            ;DISPLAY MESSAGE,
212B 4445464E20455252 (         mapl.asm):00228                 FCN     'DEFN ERROR'
     4F5200
2136 16FF47           (         mapl.asm):00229                 LBRA    CMD                               ;AND BACK FOR COMMAND
2139                  (         mapl.asm):00230         NAMOK
2139 10BF3C8C         (         mapl.asm):00231                 STY     TEMP3                             ;SAVE Y REG
213D 171773           (         mapl.asm):00232                 LBSR    DOREST                            ;PERFORM A RESET
2140 10BE3C8C         (         mapl.asm):00233                 LDY     TEMP3                             ;RESTORE
2144 313F             (         mapl.asm):00234                 LEAY    -1,Y                              ;BACKUP TO FIRST CHAR OF SYMBOL
2146 4F               (         mapl.asm):00235                 CLRA
2147 5F               (         mapl.asm):00236                 CLRB                                      ;     GET A ZERO
2148 FD3C8C           (         mapl.asm):00237                 STD     TEMP3                             ;INITIALIZE LINE NUMBER
214B 1703BD           (         mapl.asm):00238                 LBSR    LOOKUP                            ;LOOK FOR ENTRY
214E 2720             (         mapl.asm):00239                 BEQ     FUNFND                            ;FUNCTION EXISTS
2150 10BE3C84         (         mapl.asm):00240                 LDY     TEMP                              ;POINT TO NAME
2154 17032C           (         mapl.asm):00241                 LBSR    SKP                               ;ADVANCE TO NEXT CRAP
2157 BE4000           (         mapl.asm):00242                 LDX     FREE                              ;POINT TO FREE RAM
215A 6F80             (         mapl.asm):00243                 CLR     ,X+                               ;RESAVE
215C BF3C8A           (         mapl.asm):00244                 STX     TEMP2                             ;SAVE POINTER TO FUNCTION BEING EDITED
215F                  (         mapl.asm):00245         CRED1
215F A6A0             (         mapl.asm):00246                 LDA     ,Y+                               ;GET CHAR
2161 A780             (         mapl.asm):00247                 STA     ,X+                               ;SAVE
2163 810D             (         mapl.asm):00248                 CMPA    #$0D                              ;END?
2165 26F8             (         mapl.asm):00249                 BNE     CRED1                             ;NO, CONTINUE
2167 86FF             (         mapl.asm):00250                 LDA     #$FF                              ;GET END OF FUNCTION INDICATOR
2169 A780             (         mapl.asm):00251                 STA     ,X+                               ;SAVE IN RAM
216B 7C3C8D           (         mapl.asm):00252                 INC     TEMP3+1                           ;START ON LINE 1
216E 2035             (         mapl.asm):00253                 BRA     EDTRUN                            ;EDIT THE FUNCTION
                      (         mapl.asm):00254         ;* FUNCTION EXISTED, COPY IT OVER
2170                  (         mapl.asm):00255         FUNFND
2170 BF3C84           (         mapl.asm):00256                 STX     TEMP                              ;SAVE POINTER TO SYMBOL TABLE ENTRY
2173 4D               (         mapl.asm):00257                 TSTA                                      ;     IS IT AN UNLOCKED FUNCTION?
2174 26B2             (         mapl.asm):00258                 BNE     DEFERR                            ;CAN'T EDIT UNLESS IT'S A FUNCTION
2176 10AE85           (         mapl.asm):00259                 LDY     B,X                               ;GET POINTER TO FUNCTION ADDRESS
2179 BE4000           (         mapl.asm):00260                 LDX     FREE                              ;POINT TO AVAILABEL MEMORY
217C 6F80             (         mapl.asm):00261                 CLR     ,X+                               ;CLEAR BYTE FOR FUNCTION
217E BF3C8A           (         mapl.asm):00262                 STX     TEMP2                             ;RESAVE
                      (         mapl.asm):00263         ;* INSERT NAME AS LINE #0
2181 FE3C84           (         mapl.asm):00264                 LDU     TEMP                              ;POINT TO SYMBOL TABLE ENTRY AGAIN
2184 E6C1             (         mapl.asm):00265                 LDB     ,U++                              ;GET LENGTH
2186 C41F             (         mapl.asm):00266                 ANDB    #$1F                              ;MASK LENGTH
2188 33C5             (         mapl.asm):00267                 LEAU    B,U                               ;INDICATE THIS IS IT
218A                  (         mapl.asm):00268         EDX1
218A A6C2             (         mapl.asm):00269                 LDA     ,-U                               ;GET CHARACTER
218C A780             (         mapl.asm):00270                 STA     ,X+                               ;SAVE IN NAME
218E 5A               (         mapl.asm):00271                 DECB                                      ;     REDUCE COUNT
218F 26F9             (         mapl.asm):00272                 BNE     EDX1                              ;AND KEEP DOING IT
2191                  (         mapl.asm):00273         CPYFUN
2191 A6A0             (         mapl.asm):00274                 LDA     ,Y+                               ;GET CHARACTER FROM FUNCTION
2193 A780             (         mapl.asm):00275                 STA     ,X+                               ;SAVE IN WORKSPACE BUFFER
2195 810D             (         mapl.asm):00276                 CMPA    #$0D                              ;END OF LINE?
2197 2608             (         mapl.asm):00277                 BNE     CPYF1                             ;NO, ADVANCE TO NEXT
2199 7C3C8D           (         mapl.asm):00278                 INC     TEMP3+1                           ;ADVANCE LINE NUMBER
219C 2403             (         mapl.asm):00279                 BCC     CPYF1                             ;AND SKIP IF NO CARRY
219E 7C3C8C           (         mapl.asm):00280                 INC     TEMP3                             ;ADVANCE HIGH DIGIT
21A1                  (         mapl.asm):00281         CPYF1
21A1 81FF             (         mapl.asm):00282                 CMPA    #$FF                              ;END OF FUNCTION?
21A3 26EC             (         mapl.asm):00283                 BNE     CPYFUN                            ;CONTINUE TILL WE COPY IT ALL
                      (         mapl.asm):00284         ;* START UP THE EDITOR
21A5                  (         mapl.asm):00285         EDTRUN
21A5 301F             (         mapl.asm):00286                 LEAX    -1,X                              ;BACKUP TO END OF FILE MARKER
21A7                  (         mapl.asm):00287         EDTLIN
21A7 865B             (         mapl.asm):00288                 LDA     #'['                              ;GET STARTING BRACE
21A9 1702CC           (         mapl.asm):00289                 LBSR    PUTCHR                            ;DISPLAY
21AC FC3C8C           (         mapl.asm):00290                 LDD     TEMP3                             ;GET LINE NUMBER
21AF 170D4C           (         mapl.asm):00291                 LBSR    DECOUT                            ;DISPLAY
21B2 865D             (         mapl.asm):00292                 LDA     #']'                              ;GET POINTER
21B4 1702C1           (         mapl.asm):00293                 LBSR    PUTCHR                            ;DISPLAY
21B7 1702C5           (         mapl.asm):00294                 LBSR    SPACE                             ;AND A BLANK
21BA 170245           (         mapl.asm):00295                 LBSR    GETRAM                            ;GET A LINE
21BD 1702C3           (         mapl.asm):00296                 LBSR    SKP                               ;IS IT COMMAND
21C0 27E5             (         mapl.asm):00297                 BEQ     EDTLIN                            ;BAD, TRY AGAIN
21C2 8124             (         mapl.asm):00298                 CMPA    #'$'                              ;END OF DEFINITION
21C4 102700E9         (         mapl.asm):00299                 LBEQ    RESAVE                            ;RESAVE EDITED FUNCTION
21C8 815B             (         mapl.asm):00300                 CMPA    #'['                              ;IS IT COMMAND?
21CA 2724             (         mapl.asm):00301                 BEQ     EDCMD                             ;EXECUTE EDIT COMMAND
21CC 1701F4           (         mapl.asm):00302                 LBSR    DELETE                            ;DELETE THIS LINE
21CF 170210           (         mapl.asm):00303                 LBSR    INSERT                            ;INSERT THIS LINE
21D2                  (         mapl.asm):00304         INCLIN
21D2 7C3C8D           (         mapl.asm):00305                 INC     TEMP3+1                           ;ADVANCE LINE NUMBER
21D5 24D0             (         mapl.asm):00306                 BCC     EDTLIN                            ;IF NO CARRY, EVERYTHING OK
21D7 7C3C8C           (         mapl.asm):00307                 INC     TEMP3                             ;AND GO FOR BROKE
21DA 20CB             (         mapl.asm):00308                 BRA     EDTLIN                            ;EDIT LINE
21DC                  (         mapl.asm):00309         ERRDEF
21DC 3410             (         mapl.asm):00310                 PSHS    X                                 ;SAVE POINTER
21DE 170285           (         mapl.asm):00311                 LBSR    SYSMSG                            ;DISPLAY MESSAGE
21E1 4445464E20455252 (         mapl.asm):00312                 FCN     'DEFN ERROR'
     4F5200
21EC 3510             (         mapl.asm):00313                 PULS    X                                 ;RESTORE
21EE 20B7             (         mapl.asm):00314                 BRA     EDTLIN                            ;BACK TO LINE
                      (         mapl.asm):00315         ;*
                      (         mapl.asm):00316         ;* EDITOR COMMAND
                      (         mapl.asm):00317         ;*
21F0                  (         mapl.asm):00318         EDCMD
21F0 3121             (         mapl.asm):00319                 LEAY    1,Y                               ;SKIP '['
21F2 170299           (         mapl.asm):00320                 LBSR    SKIP                              ;ADVANCE TO NEXT
21F5 8124             (         mapl.asm):00321                 CMPA    #'$'                              ;IS IT DISPLAY
21F7 2634             (         mapl.asm):00322                 BNE     EDC1                              ;NOT A QUAD
21F9 1702AC           (         mapl.asm):00323                 LBSR    SFNUM                             ;LOOK FOR NUMBER
21FC 2705             (         mapl.asm):00324                 BEQ     EDC2                              ;SHOW ALL
21FE 1702D8           (         mapl.asm):00325                 LBSR    GETDIG                            ;GET NUMBER
2201 2013             (         mapl.asm):00326                 BRA     EDC3                              ;IT'S OK
2203                  (         mapl.asm):00327         EDC2
2203 170254           (         mapl.asm):00328                 LBSR    DSPSTR                            ;DISPLAY MSG
2206 20202020202400   (         mapl.asm):00329                 FCN     '     $'        DISPLAY
220D BE3C8A           (         mapl.asm):00330                 LDX     TEMP2                             ;POINT TO SPACE
2210 170177           (         mapl.asm):00331                 LBSR    OULI                              ;DISPLAY
2213 CC0001           (         mapl.asm):00332                 LDD     #1                                ;DISPLAY LINE 1
2216                  (         mapl.asm):00333         EDC3
2216 17017D           (         mapl.asm):00334                 LBSR    FNDLIN                            ;POINT TO LINE
2219                  (         mapl.asm):00335         DISP
2219 A684             (         mapl.asm):00336                 LDA     ,X                                ;ARE WE AT END
221B 81FF             (         mapl.asm):00337                 CMPA    #$FF                              ;TEST FOR END OF FILE
221D 2726             (         mapl.asm):00338                 BEQ     EDC5                              ;QUIT IF END
221F 170143           (         mapl.asm):00339                 LBSR    DSPLIN                            ;DISPLAY A LINE
2222 FC3C8C           (         mapl.asm):00340                 LDD     TEMP3                             ;GET NUMBER
2225 C30001           (         mapl.asm):00341                 ADDD    #1                                ;ADVANCE
2228 FD3C8C           (         mapl.asm):00342                 STD     TEMP3                             ;AND RESAVE
222B 20EC             (         mapl.asm):00343                 BRA     DISP                              ;AND CONTINUE
                      (         mapl.asm):00344         ;* DELETE LINES
222D                  (         mapl.asm):00345         EDC1
222D 8144             (         mapl.asm):00346                 CMPA    #'D'                              ;IS IT DELETE LINE?
222F 2617             (         mapl.asm):00347                 BNE     EDC4                              ;NO, TRY POSITION
2231 170274           (         mapl.asm):00348                 LBSR    SFNUM                             ;LOOK FOR LINE NUMBER
2234 27A6             (         mapl.asm):00349                 BEQ     ERRDEF                            ;CAN'T DELETE
2236 1702A0           (         mapl.asm):00350                 LBSR    GETDIG                            ;GET NUMBER
2239 10830000         (         mapl.asm):00351                 CMPD    #0                                ;TRYING TO DELETE 0?
223D 279D             (         mapl.asm):00352                 BEQ     ERRDEF                            ;INVALID
223F 170154           (         mapl.asm):00353                 LBSR    FNDLIN                            ;LOCATE LINE
2242 17017E           (         mapl.asm):00354                 LBSR    DELETE                            ;GET RID OF IT
2245                  (         mapl.asm):00355         EDC5
2245 16FF5F           (         mapl.asm):00356                 LBRA    EDTLIN                            ;NEXT COMMAND
                      (         mapl.asm):00357         ;* INSERT LINE(S)
2248                  (         mapl.asm):00358         EDC4
2248 8149             (         mapl.asm):00359                 CMPA    #'I'                              ;INSERT?
224A 2641             (         mapl.asm):00360                 BNE     EDCP                              ;NO, FORGET IT
224C 170259           (         mapl.asm):00361                 LBSR    SFNUM                             ;ARE WE OK?
224F 1027FF89         (         mapl.asm):00362                 LBEQ    ERRDEF                            ;NO, NO NUMBER
2253 170283           (         mapl.asm):00363                 LBSR    GETDIG                            ;GET THE NUMBER
2256 10830000         (         mapl.asm):00364                 CMPD    #0                                ;CANNOT INSERT IN LINE 0
225A 1027FF7E         (         mapl.asm):00365                 LBEQ    ERRDEF                            ;SAY SO
225E 170135           (         mapl.asm):00366                 LBSR    FNDLIN                            ;LOCATE THE LINE
2261                  (         mapl.asm):00367         EDCZ
2261 8628             (         mapl.asm):00368                 LDA     #'('                              ;DISPLAY MESSAGE
2263 170212           (         mapl.asm):00369                 LBSR    PUTCHR                            ;OUTPUT
2266 FC3C8C           (         mapl.asm):00370                 LDD     TEMP3                             ;GET LINE NUMBER
2269 170C92           (         mapl.asm):00371                 LBSR    DECOUT                            ;OUTPUT
226C 8629             (         mapl.asm):00372                 LDA     #')'                              ;CLOSING PROMPT
226E 170207           (         mapl.asm):00373                 LBSR    PUTCHR                            ;DISPLAY
2271 17020B           (         mapl.asm):00374                 LBSR    SPACE                             ;SPACE OVER
2274 17018B           (         mapl.asm):00375                 LBSR    GETRAM                            ;GET A LINE
2277 170209           (         mapl.asm):00376                 LBSR    SKP                               ;IS IT THE END
227A 270E             (         mapl.asm):00377                 BEQ     EDCX                              ;IF SO, QUIT
227C 170163           (         mapl.asm):00378                 LBSR    INSERT                            ;PUT IT HERE
227F FC3C8C           (         mapl.asm):00379                 LDD     TEMP3                             ;GET LINE NUMBER
2282 C30001           (         mapl.asm):00380                 ADDD    #1                                ;ADVANCE
2285 FD3C8C           (         mapl.asm):00381                 STD     TEMP3                             ;AND GO AGAIN
2288 20D7             (         mapl.asm):00382                 BRA     EDCZ                              ;AND GET NEXT LINE
228A                  (         mapl.asm):00383         EDCX
228A 16FF1A           (         mapl.asm):00384                 LBRA    EDTLIN                            ;BACK FOR NEXT COMMAND
                      (         mapl.asm):00385         ;* POSITION TO LINE
228D                  (         mapl.asm):00386         EDCP
228D 170232           (         mapl.asm):00387                 LBSR    VALNUM                            ;IS IT VALID?
2290 1026FF48         (         mapl.asm):00388                 LBNE    ERRDEF                            ;NO, GET UPSET
2294 313F             (         mapl.asm):00389                 LEAY    -1,Y                              ;BACKUP TO IT
2296 17020F           (         mapl.asm):00390                 LBSR    SFNUM                             ;LOOK FOR NUMBER
2299 3402             (         mapl.asm):00391                 PSHS    A                                 ;SAVE CHARACTER
229B 17023B           (         mapl.asm):00392                 LBSR    GETDIG                            ;GET NUMBER
229E 1700F5           (         mapl.asm):00393                 LBSR    FNDLIN                            ;LOCATE IT
22A1 3502             (         mapl.asm):00394                 PULS    A                                 ;GET CHARACTER BACK
22A3 8124             (         mapl.asm):00395                 CMPA    #'$'                              ;DO WE DISPLAY?
22A5 26E3             (         mapl.asm):00396                 BNE     EDCX                              ;NO, JUST GO THERE
22A7 3410             (         mapl.asm):00397                 PSHS    X                                 ;SAVE POSITION
22A9 1700B9           (         mapl.asm):00398                 LBSR    DSPLIN                            ;DISPLAY
22AC 3510             (         mapl.asm):00399                 PULS    X                                 ;RESTORE X
22AE 16FEF6           (         mapl.asm):00400                 LBRA    EDTLIN                            ;AND GO HOME
                      (         mapl.asm):00401         ;* SAVE NEW FUNCTION DEFINITION, INSERT AT BEGINNING OF SYMBOL TABLE
22B1                  (         mapl.asm):00402         RESAVE
22B1 A621             (         mapl.asm):00403                 LDA     1,Y                               ;GET NEXT CHARACTER
22B3 B73CA4           (         mapl.asm):00404                 STA     ASSFLG                            ;SAVE
22B6 4F               (         mapl.asm):00405                 CLRA
22B7 5F               (         mapl.asm):00406                 CLRB                                      ;     GET A ZERO
22B8 FD3C8C           (         mapl.asm):00407                 STD     TEMP3                             ;SET LINE NUMBER
22BB BE3C8A           (         mapl.asm):00408                 LDX     TEMP2                             ;POINT TO START
22BE 1F12             (         mapl.asm):00409                 TFR     X,Y                               ;COPY IT
22C0 1701F2           (         mapl.asm):00410                 LBSR    SFSYM                             ;SKIP TO END
22C3 1027FF15         (         mapl.asm):00411                 LBEQ    ERRDEF                            ;INVALID DEFN
22C7 F73C8E           (         mapl.asm):00412                 STB     TEMP4                             ;SAVE LENGTH
22CA 10BF3C8C         (         mapl.asm):00413                 STY     TEMP3                             ;SAVE POINTER TO SYMBOL
22CE 313F             (         mapl.asm):00414                 LEAY    -1,Y                              ;BACKUP
22D0 170238           (         mapl.asm):00415                 LBSR    LOOKUP                            ;LOOK FOR IT
22D3 2603             (         mapl.asm):00416                 BNE     NOER1                             ;DON'T ERASE
22D5 171505           (         mapl.asm):00417                 LBSR    ERASYM                            ;ERASE IT
22D8                  (         mapl.asm):00418         NOER1
22D8 BE3C8C           (         mapl.asm):00419                 LDX     TEMP3                             ;POINT TO WORKSPACE
22DB                  (         mapl.asm):00420         RE2
22DB A680             (         mapl.asm):00421                 LDA     ,X+                               ;GET SYMBOL CHAR
22DD 81FF             (         mapl.asm):00422                 CMPA    #$FF                              ;END OF PROGRAM?
22DF 26FA             (         mapl.asm):00423                 BNE     RE2                               ;NO
22E1 1F10             (         mapl.asm):00424                 TFR     X,D                               ;COPY
22E3 B33C8C           (         mapl.asm):00425                 SUBD    TEMP3                             ;CONVERT TO OFFSET VALUE
22E6 FD3C88           (         mapl.asm):00426                 STD     TEMP1                             ;SAVE OFFSET VALUE
                      (         mapl.asm):00427         ;* RIFLE THROUGH SYMBOL TABLE, LOOKING FOR END, AND ADDING OFFSET TO THE
                      (         mapl.asm):00428         ;* EXISTING SYMBOLS
22E9 8E4008           (         mapl.asm):00429                 LDX     #SYMTAB-2       POINT TO SYMBOL TABLE
22EC                  (         mapl.asm):00430         RIF0
22EC 3002             (         mapl.asm):00431                 LEAX    2,X                               ;ADVANCE
22EE                  (         mapl.asm):00432         RIF1
22EE E681             (         mapl.asm):00433                 LDB     ,X++                              ;GET OFFSET
22F0 1F98             (         mapl.asm):00434                 TFR     B,A                               ;COPY TO A
22F2 84E0             (         mapl.asm):00435                 ANDA    #$E0                              ;MASK LENGTH
22F4 C41F             (         mapl.asm):00436                 ANDB    #$1F                              ;MASK TYPE
22F6 270F             (         mapl.asm):00437                 BEQ     RIF2                              ;HIT THE END
22F8 3085             (         mapl.asm):00438                 LEAX    B,X                               ;OFFSET TO DATA AREA
22FA 8160             (         mapl.asm):00439                 CMPA    #$60                              ;IS IT LABEL TYPE
22FC 27EE             (         mapl.asm):00440                 BEQ     RIF0                              ;IF SO, DON'T ADJUST
22FE EC84             (         mapl.asm):00441                 LDD     ,X                                ;GET ADDRESS
2300 F33C88           (         mapl.asm):00442                 ADDD    TEMP1                             ;ADD OFFSET
2303 ED81             (         mapl.asm):00443                 STD     ,X++                              ;RESAVE
2305 20E7             (         mapl.asm):00444                 BRA     RIF1                              ;AND CONTINUE
                      (         mapl.asm):00445         ;* ADVANCE SYMBOL TABLE ENOUGH FOR ENTRY
2307                  (         mapl.asm):00446         RIF2
2307 F63C8E           (         mapl.asm):00447                 LDB     TEMP4                             ;GET LENGTH
230A CB04             (         mapl.asm):00448                 ADDB    #4                                ;ADD TYPE/ADDRESS BYTES
230C 3185             (         mapl.asm):00449                 LEAY    B,X                               ;POINT TO ABOVE ADDRESS
230E                  (         mapl.asm):00450         RIF3
230E A682             (         mapl.asm):00451                 LDA     ,-X                               ;GET BYTE FROM TABLE
2310 A7A2             (         mapl.asm):00452                 STA     ,-Y                               ;SAVE IN NEW LOCATION
2312 8C400A           (         mapl.asm):00453                 CMPX    #SYMTAB                           ;ARE WE PAST BEGINNING?
2315 22F7             (         mapl.asm):00454                 BHI     RIF3                              ;NO, KEEP GOING
                      (         mapl.asm):00455         ;* CREATE SYMBOL TABLE ENTRY
2317 F63C8E           (         mapl.asm):00456                 LDB     TEMP4                             ;GET LENGTH
231A B63CA4           (         mapl.asm):00457                 LDA     ASSFLG                            ;RESTORE TYPE
231D 8124             (         mapl.asm):00458                 CMPA    #'$'                              ;IS IT LOCK?
231F 2602             (         mapl.asm):00459                 BNE     NOLOKI                            ;DON'T LOCK
2321 CA20             (         mapl.asm):00460                 ORB     #$20                              ;SET TYPE TO ONE
2323                  (         mapl.asm):00461         NOLOKI
2323 E780             (         mapl.asm):00462                 STB     ,X+                               ;SAVE LENGTH IN TABLE
2325 6F80             (         mapl.asm):00463                 CLR     ,X+                               ;AND SET NEST BYTE
2327 10BE3C8C         (         mapl.asm):00464                 LDY     TEMP3                             ;POINT TO ENTRY
232B C41F             (         mapl.asm):00465                 ANDB    #$1F                              ;REMOVE TYPE INFO
232D                  (         mapl.asm):00466         RIF4
232D A6A2             (         mapl.asm):00467                 LDA     ,-Y                               ;GET CHARACTER
232F A780             (         mapl.asm):00468                 STA     ,X+                               ;SAVE IN TABLE
2331 5A               (         mapl.asm):00469                 DECB                                      ;     REDUCE COUNT
2332 26F9             (         mapl.asm):00470                 BNE     RIF4                              ;CONTINUE
2334 FC4008           (         mapl.asm):00471                 LDD     FREMEM                            ;POINT TO FREE MEMORY
2337 ED84             (         mapl.asm):00472                 STD     ,X                                ;SET ADDRESS
                      (         mapl.asm):00473         ;* MOVE MEMORY AHEAD, TO MAKE ROOM
2339 BE3C8C           (         mapl.asm):00474                 LDX     TEMP3                             ;GET PROGRAM ADDRESS
233C FC3C88           (         mapl.asm):00475                 LDD     TEMP1                             ;GET SIZE
233F 318B             (         mapl.asm):00476                 LEAY    D,X                               ;ADVANCE TO END OF PROGRAM
2341 3420             (         mapl.asm):00477                 PSHS    Y                                 ;SAVE POINTER
2343 30AB             (         mapl.asm):00478                 LEAX    D,Y                               ;ADVANCE TO EXTRA SPACE FOR COPY
2345                  (         mapl.asm):00479         RIF5
2345 A6A2             (         mapl.asm):00480                 LDA     ,-Y                               ;GET BYTE
2347 A782             (         mapl.asm):00481                 STA     ,-X                               ;SAVE IN NEW LOCATION
2349 10BC4008         (         mapl.asm):00482                 CMPY    FREMEM                            ;HIT THE BEGINNING?
234D 22F6             (         mapl.asm):00483                 BHI     RIF5                              ;NO, KEEP GOING
234F 3510             (         mapl.asm):00484                 PULS    X                                 ;RESTORE POINTER TO TEXT
2351                  (         mapl.asm):00485         RIF6
2351 A680             (         mapl.asm):00486                 LDA     ,X+                               ;GET FROM PROGRAM
2353 A7A0             (         mapl.asm):00487                 STA     ,Y+                               ;SAVE
2355 81FF             (         mapl.asm):00488                 CMPA    #$FF                              ;AT THE END?
2357 26F8             (         mapl.asm):00489                 BNE     RIF6                              ;NO, SKIP IT
2359 FC4000           (         mapl.asm):00490                 LDD     FREE                              ;GET FREE MEMORY
235C F33C88           (         mapl.asm):00491                 ADDD    TEMP1                             ;ADD IN PROGRAM SIZE
235F FD4000           (         mapl.asm):00492                 STD     FREE                              ;RESAVE
2362 16FD1B           (         mapl.asm):00493                 LBRA    CMD                               ;GET NEXT COMMAND
                      (         mapl.asm):00494         ;*
                      (         mapl.asm):00495         ;* EDITOR SUBROUTINES
                      (         mapl.asm):00496         ;*
                      (         mapl.asm):00497         ;* DISPLAY LINE (X)
2365                  (         mapl.asm):00498         DSPLIN
2365 865B             (         mapl.asm):00499                 LDA     #'['                              ;GET OPANING BRACE
2367 17010E           (         mapl.asm):00500                 LBSR    PUTCHR                            ;OUTPUT
236A FC3C8C           (         mapl.asm):00501                 LDD     TEMP3                             ;GET LINE NUMBER
236D 170B8E           (         mapl.asm):00502                 LBSR    DECOUT                            ;DISPLAY
2370 865D             (         mapl.asm):00503                 LDA     #']'                              ;CLOSING BRACE
2372 170103           (         mapl.asm):00504                 LBSR    PUTCHR                            ;DISPLAY
2375 170107           (         mapl.asm):00505                 LBSR    SPACE                             ;DISPLAY A SPACE
2378 3430             (         mapl.asm):00506                 PSHS    X,Y                               ;SAVE POINTER
237A 1F12             (         mapl.asm):00507                 TFR     X,Y                               ;COPY IT OVER
237C 170136           (         mapl.asm):00508                 LBSR    SFSYM                             ;LOOK FOR SYMBOL
237F 2704             (         mapl.asm):00509                 BEQ     EXTSPC                            ;IF NONE, EXTRA SPACE
2381 813A             (         mapl.asm):00510                 CMPA    #':'                              ;WAS IT A LABEL?
2383 2703             (         mapl.asm):00511                 BEQ     NOESPC                            ;YES, OUTDENT IT ONE COLUMN
2385                  (         mapl.asm):00512         EXTSPC
2385 1700F7           (         mapl.asm):00513                 LBSR    SPACE                             ;DISPLAY
2388                  (         mapl.asm):00514         NOESPC
2388 3530             (         mapl.asm):00515                 PULS    X,Y                               ;RESTORE REGS
                      (         mapl.asm):00516         ;* DISPLAY MESSAGE (X)
238A                  (         mapl.asm):00517         OULI
238A A680             (         mapl.asm):00518                 LDA     ,X+                               ;GET CHARACTER FROM LINE
238C 2707             (         mapl.asm):00519                 BEQ     OULX                              ;IF ZERO, TERMINATE
238E 1700E7           (         mapl.asm):00520                 LBSR    PUTCHR                            ;DISPLAY
2391 810A             (         mapl.asm):00521                 CMPA    #$0A                              ;END OF LINE?
2393 26F5             (         mapl.asm):00522                 BNE     OULI                              ;NO, CONTINUE
2395                  (         mapl.asm):00523         OULX
2395 39               (         mapl.asm):00524                 RTS
                      (         mapl.asm):00525         ;* MOVE TO AND FIND LINE INDICATED BY D
2396                  (         mapl.asm):00526         FNDLIN
2396 BE3C8A           (         mapl.asm):00527                 LDX     TEMP2                             ;POINT TO TEXT
2399                  (         mapl.asm):00528         FNDL1
2399 3426             (         mapl.asm):00529                 PSHS    A,B,Y                             ;SAVE INDICATORS
239B 4F               (         mapl.asm):00530                 CLRA
239C 5F               (         mapl.asm):00531                 CLRB                                      ;     START WITH ZERO
239D                  (         mapl.asm):00532         FND1
239D 10AEE4           (         mapl.asm):00533                 LDY     ,S                                ;GET VALUE
23A0 271C             (         mapl.asm):00534                 BEQ     FND4                              ;LINE IS FOUND
23A2 313F             (         mapl.asm):00535                 LEAY    -1,Y                              ;DECREMENT
23A4 10AFE4           (         mapl.asm):00536                 STY     ,S                                ;AND RESAVE
23A7 C30001           (         mapl.asm):00537                 ADDD    #1                                ;INCREMENT LINE NUMBER
23AA 3402             (         mapl.asm):00538                 PSHS    A                                 ;SAVE CHARACTER
23AC                  (         mapl.asm):00539         FND2
23AC A680             (         mapl.asm):00540                 LDA     ,X+                               ;ADVANCE
23AE 81FF             (         mapl.asm):00541                 CMPA    #$FF                              ;IS IT END OF FILE?
23B0 2708             (         mapl.asm):00542                 BEQ     FND3                              ;IF SO, QUIT
23B2 810D             (         mapl.asm):00543                 CMPA    #$0D                              ;END OF LINE
23B4 26F6             (         mapl.asm):00544                 BNE     FND2                              ;GIVE UP
23B6 3502             (         mapl.asm):00545                 PULS    A                                 ;RESTORE CHARACTER
23B8 20E3             (         mapl.asm):00546                 BRA     FND1                              ;AND KEEP LOOKING
23BA                  (         mapl.asm):00547         FND3
23BA 3502             (         mapl.asm):00548                 PULS    A                                 ;RESTORE CHARACTER
23BC 301F             (         mapl.asm):00549                 LEAX    -1,X                              ;BACKUP TO VALUE
23BE                  (         mapl.asm):00550         FND4
23BE FD3C8C           (         mapl.asm):00551                 STD     TEMP3                             ;SAVE NUMBER
23C1 35A6             (         mapl.asm):00552                 PULS    A,B,Y,PC        GO HOME
                      (         mapl.asm):00553         ;* DELETE LINE POINTED TO BY X
23C3                  (         mapl.asm):00554         DELETE
23C3 3430             (         mapl.asm):00555                 PSHS    X,Y                               ;SAVE POINTERS
23C5 1F12             (         mapl.asm):00556                 TFR     X,Y                               ;COPY TO Y REGISTER
23C7                  (         mapl.asm):00557         DEL1
23C7 A680             (         mapl.asm):00558                 LDA     ,X+                               ;GET CHARACTER FROM LINE
23C9 81FF             (         mapl.asm):00559                 CMPA    #$FF                              ;END OF LINE
23CB 270C             (         mapl.asm):00560                 BEQ     DEL3                              ;IF SO, QUIT
23CD 810D             (         mapl.asm):00561                 CMPA    #$0D                              ;END OF LINE?
23CF 26F6             (         mapl.asm):00562                 BNE     DEL1                              ;NO, KEEP LOOKING
23D1                  (         mapl.asm):00563         DEL2
23D1 A680             (         mapl.asm):00564                 LDA     ,X+                               ;GET CHARACTER FROM TEXT
23D3 A7A0             (         mapl.asm):00565                 STA     ,Y+                               ;SAVE IN OLD POSITION
23D5 81FF             (         mapl.asm):00566                 CMPA    #$FF                              ;END OF TEXT?
23D7 26F8             (         mapl.asm):00567                 BNE     DEL2                              ;NO, KEEP GOING
23D9                  (         mapl.asm):00568         DEL3
23D9 35B0             (         mapl.asm):00569                 PULS    X,Y,PC                            ;GO HOME
                      (         mapl.asm):00570         ;*
                      (         mapl.asm):00571         ;* FIND END OF FILE
                      (         mapl.asm):00572         ;*
23DB                  (         mapl.asm):00573         FNDEOF
23DB A680             (         mapl.asm):00574                 LDA     ,X+                               ;GET CHARACTER FROM FILE
23DD 81FF             (         mapl.asm):00575                 CMPA    #$FF                              ;ARE WE AT END?
23DF 26FA             (         mapl.asm):00576                 BNE     FNDEOF                            ;NO, KEEP LOOKING\
23E1 39               (         mapl.asm):00577                 RTS
                      (         mapl.asm):00578         ;*
                      (         mapl.asm):00579         ;* INSERT LINE INTO TEXT
                      (         mapl.asm):00580         ;*
23E2                  (         mapl.asm):00581         INSERT
23E2 3430             (         mapl.asm):00582                 PSHS    X,Y                               ;SAVE POINTERS
23E4 5F               (         mapl.asm):00583                 CLRB                                      ;     CLEAR LENGTH
23E5                  (         mapl.asm):00584         INS1
23E5 5C               (         mapl.asm):00585                 INCB                                      ;     ADVANCE COUNT
23E6 A6A0             (         mapl.asm):00586                 LDA     ,Y+                               ;LOOK FOR END OF LINE
23E8 810D             (         mapl.asm):00587                 CMPA    #$0D                              ;END OF LINE?
23EA 26F9             (         mapl.asm):00588                 BNE     INS1                              ;NO, SKIP IT
23EC 8DED             (         mapl.asm):00589                 BSR     FNDEOF                            ;FIND END OF FILE
23EE 3185             (         mapl.asm):00590                 LEAY    B,X                               ;ADVANCE TO NEXT
23F0                  (         mapl.asm):00591         INS2
23F0 A682             (         mapl.asm):00592                 LDA     ,-X                               ;GET CHARACTER FROM TEXT
23F2 A7A2             (         mapl.asm):00593                 STA     ,-Y                               ;AND SAVE AT NEW POSITION
23F4 ACE4             (         mapl.asm):00594                 CMPX    ,S                                ;ARE WE BACK TO NEW POSITION
23F6 22F8             (         mapl.asm):00595                 BHI     INS2                              ;KEEP GOING TILL WE GET TO END
23F8 3530             (         mapl.asm):00596                 PULS    X,Y                               ;GET POINTERS BACK
23FA                  (         mapl.asm):00597         INS3
23FA A6A0             (         mapl.asm):00598                 LDA     ,Y+                               ;GET CHARACTER FROM BUFFER
23FC A780             (         mapl.asm):00599                 STA     ,X+                               ;SAVE IN TEXT
23FE 5A               (         mapl.asm):00600                 DECB                                      ;     REDUCE COUNT
23FF 26F9             (         mapl.asm):00601                 BNE     INS3                              ;AND KEEP COPYING
2401 39               (         mapl.asm):00602                 RTS
                      (         mapl.asm):00603         ;*
                      (         mapl.asm):00604         ;* SYSTEM SUBROUTINES
                      (         mapl.asm):00605         ;*
                      (         mapl.asm):00606         ;* GET A LINE OF INPUT
                      (         mapl.asm):00607         ;*
2402                  (         mapl.asm):00608         GETRAM
2402 108E3C00         (         mapl.asm):00609                 LDY     #RAM                              ;POINT TO RAM
2406 2003             (         mapl.asm):00610                 BRA     GETLIN                            ;GET INPUT LINE
2408                  (         mapl.asm):00611         GETLF
2408 170067           (         mapl.asm):00612                 LBSR    LFCR                              ;NEW LINE
240B                  (         mapl.asm):00613         GETLIN
240B 860D             (         mapl.asm):00614                 LDA     #$0D                              ;GET CR
240D A7A0             (         mapl.asm):00615                 STA     ,Y+                               ;SABE IN RAM LOCATION
240F 5F               (         mapl.asm):00616                 CLRB                                      ;     INDICATE AT POSITION ZERO
2410                  (         mapl.asm):00617         GET1
2410 5D               (         mapl.asm):00618                 TSTB                                      ;     TEST FOR OVER LIMIT
2411 2BF5             (         mapl.asm):00619                 BMI     GETLF                             ;IF SO, TRY AGAIN
2413 8D2D             (         mapl.asm):00620                 BSR     GETCHR                            ;GET INPUT CHARACTER
2415 8103             (         mapl.asm):00621                 CMPA    #$03                              ;CONTROL-C
2417 271D             (         mapl.asm):00622                 BEQ     INPBRK                            ;IF SO, INTERRUPT
2419 817F             (         mapl.asm):00623                 CMPA    #$7F                              ;DELETE?
241B 270B             (         mapl.asm):00624                 BEQ     DELCHR                            ;IF SO, DELETE IT
241D A7A5             (         mapl.asm):00625                 STA     B,Y                               ;SAVE IN BUFFER
241F 5C               (         mapl.asm):00626                 INCB                                      ;     ADVANCE TO NEXT
2420 170055           (         mapl.asm):00627                 LBSR    PUTCHR                            ;DISPLAY
2423 810A             (         mapl.asm):00628                 CMPA    #$0A                              ;CARRIAGE RETURN?
2425 26E9             (         mapl.asm):00629                 BNE     GET1                              ;NO, SKIP IT
2427 39               (         mapl.asm):00630                 RTS
2428                  (         mapl.asm):00631         DELCHR
2428 5A               (         mapl.asm):00632                 DECB                                      ;     BACKUP OVER CHARACTER
2429 3410             (         mapl.asm):00633                 PSHS    X                                 ;SAVE POINTER
242B 17002C           (         mapl.asm):00634                 LBSR    DSPSTR                            ;DISPLAY
242E 08200800         (         mapl.asm):00635                 FCB     $08,$20,$08,0   MESSAGE TO DELETE
2432 3510             (         mapl.asm):00636                 PULS    X                                 ;RESTORE
2434 20DA             (         mapl.asm):00637                 BRA     GET1                              ;AND GO AGAIN
2436                  (         mapl.asm):00638         INPBRK
2436 860D             (         mapl.asm):00639                 LDA     #$0D                              ;GET CR
2438 A7A5             (         mapl.asm):00640                 STA     B,Y                               ;SAVE IT
243A 313F             (         mapl.asm):00641                 LEAY    -1,Y                              ;BACKUP TO BEFORE CR
243C 170039           (         mapl.asm):00642                 LBSR    PUTCHR                            ;DISPLAY NEW LINE
243F 160F8D           (         mapl.asm):00643                 LBRA    BREAK                             ;PERFORM BREAK
                      (         mapl.asm):00644         ;* READ A CHARACTER
2442                  (         mapl.asm):00645         GETCHR
2442 3F               (         mapl.asm):00646                 SWI
2443 22               (         mapl.asm):00647                 FCB     34                                ;GET A CHARACTER
2444 8141             (         mapl.asm):00648                 CMPA    #$41                              ;<'A'?
2446 2506             (         mapl.asm):00649                 BLO     CHROK                             ;IF SO, IT'S OK
2448 815A             (         mapl.asm):00650                 CMPA    #$5A                              ;>'Z'?
244A 2203             (         mapl.asm):00651                 BHI     NOC1                              ;NO CONVERSION
244C 8A20             (         mapl.asm):00652                 ORA     #$20                              ;CONVERT TO LOWER CASE
244E                  (         mapl.asm):00653         CHROK
244E 39               (         mapl.asm):00654                 RTS
244F                  (         mapl.asm):00655         NOC1
244F 8161             (         mapl.asm):00656                 CMPA    #$61                              ;<'A' (LOWER)?
2451 25FB             (         mapl.asm):00657                 BLO     CHROK                             ;IT'S OK
2453 817A             (         mapl.asm):00658                 CMPA    #$7A                              ;>'Z' (LOWER)?
2455 22F7             (         mapl.asm):00659                 BHI     CHROK                             ;IF SO, IT'S OK
2457 845F             (         mapl.asm):00660                 ANDA    #$5F                              ;CONVERT TO UPPER CASE
2459 39               (         mapl.asm):00661                 RTS
                      (         mapl.asm):00662         ;*
                      (         mapl.asm):00663         ;* DISPLAY STRING
                      (         mapl.asm):00664         ;*
245A                  (         mapl.asm):00665         DSPSTR
245A 3510             (         mapl.asm):00666                 PULS    X                                 ;GET POINTER TO MESSAGE
245C                  (         mapl.asm):00667         DSP1
245C A680             (         mapl.asm):00668                 LDA     ,X+                               ;GET FROM TEXT
245E 2704             (         mapl.asm):00669                 BEQ     DSP2                              ;QUIT
2460 8D16             (         mapl.asm):00670                 BSR     PUTCHR                            ;DISPLAY
2462 20F8             (         mapl.asm):00671                 BRA     DSP1                              ;AGAIN
2464                  (         mapl.asm):00672         DSP2
2464 1F15             (         mapl.asm):00673                 TFR     X,PC                              ;RETURN
                      (         mapl.asm):00674         ;*
                      (         mapl.asm):00675         ;* DISPLAY SYSTEM MESSAGE
                      (         mapl.asm):00676         ;*
2466                  (         mapl.asm):00677         SYSMSG
2466 3510             (         mapl.asm):00678                 PULS    X                                 ;GET X FROM PC
2468                  (         mapl.asm):00679         SY1
2468 A680             (         mapl.asm):00680                 LDA     ,X+                               ;GET CHAR
246A 2704             (         mapl.asm):00681                 BEQ     ENM1                              ;END OF MESSAGE
246C 8D0A             (         mapl.asm):00682                 BSR     PUTCHR                            ;OUTPUT
246E 20F8             (         mapl.asm):00683                 BRA     SY1                               ;AND DISPLAY
2470                  (         mapl.asm):00684         ENM1
2470 3410             (         mapl.asm):00685                 PSHS    X                                 ;SAVE PC AGAIN
                      (         mapl.asm):00686         ;* DISPLAY LFCR ON TERMINAL
2472                  (         mapl.asm):00687         LFCR
2472 860D             (         mapl.asm):00688                 LDA     #$0D                              ;NEW LINE
2474 8D06             (         mapl.asm):00689                 BSR     PUTOUT                            ;DISPLAY
2476 860A             (         mapl.asm):00690                 LDA     #$0A                              ;LF
                      (         mapl.asm):00691         ;* DISPLAY A CHARACTER
2478                  (         mapl.asm):00692         PUTCHR
2478 810D             (         mapl.asm):00693                 CMPA    #$0D                              ;END OF LINE?
247A 27F6             (         mapl.asm):00694                 BEQ     LFCR                              ;IF SO, DISPLAY LFCR
247C                  (         mapl.asm):00695         PUTOUT
247C 3F               (         mapl.asm):00696                 SWI
247D 21               (         mapl.asm):00697                 FCB     33                                ;DISPLAY
247E 39               (         mapl.asm):00698                 RTS
                      (         mapl.asm):00699         ;* DISPLAY A SPACE
247F                  (         mapl.asm):00700         SPACE
247F 8620             (         mapl.asm):00701                 LDA     #' '                              ;GET A SPACE
2481 20F5             (         mapl.asm):00702                 BRA     PUTCHR                            ;AND DISPLAY
                      (         mapl.asm):00703         ;* SKIP WITHOUT ADVANCING
2483                  (         mapl.asm):00704         SKP
2483 A6A0             (         mapl.asm):00705                 LDA     ,Y+                               ;GET CHR
2485 8120             (         mapl.asm):00706                 CMPA    #' '                              ;TEST FOR BLANK
2487 27FA             (         mapl.asm):00707                 BEQ     SKP                               ;AND FIND A NON-BLANK
2489 313F             (         mapl.asm):00708                 LEAY    -1,Y                              ;BACKUP TO IT
248B 810D             (         mapl.asm):00709                 CMPA    #$0D                              ;TEST FOR END OF LINE
248D 39               (         mapl.asm):00710                 RTS
                      (         mapl.asm):00711         ;* SKIP TO NEXT NON-BLANK
248E                  (         mapl.asm):00712         SKIP
248E A6A0             (         mapl.asm):00713                 LDA     ,Y+                               ;GET CHARACTER
2490 8120             (         mapl.asm):00714                 CMPA    #' '                              ;BLANK?
2492 27FA             (         mapl.asm):00715                 BEQ     SKIP                              ;TRY AGAIN
2494 810D             (         mapl.asm):00716                 CMPA    #$0D                              ;CR?
2496 2604             (         mapl.asm):00717                 BNE     OKRTS                             ;SKIP IT
2498 313F             (         mapl.asm):00718                 LEAY    -1,Y                              ;BACKUP
249A 1A04             (         mapl.asm):00719                 ORCC    #4                                ;SET Z FLAG
249C                  (         mapl.asm):00720         OKRTS
249C 39               (         mapl.asm):00721                 RTS
                      (         mapl.asm):00722         ;* SKIP BACK BUT CHECK HERE FIRST
249D                  (         mapl.asm):00723         SKBKP
249D 3121             (         mapl.asm):00724                 LEAY    1,Y                               ;ADVANCE FIRST
                      (         mapl.asm):00725         ;* SKIP BACKWARD TO NEXT NON-BLANK
249F                  (         mapl.asm):00726         SKBK
249F A6A2             (         mapl.asm):00727                 LDA     ,-Y                               ;BACKUP
24A1 8120             (         mapl.asm):00728                 CMPA    #' '                              ;SPACE?
24A3 27FA             (         mapl.asm):00729                 BEQ     SKBK                              ;CONTINUE
24A5 810D             (         mapl.asm):00730                 CMPA    #$0D                              ;START OF LINE?
24A7 39               (         mapl.asm):00731                 RTS
                      (         mapl.asm):00732         ;* SKIP FORWARD THROUGH A NUMBER
24A8                  (         mapl.asm):00733         SFNUM
24A8 C6FF             (         mapl.asm):00734                 LDB     #-1                               ;START WITH MINUS ONE
24AA                  (         mapl.asm):00735         SFN1
24AA 5C               (         mapl.asm):00736                 INCB                                      ;     ADVANCE FOR LENGTH
24AB A6A0             (         mapl.asm):00737                 LDA     ,Y+                               ;ADVANCE
24AD 8D13             (         mapl.asm):00738                 BSR     VALNUM                            ;IS IT A VALID DIGIT?
24AF 27F9             (         mapl.asm):00739                 BEQ     SFN1                              ;IF SO, CONTINUE
24B1 313F             (         mapl.asm):00740                 LEAY    -1,Y                              ;BACKUP TO START OF NUMBER
24B3 5D               (         mapl.asm):00741                 TSTB                                      ;     CHECK FOR ZERO LENGTH
24B4 39               (         mapl.asm):00742                 RTS
                      (         mapl.asm):00743         ;* SKIP FORWARD THROUGH A VARIABLE
24B5                  (         mapl.asm):00744         SFSYM
24B5 C6FF             (         mapl.asm):00745                 LDB     #-1                               ;START WITH MINUS ONE
24B7                  (         mapl.asm):00746         SFS1
24B7 5C               (         mapl.asm):00747                 INCB                                      ;     ADVANCE FOR LENGTH
24B8 A6A0             (         mapl.asm):00748                 LDA     ,Y+                               ;ADVANCE
24BA 8D10             (         mapl.asm):00749                 BSR     VALSYM                            ;IS IT VALID?
24BC 27F9             (         mapl.asm):00750                 BEQ     SFS1                              ;AND CONTINUE
24BE 313F             (         mapl.asm):00751                 LEAY    -1,Y                              ;BACKUP
24C0 5D               (         mapl.asm):00752                 TSTB                                      ;     TEST FOR ZERO LENGTH
24C1 39               (         mapl.asm):00753                 RTS
                      (         mapl.asm):00754         ;* SET Z FLAG IF PASSED CHARACTER IS A VALID NUMBER
24C2                  (         mapl.asm):00755         VALNUM
24C2 8130             (         mapl.asm):00756                 CMPA    #'0'                              ;IN RANGE?
24C4 2510             (         mapl.asm):00757                 BLO     BADSYM                            ;NO, IT'S BAD
24C6 8139             (         mapl.asm):00758                 CMPA    #'9'                              ;IN RANGE?
24C8 220C             (         mapl.asm):00759                 BHI     BADSYM                            ;NO, IT'S BAD
24CA 2008             (         mapl.asm):00760                 BRA     VALOK                             ;VALUE IS OK
                      (         mapl.asm):00761         ;* SET Z FLAG IS PASSED CHARACTER IS A VALID SYMBOL
24CC                  (         mapl.asm):00762         VALSYM
24CC 8140             (         mapl.asm):00763                 CMPA    #'@'                              ;IN RANGE?
24CE 2506             (         mapl.asm):00764                 BLO     BADSYM                            ;NO, IT'S BAD
24D0 815A             (         mapl.asm):00765                 CMPA    #'Z'                              ;IN RANGE?
24D2 2202             (         mapl.asm):00766                 BHI     BADSYM                            ;NO, IT'S BAD
24D4                  (         mapl.asm):00767         VALOK
24D4 1A04             (         mapl.asm):00768                 ORCC    #4                                ;INDICATE OK
24D6                  (         mapl.asm):00769         BADSYM
24D6 39               (         mapl.asm):00770                 RTS
                      (         mapl.asm):00771         ;*
                      (         mapl.asm):00772         ;* GETS NUMERIC VALUE FROM LINE(Y)., RETURNS IN D
                      (         mapl.asm):00773         ;*
24D7                  (         mapl.asm):00774         GETDEC
24D7 3121             (         mapl.asm):00775                 LEAY    1,Y                               ;ADVANCE
24D9                  (         mapl.asm):00776         GETDIG
24D9 CC0000           (         mapl.asm):00777                 LDD     #0                                ;START OF RESULT
24DC 3416             (         mapl.asm):00778                 PSHS    A,B,X                             ;SAVE VALUE AND MULTIPLIER
24DE 8E0001           (         mapl.asm):00779                 LDX     #1                                ;FIRST MULTIPLIER
24E1                  (         mapl.asm):00780         GETD1
24E1 A6A2             (         mapl.asm):00781                 LDA     ,-Y                               ;GET DIGIT
24E3 8DDD             (         mapl.asm):00782                 BSR     VALNUM                            ;IS IT A VALID NUMBER
24E5 2616             (         mapl.asm):00783                 BNE     GETD2                             ;END OF NUMBER
24E7 8030             (         mapl.asm):00784                 SUBA    #$30                              ;CONVERT TO BINARY
24E9 1F89             (         mapl.asm):00785                 TFR     A,B                               ;COPY TO B
24EB 4F               (         mapl.asm):00786                 CLRA                                      ;     CLEAR IT
24EC 17009D           (         mapl.asm):00787                 LBSR    MULT                              ;TIMES MULTIPLIER
24EF E3E4             (         mapl.asm):00788                 ADDD    ,S                                ;ADD TO OLD VALUE
24F1 EDE4             (         mapl.asm):00789                 STD     ,S                                ;RESAVE
24F3 CC000A           (         mapl.asm):00790                 LDD     #10                               ;TIMES 10
24F6 170093           (         mapl.asm):00791                 LBSR    MULT                              ;PERFORM
24F9 1F01             (         mapl.asm):00792                 TFR     D,X                               ;COPY TO X
24FB 20E4             (         mapl.asm):00793                 BRA     GETD1                             ;GET NEXT DIGIT
24FD                  (         mapl.asm):00794         GETD2
24FD 815F             (         mapl.asm):00795                 CMPA    #'_'                              ;NEGATIVE PREFIX?
24FF 2608             (         mapl.asm):00796                 BNE     DETD3                             ;NO, IT'S OK
2501 4F               (         mapl.asm):00797                 CLRA                                      ;     GET A ZERO
2502 5F               (         mapl.asm):00798                 CLRB                                      ;     FOR D ACCUMULATOR
2503 A3E4             (         mapl.asm):00799                 SUBD    ,S                                ;CONVERT NUMBER
2505 EDE4             (         mapl.asm):00800                 STD     ,S                                ;RESAVE
2507 313F             (         mapl.asm):00801                 LEAY    -1,Y                              ;BACKUP
2509                  (         mapl.asm):00802         DETD3
2509 3596             (         mapl.asm):00803                 PULS    A,B,X,PC        RESTORE VALUES
                      (         mapl.asm):00804         ;*
                      (         mapl.asm):00805         ;* LOOK UP ENTRY IN SYMBOL TABLE, ON EXIT, IF ENTRY IS FOUND, Z FLAG IS
                      (         mapl.asm):00806         ;* SET AND X POINTS TO A COPY OF THE SYMBOL TABLE ENTRY IN RAM. B HAS OFFSET
                      (         mapl.asm):00807         ;* FOR ADDRESS, AND A CONTAINS TYPE
                      (         mapl.asm):00808         ;* IF ENTRY IS NOT FOUND, Z FLAG IS CLEAR, AND X POINTS TO FIRST FREE SYMBOL
                      (         mapl.asm):00809         ;* TABLE SPACE
                      (         mapl.asm):00810         ;*
250B                  (         mapl.asm):00811         LOOKUP
250B 8E400A           (         mapl.asm):00812                 LDX     #SYMTAB                           ;POINT TO SYMBOL TABLE
250E                  (         mapl.asm):00813         CHKENT
250E 3430             (         mapl.asm):00814                 PSHS    X,Y                               ;SAVE REGSITERS
2510 E680             (         mapl.asm):00815                 LDB     ,X+                               ;GET LENGTH OF NAME
2512 C41F             (         mapl.asm):00816                 ANDB    #$1F                              ;REMOVE TYPE BITS
2514 2739             (         mapl.asm):00817                 BEQ     ENDST                             ;DIDN'T FIND IT
2516 A680             (         mapl.asm):00818                 LDA     ,X+                               ;GET NEST INFO
2518 2629             (         mapl.asm):00819                 BNE     NOSYM                             ;DON'T RECOGNISE IT
251A                  (         mapl.asm):00820         CHKV
251A A6A4             (         mapl.asm):00821                 LDA     ,Y                                ;GET CHARACTER FROM SOURCE
251C A180             (         mapl.asm):00822                 CMPA    ,X+                               ;IS IT OK
251E 2623             (         mapl.asm):00823                 BNE     NOSYM                             ;NOT A VARIABLE
2520 313F             (         mapl.asm):00824                 LEAY    -1,Y                              ;BACKUP
2522 5A               (         mapl.asm):00825                 DECB                                      ;     REDUCE COUNT
2523 26F5             (         mapl.asm):00826                 BNE     CHKV                              ;AND KEEP CHECKING
2525 A6A4             (         mapl.asm):00827                 LDA     ,Y                                ;GET CHARACTER FROM VARIABLE
2527 17FFA2           (         mapl.asm):00828                 LBSR    VALSYM                            ;VALID SYMBOL?
252A 2717             (         mapl.asm):00829                 BEQ     NOSYM                             ;HAVN'T FOUND IT YET
252C 3510             (         mapl.asm):00830                 PULS    X                                 ;RESTORE TABLE POSITION
252E 3262             (         mapl.asm):00831                 LEAS    2,S                               ;SKIP Y VALUE
2530 17FF6A           (         mapl.asm):00832                 LBSR    SKBKP                             ;SKIP BACK TO NEXT
2533 A684             (         mapl.asm):00833                 LDA     ,X                                ;GET LENGTH
2535 1F89             (         mapl.asm):00834                 TFR     A,B                               ;SAVE TYPE INFO IN B
2537 C41F             (         mapl.asm):00835                 ANDB    #$1F                              ;MASK OFF LENGTH
2539 CB02             (         mapl.asm):00836                 ADDB    #2                                ;SKIP TO TYPE BYTE
253B 44               (         mapl.asm):00837                 LSRA                                      ;     SHIFT
253C 44               (         mapl.asm):00838                 LSRA                                      ;     TYPE
253D 44               (         mapl.asm):00839                 LSRA                                      ;     BACK
253E 44               (         mapl.asm):00840                 LSRA                                      ;     TO
253F 44               (         mapl.asm):00841                 LSRA                                      ;     POSITION
2540 1A04             (         mapl.asm):00842                 ORCC    #4                                ;SET Z FLAG
2542 39               (         mapl.asm):00843                 RTS
2543                  (         mapl.asm):00844         NOSYM
2543 3530             (         mapl.asm):00845                 PULS    X,Y                               ;RESTORE REGSTERS
2545 A684             (         mapl.asm):00846                 LDA     ,X                                ;ADVANCE TO NEXT
2547 841F             (         mapl.asm):00847                 ANDA    #$1F                              ;MASK OFF TYPE
2549 8B04             (         mapl.asm):00848                 ADDA    #4                                ;ADD THREE BYTES FOR ADDRESS
254B 3086             (         mapl.asm):00849                 LEAX    A,X                               ;SKIP TO NEXT ENTRY
254D 20BF             (         mapl.asm):00850                 BRA     CHKENT                            ;AND CHECK THIS ENTRY
254F                  (         mapl.asm):00851         ENDST
254F 3530             (         mapl.asm):00852                 PULS    X,Y                               ;RESTORE POINTER
2551 1CFB             (         mapl.asm):00853                 ANDCC   #$FB                              ;CLEAR Z FLAG
2553 39               (         mapl.asm):00854                 RTS
                      (         mapl.asm):00855         ;*
                      (         mapl.asm):00856         ;* CREATE A SYMBOL TABLE ENTRY, TYPE PASSED IN A
                      (         mapl.asm):00857         ;*
2554                  (         mapl.asm):00858         CRESYM
2554 48               (         mapl.asm):00859                 LSLA                                      ;     SHIFT
2555 48               (         mapl.asm):00860                 LSLA                                      ;     TYPE INTO HIGH BITS
2556 48               (         mapl.asm):00861                 LSLA                                      ;     FOR ENTRY IN
2557 48               (         mapl.asm):00862                 LSLA                                      ;     SYMBOL
2558 48               (         mapl.asm):00863                 LSLA                                      ;     TABLE
2559 3402             (         mapl.asm):00864                 PSHS    A                                 ;SAVE TYPE
255B 8E400A           (         mapl.asm):00865                 LDX     #SYMTAB                           ;POINT TO TABLE
255E                  (         mapl.asm):00866         CRE1
255E A680             (         mapl.asm):00867                 LDA     ,X+                               ;GET LINK
2560 841F             (         mapl.asm):00868                 ANDA    #$1F                              ;MASK OFF LENGTH INFO
2562 2706             (         mapl.asm):00869                 BEQ     CRE2                              ;END OF TABLE
2564 8B03             (         mapl.asm):00870                 ADDA    #3                                ;CONVERT TO COMPLETE OFFSET
2566 3086             (         mapl.asm):00871                 LEAX    A,X                               ;SKIP THIS ENTRY
2568 20F4             (         mapl.asm):00872                 BRA     CRE1                              ;LOOK AGAIN
256A                  (         mapl.asm):00873         CRE2
256A 5F               (         mapl.asm):00874                 CLRB                                      ;     SET OFFSET
256B                  (         mapl.asm):00875         CRE3
256B A6A4             (         mapl.asm):00876                 LDA     ,Y                                ;GET CHARACTER FROM TEXT
256D 17FF5C           (         mapl.asm):00877                 LBSR    VALSYM                            ;IS IT VALID
2570 2607             (         mapl.asm):00878                 BNE     CRE4                              ;NO MORE
2572 5C               (         mapl.asm):00879                 INCB                                      ;     ADVANCE
2573 A785             (         mapl.asm):00880                 STA     B,X                               ;SAVE SYMBOL IN TABLE
2575 313F             (         mapl.asm):00881                 LEAY    -1,Y                              ;BACKUP TO NEXT
2577 20F2             (         mapl.asm):00882                 BRA     CRE3                              ;AND KEEP CREATING
2579                  (         mapl.asm):00883         CRE4
2579 1F98             (         mapl.asm):00884                 TFR     B,A                               ;COPY TO A
257B AAE0             (         mapl.asm):00885                 ORA     ,S+                               ;ADD IN TYPE BITS
257D A71F             (         mapl.asm):00886                 STA     -1,X                              ;SAVE LENGTH IN TABLE
257F 6F84             (         mapl.asm):00887                 CLR     ,X                                ;INDICATE LEVEL ZERO NEST
2581 5C               (         mapl.asm):00888                 INCB                                      ;     SKIP TO TYPE FIELD IN ENTRY
2582 3085             (         mapl.asm):00889                 LEAX    B,X                               ;ADVANCE POINTER
2584 FC4000           (         mapl.asm):00890                 LDD     FREE                              ;POINT TO FREE MEMORY
2587 ED84             (         mapl.asm):00891                 STD     ,X                                ;INDICATE WHERE SYMBOL WILL BE
2589 6F02             (         mapl.asm):00892                 CLR     2,X                               ;INDICATE LAST ENTRY
258B 39               (         mapl.asm):00893                 RTS
                      (         mapl.asm):00894         ;*
                      (         mapl.asm):00895         ;* PERFORMS 16 BIT MULTIPLICATION (D=X;*D)
                      (         mapl.asm):00896         ;*
258C                  (         mapl.asm):00897         MULT
258C 3416             (         mapl.asm):00898                 PSHS    D,X                               ;SAVE PARAMETERS
258E A661             (         mapl.asm):00899                 LDA     1,S
2590 E663             (         mapl.asm):00900                 LDB     3,S
2592 3D               (         mapl.asm):00901                 MUL
2593 3406             (         mapl.asm):00902                 PSHS    A,B                               ;RESAVE
2595 A662             (         mapl.asm):00903                 LDA     2,S
2597 E665             (         mapl.asm):00904                 LDB     5,S
2599 3D               (         mapl.asm):00905                 MUL
259A EBE4             (         mapl.asm):00906                 ADDB    ,S
259C E7E4             (         mapl.asm):00907                 STB     ,S
259E A663             (         mapl.asm):00908                 LDA     3,S
25A0 E664             (         mapl.asm):00909                 LDB     4,S
25A2 3D               (         mapl.asm):00910                 MUL
25A3 EBE4             (         mapl.asm):00911                 ADDB    ,S
25A5 E7E4             (         mapl.asm):00912                 STB     ,S
25A7 3506             (         mapl.asm):00913                 PULS    A,B                               ;GET RESULT
25A9 3264             (         mapl.asm):00914                 LEAS    4,S                               ;SKIP CRAP
25AB 39               (         mapl.asm):00915                 RTS
                      (         mapl.asm):00916         ;*
                      (         mapl.asm):00917         ;* PERFORMS 16 BIT DIVISION. (X=X/D, D=REMAINDER.)
                      (         mapl.asm):00918         ;*
25AC                  (         mapl.asm):00919         DIV
25AC 3416             (         mapl.asm):00920                 PSHS    D,X
25AE CC0000           (         mapl.asm):00921                 LDD     #0
25B1 8E0011           (         mapl.asm):00922                 LDX     #17
25B4                  (         mapl.asm):00923         DIV1
25B4 1CFE             (         mapl.asm):00924                 ANDCC   #$FE
25B6                  (         mapl.asm):00925         DIV2
25B6 6963             (         mapl.asm):00926                 ROL     3,S
25B8 6962             (         mapl.asm):00927                 ROL     2,S
25BA 301F             (         mapl.asm):00928                 LEAX    -1,X
25BC 270D             (         mapl.asm):00929                 BEQ     DIV3
25BE 59               (         mapl.asm):00930                 ROLB
25BF 49               (         mapl.asm):00931                 ROLA
25C0 10A3E4           (         mapl.asm):00932                 CMPD    ,S
25C3 25EF             (         mapl.asm):00933                 BLO     DIV1
25C5 A3E4             (         mapl.asm):00934                 SUBD    ,S
25C7 1A01             (         mapl.asm):00935                 ORCC    #1
25C9 20EB             (         mapl.asm):00936                 BRA     DIV2
25CB                  (         mapl.asm):00937         DIV3
25CB 3262             (         mapl.asm):00938                 LEAS    2,S
25CD 3510             (         mapl.asm):00939                 PULS    X
25CF 39               (         mapl.asm):00940                 RTS
                      (         mapl.asm):00941         ;*
                      (         mapl.asm):00942         ;* GET FILENAME FROM INPUT LINE
                      (         mapl.asm):00943         ;*
25D0                  (         mapl.asm):00944         FILNAM
25D0 3420             (         mapl.asm):00945                 PSHS    Y                                 ;SAVE Y
25D2                  (         mapl.asm):00946         FIL1
25D2 A6A0             (         mapl.asm):00947                 LDA     ,Y+                               ;GET CHAR
25D4 8120             (         mapl.asm):00948                 CMPA    #' '                              ;SPACE?
25D6 2704             (         mapl.asm):00949                 BEQ     FIL2                              ;MARKS END
25D8 810D             (         mapl.asm):00950                 CMPA    #$0D                              ;CR?
25DA 26F6             (         mapl.asm):00951                 BNE     FIL1                              ;NO, MORE FILENAME
25DC                  (         mapl.asm):00952         FIL2
25DC 862E             (         mapl.asm):00953                 LDA     #'.'                              ;GET DOT
25DE A73F             (         mapl.asm):00954                 STA     -1,Y                              ;SAVE
25E0 CC4150           (         mapl.asm):00955                 LDD     #$4150                            ;GET 'AP'
25E3 EDA1             (         mapl.asm):00956                 STD     ,Y++                              ;SET UP IN NAME
25E5 CC4C0D           (         mapl.asm):00957                 LDD     #$4C0D                            ;GET 'L' AND CR
25E8 EDA4             (         mapl.asm):00958                 STD     ,Y                                ;SET UP IN NAME
25EA 3520             (         mapl.asm):00959                 PULS    Y                                 ;RESTORE FILENAME POINTER
25EC 39               (         mapl.asm):00960                 RTS
                      (         mapl.asm):00961         ;*
                      (         mapl.asm):00962         ;* EVALUATES AN EXPRESSION
                      (         mapl.asm):00963         ;*
25ED                  (         mapl.asm):00964         EXPR
25ED A6A0             (         mapl.asm):00965                 LDA     ,Y+                               ;GET CHARACTER
25EF 810D             (         mapl.asm):00966                 CMPA    #$0D                              ;END OF LINE?
25F1 26FA             (         mapl.asm):00967                 BNE     EXPR                              ;KEEP LOOKING
25F3                  (         mapl.asm):00968         EXEX
25F3 7F3CA5           (         mapl.asm):00969                 CLR     ERRFLG                            ;INSURE NO ERROR SET
25F6 313F             (         mapl.asm):00970                 LEAY    -1,Y                              ;BACKUP
25F8 3420             (         mapl.asm):00971                 PSHS    Y                                 ;SAVE IT
25FA 8D1A             (         mapl.asm):00972                 BSR     DOEXPR                            ;EXECUTE ROUTINE
25FC 813A             (         mapl.asm):00973                 CMPA    #':'                              ;LABEL DEFINITION?
25FE 2704             (         mapl.asm):00974                 BEQ     EXEXE                             ;IF SO, OK
2600 810D             (         mapl.asm):00975                 CMPA    #$0D                              ;END OF LINE?
2602 2610             (         mapl.asm):00976                 BNE     EX1                               ;NO, DON'T DISPLAY
2604                  (         mapl.asm):00977         EXEXE
2604 7D3CA4           (         mapl.asm):00978                 TST     ASSFLG                            ;WAS IT ASSIGNMENT
2607 260B             (         mapl.asm):00979                 BNE     EX1                               ;NO, DON'T DISPLAY
2609 FC3CA6           (         mapl.asm):00980                 LDD     INPSTK                            ;ARE WE INPUTTING?
260C 2606             (         mapl.asm):00981                 BNE     EX1                               ;YES, DON'T OUTPUT
260E 1708BB           (         mapl.asm):00982                 LBSR    DISPLY                            ;DISPLAY
2611 17FE5E           (         mapl.asm):00983                 LBSR    LFCR                              ;NEW LINE
2614                  (         mapl.asm):00984         EX1
2614 35A0             (         mapl.asm):00985                 PULS    Y,PC                              ;GO HOME
                      (         mapl.asm):00986         ;* CALCULATE AN EXPRESSION
2616                  (         mapl.asm):00987         DOEXPR
2616 7F3CA4           (         mapl.asm):00988                 CLR     ASSFLG                            ;INSURE WE KNOW IF ASSIGNMENT
2619 FC3C90           (         mapl.asm):00989                 LDD     TEMP5                             ;GET FREE RAM ADDRESS
261C B34006           (         mapl.asm):00990                 SUBD    BUFSIZ                            ;SUBTRACT WORK BUFFER
261F 10B34000         (         mapl.asm):00991                 CMPD    FREE                              ;ARE WE OVER MEMORY LIMIT
2623 10230DC7         (         mapl.asm):00992                 LBLS    WSFUL                             ;INDICATE FULL
2627 FD3C90           (         mapl.asm):00993                 STD     TEMP5                             ;RESAVE
262A                  (         mapl.asm):00994         EXP1
262A BE3C90           (         mapl.asm):00995                 LDX     TEMP5                             ;POINT TO WORKSPACE
262D 313F             (         mapl.asm):00996                 LEAY    -1,Y                              ;BACKUP
262F 1708FE           (         mapl.asm):00997                 LBSR    GETVAL                            ;GET FIRST VALUE
2632 10260DC5         (         mapl.asm):00998                 LBNE    SYNTAX                            ;FIRST VALUE MUST EXIST
2636                  (         mapl.asm):00999         NXTOPR
2636 170CE6           (         mapl.asm):01000                 LBSR    MVWRK                             ;INSURE LAST RESULT IS IN WORKSPACE
2639 17FE61           (         mapl.asm):01001                 LBSR    SKBKP                             ;GET NEXT OPERATOR
263C 10BF3C9E         (         mapl.asm):01002                 STY     TXTPTR                            ;SAVE OPERATOR LOCATION
2640 810D             (         mapl.asm):01003                 CMPA    #$0D                              ;START OF LINE?
2642 270F             (         mapl.asm):01004                 BEQ     ENDEXP                            ;IF SO, QUIT
2644 813A             (         mapl.asm):01005                 CMPA    #':'                              ;LABEL?
2646 270B             (         mapl.asm):01006                 BEQ     ENDEXP                            ;IF SO, EXIT
2648 815B             (         mapl.asm):01007                 CMPA    #'['                              ;START OF INDEX EXPRESSON
264A 2707             (         mapl.asm):01008                 BEQ     ENDEXP                            ;IF SO, QUIT
264C 7F3CA4           (         mapl.asm):01009                 CLR     ASSFLG                            ;INSURE '(' DISPLAYS
264F 8128             (         mapl.asm):01010                 CMPA    #'('                              ;START OF NESTED EXPRESSION
2651 260D             (         mapl.asm):01011                 BNE     DOEX1                             ;NO, CALCULATE IT
2653                  (         mapl.asm):01012         ENDEXP
2653 3402             (         mapl.asm):01013                 PSHS    A                                 ;SAVE ENDING CHARACTER
2655 FC3C90           (         mapl.asm):01014                 LDD     TEMP5                             ;POINT TO WORK BUFFER
2658 F34006           (         mapl.asm):01015                 ADDD    BUFSIZ                            ;RELEASE OUR LEVEL
265B FD3C90           (         mapl.asm):01016                 STD     TEMP5                             ;AND RESAVE
265E 3582             (         mapl.asm):01017                 PULS    A,PC                              ;GO HOME
                      (         mapl.asm):01018         ;* PERFORM OPERATION
2660                  (         mapl.asm):01019         DOEX1
2660 313F             (         mapl.asm):01020                 LEAY    -1,Y                              ;BACKUP TO LAST
                      (         mapl.asm):01021         ;* DETERMINE LENGTH OF PASSED STRUCTURE
2662                  (         mapl.asm):01022         DSIP1
2662 8170             (         mapl.asm):01023                 CMPA    #'p'                              ;CHECK FOR LENGTH
2664 260D             (         mapl.asm):01024                 BNE     DSIP2                             ;NOT SHAPE
2666 EC01             (         mapl.asm):01025                 LDD     1,X                               ;GET LENGTH
2668 ED03             (         mapl.asm):01026                 STD     3,X                               ;AND SAVE IT
266A CC0001           (         mapl.asm):01027                 LDD     #1                                ;SET LENGTH TO 1
266D ED01             (         mapl.asm):01028                 STD     1,X                               ;SET LENGTH
266F E784             (         mapl.asm):01029                 STB     ,X                                ;SET TYPE TO INTEGER
2671 20C3             (         mapl.asm):01030                 BRA     NXTOPR                            ;AND GT NEXT OPERAND
                      (         mapl.asm):01031         ;* CREATE AN ASCENTING VECTOR
2673                  (         mapl.asm):01032         DSIP2
2673 8169             (         mapl.asm):01033                 CMPA    #'i'                              ;IS IT VECTOR?
2675 262D             (         mapl.asm):01034                 BNE     DSIP3                             ;NO, TRY NEXT
2677 3410             (         mapl.asm):01035                 PSHS    X                                 ;SAVE POSITION
2679 A680             (         mapl.asm):01036                 LDA     ,X+                               ;GET TYPE
267B 8101             (         mapl.asm):01037                 CMPA    #1                                ;INTEGER?
267D 10260C8B         (         mapl.asm):01038                 LBNE    CDOM                              ;NO, ERROR
2681 EC81             (         mapl.asm):01039                 LDD     ,X++                              ;GET LENGTH
2683 10830001         (         mapl.asm):01040                 CMPD    #1                                ;SINGLE ELEMENT?
2687 10260C7A         (         mapl.asm):01041                 LBNE    CLEN                              ;NO, ERROR
268B EC84             (         mapl.asm):01042                 LDD     ,X                                ;GET DATA
268D ED1E             (         mapl.asm):01043                 STD     -2,X                              ;SET LENGTH
268F 270E             (         mapl.asm):01044                 BEQ     IOTZ                              ;SPECIAL CASE
2691 F34002           (         mapl.asm):01045                 ADDD    ORIGIN                            ;ADVANCE
2694                  (         mapl.asm):01046         IOT1
2694 830001           (         mapl.asm):01047                 SUBD    #1                                ;REDUCE COUNT
2697 ED81             (         mapl.asm):01048                 STD     ,X++                              ;SAVE
2699 10B34002         (         mapl.asm):01049                 CMPD    ORIGIN                            ;ARE WE AT START YET?
269D 26F5             (         mapl.asm):01050                 BNE     IOT1                              ;AND GO BACK
269F                  (         mapl.asm):01051         IOTZ
269F 3510             (         mapl.asm):01052                 PULS    X                                 ;RESTORE REGISTERS
26A1 16FF92           (         mapl.asm):01053                 LBRA    NXTOPR
                      (         mapl.asm):01054         ;* REVERSE OPERAND VECTOR
26A4                  (         mapl.asm):01055         DSIP3
26A4 8172             (         mapl.asm):01056                 CMPA    #'r'                              ;REVERSE?
26A6 2637             (         mapl.asm):01057                 BNE     DSIP4                             ;NO, TRY NEXT
26A8 3470             (         mapl.asm):01058                 PSHS    X,Y,U                             ;SAVE REGISTERS
26AA EC01             (         mapl.asm):01059                 LDD     1,X                               ;GET LENGTH
26AC 272C             (         mapl.asm):01060                 BEQ     REV2                              ;NOTHING TO DO
26AE 3103             (         mapl.asm):01061                 LEAY    3,X                               ;GET START OF VECTOR
26B0 6D84             (         mapl.asm):01062                 TST     ,X                                ;WHAT FORM ARE WE
26B2 2714             (         mapl.asm):01063                 BEQ     CREV                              ;REVERSING CHARACTER ARRAY
26B4 58               (         mapl.asm):01064                 LSLB
26B5 49               (         mapl.asm):01065                 ROLA                                      ;     DOUBLE FOR TWO BYTE ENTRIES
26B6 30AB             (         mapl.asm):01066                 LEAX    D,Y                               ;POINT TO END OF STRING
26B8                  (         mapl.asm):01067         REV1
26B8 ECA1             (         mapl.asm):01068                 LDD     ,Y++                              ;GET CHARACTER FROM START
26BA EE83             (         mapl.asm):01069                 LDU     ,--X                              ;AND GET OTHER ONE
26BC 3420             (         mapl.asm):01070                 PSHS    Y                                 ;SAVE
26BE ACE1             (         mapl.asm):01071                 CMPX    ,S++                              ;TEST FOR WRAPPED
26C0 2518             (         mapl.asm):01072                 BLO     REV2                              ;IF SO, WE ARE DONE
26C2 ED84             (         mapl.asm):01073                 STD     ,X                                ;SAVE NEW RESULT
26C4 EF3E             (         mapl.asm):01074                 STU     -2,Y                              ;AND OTHER ONE
26C6 20F0             (         mapl.asm):01075                 BRA     REV1                              ;KEEP GOING
26C8                  (         mapl.asm):01076         CREV
26C8 30AB             (         mapl.asm):01077                 LEAX    D,Y                               ;SKIP TO END
26CA                  (         mapl.asm):01078         REV3
26CA A682             (         mapl.asm):01079                 LDA     ,-X                               ;GET CHARACTER
26CC E6A0             (         mapl.asm):01080                 LDB     ,Y+                               ;AND GET OTHER CHARACTER
26CE 3420             (         mapl.asm):01081                 PSHS    Y                                 ;SAVE REG
26D0 ACE1             (         mapl.asm):01082                 CMPX    ,S++                              ;ARE WE THERE?
26D2 2506             (         mapl.asm):01083                 BLO     REV2                              ;IF SO, EXIT
26D4 E784             (         mapl.asm):01084                 STB     ,X                                ;SET NEW VALUE
26D6 A73F             (         mapl.asm):01085                 STA     -1,Y                              ;AND NEW VALUE HERE
26D8 20F0             (         mapl.asm):01086                 BRA     REV3                              ;CONTINUE REVERSING
26DA                  (         mapl.asm):01087         REV2
26DA 3570             (         mapl.asm):01088                 PULS    X,Y,U                             ;RESTORE REGISTERS
26DC 16FF57           (         mapl.asm):01089                 LBRA    NXTOPR                            ;NEXT OPERATOR
                      (         mapl.asm):01090         ;* GENERATE RANDOM VECTORS
26DF                  (         mapl.asm):01091         DSIP4
26DF 813F             (         mapl.asm):01092                 CMPA    #'?'                              ;RANDOM OPERATOR?
26E1 2637             (         mapl.asm):01093                 BNE     DSIP5                             ;NO, TRY NEXT
26E3 3430             (         mapl.asm):01094                 PSHS    X,Y                               ;SAVE REGISTERS
26E5 A680             (         mapl.asm):01095                 LDA     ,X+                               ;GET TYPE
26E7 10270C21         (         mapl.asm):01096                 LBEQ    CDOM                              ;CAN'T USE CHARACTERS
26EB 10AE81           (         mapl.asm):01097                 LDY     ,X++                              ;GET LENGTH
26EE 2725             (         mapl.asm):01098                 BEQ     RND2                              ;ZERO LENGTH, SKIP IT
26F0                  (         mapl.asm):01099         RND1
26F0 3410             (         mapl.asm):01100                 PSHS    X                                 ;SAVE POINTER
26F2 FC4004           (         mapl.asm):01101                 LDD     SEED                              ;GET RANDOM SEED
26F5 8E358D           (         mapl.asm):01102                 LDX     #13709                            ;GET FIRST VALUE
26F8 17FE91           (         mapl.asm):01103                 LBSR    MULT                              ;MULTIPLY IT
26FB C33619           (         mapl.asm):01104                 ADDD    #13849                            ;AND DO THE ADDITION
26FE FD4004           (         mapl.asm):01105                 STD     SEED                              ;RESAVE SEED
2701 1F01             (         mapl.asm):01106                 TFR     D,X                               ;COPY FOR DIV
2703 ECF4             (         mapl.asm):01107                 LDD     [,S]                              ;GET LIMIT VALUE
2705 2706             (         mapl.asm):01108                 BEQ     RND3                              ;ZERO, RESULT IS ZERO
2707 17FEA2           (         mapl.asm):01109                 LBSR    DIV                               ;PERFORM DIVISION
270A F34002           (         mapl.asm):01110                 ADDD    ORIGIN                            ;CONVERT FOR ORIGIN VALUE
270D                  (         mapl.asm):01111         RND3
270D 3510             (         mapl.asm):01112                 PULS    X                                 ;RESTORE POINTER
270F ED81             (         mapl.asm):01113                 STD     ,X++                              ;SAVE BACK IN VECTOR
2711 313F             (         mapl.asm):01114                 LEAY    -1,Y                              ;REDUCE LENGTH
2713 26DB             (         mapl.asm):01115                 BNE     RND1                              ;DO THEM ALL
2715                  (         mapl.asm):01116         RND2
2715 3530             (         mapl.asm):01117                 PULS    X,Y                               ;RESTORE REGISTERS
2717 16FF1C           (         mapl.asm):01118                 LBRA    NXTOPR
                      (         mapl.asm):01119         ;* CLASSIFY DATA TYPE
271A                  (         mapl.asm):01120         DSIP5
271A 8163             (         mapl.asm):01121                 CMPA    #'c'                              ;IS IT CLASSIFY?
271C 260E             (         mapl.asm):01122                 BNE     DSIP6                             ;NO, TRY NEXT
271E E684             (         mapl.asm):01123                 LDB     ,X                                ;GET TYPE
2720 4F               (         mapl.asm):01124                 CLRA                                      ;     ZERO HIGH BYTE
2721 ED03             (         mapl.asm):01125                 STD     3,X                               ;SAVE DATA
2723 C601             (         mapl.asm):01126                 LDB     #1                                ;GET LENGTH + TYPE
2725 ED01             (         mapl.asm):01127                 STD     1,X                               ;SAVE LENGTH
2727 E784             (         mapl.asm):01128                 STB     ,X                                ;SAVE TYPE
2729 16FF0A           (         mapl.asm):01129                 LBRA    NXTOPR
                      (         mapl.asm):01130         ;* GENERATE ASSENDING VECTOR INDEX
272C                  (         mapl.asm):01131         DSIP6
272C 815E             (         mapl.asm):01132                 CMPA    #'^'                              ;ASSEND?
272E 102600A9         (         mapl.asm):01133                 LBNE    DSIP7                             ;NO, TRY NEXT
2732 3460             (         mapl.asm):01134                 PSHS    Y,U                               ;SAVE REGISTERS
2734 3001             (         mapl.asm):01135                 LEAX    1,X                               ;SKIP TO DATA
2736 10BE4000         (         mapl.asm):01136                 LDY     FREE                              ;POINT TO FREE RAM
273A EC84             (         mapl.asm):01137                 LDD     ,X                                ;GET LENGTH
273C 33AB             (         mapl.asm):01138                 LEAU    D,Y                               ;ADVANCE FOR FLAG VECTOR SPACE
273E 3440             (         mapl.asm):01139                 PSHS    U                                 ;SAVE FREE LOCATION
2740 2707             (         mapl.asm):01140                 BEQ     ASC8                              ;ZERO LENGTH, NOTHING TO DO
2742                  (         mapl.asm):01141         ASC0
2742 6FA0             (         mapl.asm):01142                 CLR     ,Y+                               ;CLEAR ONE FLAG
2744 830001           (         mapl.asm):01143                 SUBD    #1                                ;REDUCE COUNT
2747 26F9             (         mapl.asm):01144                 BNE     ASC0                              ;CLEAR THEM ALL
2749                  (         mapl.asm):01145         ASC8
2749 8601             (         mapl.asm):01146                 LDA     #1                                ;RESULT IS ALWAYS AN INTEGER
274B A7C0             (         mapl.asm):01147                 STA     ,U+                               ;SET TYPE OF RESULT
274D EC81             (         mapl.asm):01148                 LDD     ,X++                              ;GET LENGTH AGAIN
274F EDC1             (         mapl.asm):01149                 STD     ,U++                              ;SET LENGTH OF RESULT
2751 2746             (         mapl.asm):01150                 BEQ     ASC1                              ;IF ZERO LENGTH, NOTHING TO DO
2753 1F02             (         mapl.asm):01151                 TFR     D,Y                               ;SAVE LENGTH
2755 FD3C88           (         mapl.asm):01152                 STD     TEMP1                             ;AND KEEP IT
2758 A61D             (         mapl.asm):01153                 LDA     -3,X                              ;GET TYPE
275A 2742             (         mapl.asm):01154                 BEQ     ASC5                              ;CHARACTER SORT
275C                  (         mapl.asm):01155         ASC2
275C 3430             (         mapl.asm):01156                 PSHS    X,Y                               ;SAVE REGISTERS
275E 3440             (         mapl.asm):01157                 PSHS    U                                 ;SAVE LOCATION
2760 4F               (         mapl.asm):01158                 CLRA                                      ;     START
2761 5F               (         mapl.asm):01159                 CLRB                                      ;     WITH ZERO
2762 10BE3C88         (         mapl.asm):01160                 LDY     TEMP1                             ;GET LENGTH
2766 FE4000           (         mapl.asm):01161                 LDU     FREE                              ;POINT TO FLAG VECTOR
2769                  (         mapl.asm):01162         ASC3
2769 6DC0             (         mapl.asm):01163                 TST     ,U+                               ;TEST FOR ELEMENT ALREADY SELECTED
276B 260E             (         mapl.asm):01164                 BNE     ASC4                              ;IF SO, DON'T LOOK AT IT
276D 10A384           (         mapl.asm):01165                 CMPD    ,X                                ;TEST FOR SMALLEST ELEMENT
2770 2209             (         mapl.asm):01166                 BHI     ASC4                              ;NO, SKIP IT
2772 10BF3C8C         (         mapl.asm):01167                 STY     TEMP3                             ;SAVE ELEMENT NUMBER
2776 FF3C8A           (         mapl.asm):01168                 STU     TEMP2                             ;SAVE FLAG VECTOR ADDRESS
2779 EC84             (         mapl.asm):01169                 LDD     ,X                                ;USE THIS AS THE NEW VALUE
277B                  (         mapl.asm):01170         ASC4
277B 3002             (         mapl.asm):01171                 LEAX    2,X                               ;SKIP TO NEXT ELEMENT
277D 313F             (         mapl.asm):01172                 LEAY    -1,Y                              ;REDUCE COUNT
277F 26E8             (         mapl.asm):01173                 BNE     ASC3                              ;KEEP GOING TILL WE DO IT ALL
2781 BE3C8A           (         mapl.asm):01174                 LDX     TEMP2                             ;GET FLAG VECTOR ADDRESS
2784 6A1F             (         mapl.asm):01175                 DEC     -1,X                              ;SET FLAG
2786 3540             (         mapl.asm):01176                 PULS    U                                 ;RESTORE RESULT ADDRESS
2788 FC3C8C           (         mapl.asm):01177                 LDD     TEMP3                             ;GET ELEMENT NUMBER
278B 830001           (         mapl.asm):01178                 SUBD    #1                                ;CONVERT TO ZERO OFFSET
278E F34002           (         mapl.asm):01179                 ADDD    ORIGIN                            ;AND ADJUST FOR ORIGIN
2791 EDC1             (         mapl.asm):01180                 STD     ,U++                              ;SAVE IN RSULT
2793 3530             (         mapl.asm):01181                 PULS    X,Y                               ;RESTORE POINTERS
2795 313F             (         mapl.asm):01182                 LEAY    -1,Y                              ;REDUCE REMAINING COUNT
2797 26C3             (         mapl.asm):01183                 BNE     ASC2                              ;AND DO THEM ALL
2799                  (         mapl.asm):01184         ASC1
2799 3570             (         mapl.asm):01185                 PULS    X,Y,U                             ;RESTORE POINTERS
279B 16FE98           (         mapl.asm):01186                 LBRA    NXTOPR
279E                  (         mapl.asm):01187         ASC5
279E 3430             (         mapl.asm):01188                 PSHS    X,Y                               ;SAVE REGISTERS
27A0 3440             (         mapl.asm):01189                 PSHS    U                                 ;SAVE LOCATION
27A2 4F               (         mapl.asm):01190                 CLRA                                      ;     START
27A3 10BE3C88         (         mapl.asm):01191                 LDY     TEMP1                             ;GET LENGTH
27A7 FE4000           (         mapl.asm):01192                 LDU     FREE                              ;POINT TO FLAG VECTOR
27AA                  (         mapl.asm):01193         ASC6
27AA 6DC0             (         mapl.asm):01194                 TST     ,U+                               ;TEST FOR ELEMENT ALREADY SELECTED
27AC 260D             (         mapl.asm):01195                 BNE     ASC7                              ;IF SO, DON'T LOOK AT IT
27AE A184             (         mapl.asm):01196                 CMPA    ,X                                ;TEST FOR SMALLEST ELEMENT
27B0 2209             (         mapl.asm):01197                 BHI     ASC7                              ;NO, SKIP IT
27B2 10BF3C8C         (         mapl.asm):01198                 STY     TEMP3                             ;SAVE ELEMENT NUMBER
27B6 FF3C8A           (         mapl.asm):01199                 STU     TEMP2                             ;SAVE FLAG VECTOR ADDRESS
27B9 A684             (         mapl.asm):01200                 LDA     ,X                                ;USE THIS AS THE NEW VALUE
27BB                  (         mapl.asm):01201         ASC7
27BB 3001             (         mapl.asm):01202                 LEAX    1,X                               ;SKIP TO NEXT ELEMENT
27BD 313F             (         mapl.asm):01203                 LEAY    -1,Y                              ;REDUCE COUNT
27BF 26E9             (         mapl.asm):01204                 BNE     ASC6                              ;KEEP GOING TILL WE DO IT ALL
27C1 BE3C8A           (         mapl.asm):01205                 LDX     TEMP2                             ;GET FLAG VECTOR ADDRESS
27C4 6A1F             (         mapl.asm):01206                 DEC     -1,X                              ;SET FLAG
27C6 3540             (         mapl.asm):01207                 PULS    U                                 ;RESTORE RESULT ADDRESS
27C8 FC3C8C           (         mapl.asm):01208                 LDD     TEMP3                             ;GET ELEMENT NUMBER
27CB 830001           (         mapl.asm):01209                 SUBD    #1                                ;CONVERT TO ZERO OFFSET
27CE F34002           (         mapl.asm):01210                 ADDD    ORIGIN                            ;AND ADJUST FOR ORIGIN
27D1 EDC1             (         mapl.asm):01211                 STD     ,U++                              ;SAVE IN RSULT
27D3 3530             (         mapl.asm):01212                 PULS    X,Y                               ;RESTORE POINTERS
27D5 313F             (         mapl.asm):01213                 LEAY    -1,Y                              ;REDUCE REMAINING COUNT
27D7 26C5             (         mapl.asm):01214                 BNE     ASC5                              ;AND DO THEM ALL
27D9 20BE             (         mapl.asm):01215                 BRA     ASC1                              ;GO HOME
                      (         mapl.asm):01216         ;* EXECUTE STRING
27DB                  (         mapl.asm):01217         DSIP7
27DB 8165             (         mapl.asm):01218                 CMPA    #'e'                              ;EXECUTE?
27DD 2637             (         mapl.asm):01219                 BNE     DSIP8                             ;NO, TRY STRING FORMAT
27DF A680             (         mapl.asm):01220                 LDA     ,X+                               ;GET TYPE
27E1 10260B27         (         mapl.asm):01221                 LBNE    CDOM                              ;NOT VALID
27E5 EC81             (         mapl.asm):01222                 LDD     ,X++                              ;GET LENGTH OF STRING
27E7 2725             (         mapl.asm):01223                 BEQ     NOEXEC                            ;NOTHING TO EXECUTE
27E9 10830080         (         mapl.asm):01224                 CMPD    #128                              ;ARE WE OVER LENGTH
27ED 10240B14         (         mapl.asm):01225                 LBHS    CLEN                              ;INDICATE EXEC OVER 255 CHARACTERS
27F1 3420             (         mapl.asm):01226                 PSHS    Y                                 ;SAVE POINTERS
27F3 3185             (         mapl.asm):01227                 LEAY    B,X                               ;POINT TO BUFFER
27F5 1F21             (         mapl.asm):01228                 TFR     Y,X                               ;COPY TO X
27F7 860D             (         mapl.asm):01229                 LDA     #$0D                              ;GET CR
27F9 A7A0             (         mapl.asm):01230                 STA     ,Y+                               ;SAVE IT
27FB                  (         mapl.asm):01231         DS71
27FB A682             (         mapl.asm):01232                 LDA     ,-X                               ;GET CHARACTER FROM BUFFER
27FD A7A0             (         mapl.asm):01233                 STA     ,Y+                               ;SAVE IN OUTPUT
27FF 5A               (         mapl.asm):01234                 DECB                                      ;     REDUCE COUNT
2800 26F9             (         mapl.asm):01235                 BNE     DS71                              ;CONTINUE
2802 860D             (         mapl.asm):01236                 LDA     #$0D                              ;GET CR
2804 A7A4             (         mapl.asm):01237                 STA     ,Y                                ;SAVE IT
2806 17FE0D           (         mapl.asm):01238                 LBSR    DOEXPR                            ;PERFORM EXPRESSION
2809 3520             (         mapl.asm):01239                 PULS    Y                                 ;RESTORE Y REGISTER
280B                  (         mapl.asm):01240         DS72
280B 16FE28           (         mapl.asm):01241                 LBRA    NXTOPR                            ;GET NEXT OPERAND
                      (         mapl.asm):01242         ;* EXECUTE OF NULL LENGTH VECTOR, DO NOTHING, NO OUTPUT
280E                  (         mapl.asm):01243         NOEXEC
280E 8E3A3E           (         mapl.asm):01244                 LDX     #IOTA0                            ;POINT TO DEFAULT PARAMETER
2811 7A3CA4           (         mapl.asm):01245                 DEC     ASSFLG                            ;DON'T DISPLAY EXECUTE OF NULL
2814 20F5             (         mapl.asm):01246                 BRA     DS72                              ;AND GO HOME
                      (         mapl.asm):01247         ;* FORMAT NUMERIC VALUE TO STRING
2816                  (         mapl.asm):01248         DSIP8
2816 8173             (         mapl.asm):01249                 CMPA    #'s'                              ;IS IT FORMAT STRING?
2818 264C             (         mapl.asm):01250                 BNE     BRANCH                            ;NO, TRY BRANCH
281A 3460             (         mapl.asm):01251                 PSHS    Y,U                               ;SAVE REGISTERS
281C FE4000           (         mapl.asm):01252                 LDU     FREE                              ;AND A PLACE TO PUT IT
281F 6FC0             (         mapl.asm):01253                 CLR     ,U+                               ;CHARACTER DATA
2821 3342             (         mapl.asm):01254                 LEAU    2,U                               ;ADVANCE PAST LENGTH FOR NOW
2823 108E0000         (         mapl.asm):01255                 LDY     #0                                ;LENGTH OF OUTPUT
2827 A680             (         mapl.asm):01256                 LDA     ,X+                               ;GET TYPE
2829 10270ADF         (         mapl.asm):01257                 LBEQ    CDOM                              ;INDICATE DOMAIN ERROR
282D EC81             (         mapl.asm):01258                 LDD     ,X++                              ;GET LENGTH
282F 272A             (         mapl.asm):01259                 BEQ     DECS1                             ;EXIT IF ZERO
2831                  (         mapl.asm):01260         DECS2
2831 3416             (         mapl.asm):01261                 PSHS    A,B,X                             ;SAVE REGISTERS
2833 AE84             (         mapl.asm):01262                 LDX     ,X                                ;GET NUMBER TO DISPLAY
2835                  (         mapl.asm):01263         DECS
2835 CC000A           (         mapl.asm):01264                 LDD     #10                               ;DIVIDE BY 10
2838 17FD71           (         mapl.asm):01265                 LBSR    DIV                               ;PERFORM DIVISION
283B CA30             (         mapl.asm):01266                 ORB     #$30                              ;CONVERT TO NUMBER
283D E7C0             (         mapl.asm):01267                 STB     ,U+                               ;SAVE DIGIT
283F 3121             (         mapl.asm):01268                 LEAY    1,Y                               ;ADVANCE LENGTH
2841 8C0000           (         mapl.asm):01269                 CMPX    #0                                ;OVER YET?
2844 26EF             (         mapl.asm):01270                 BNE     DECS                              ;NO, KEEP GOING
2846 3516             (         mapl.asm):01271                 PULS    A,B,X                             ;RESTORE REGISTERS
2848 830001           (         mapl.asm):01272                 SUBD    #1                                ;ARE WE DONE?
284B 270E             (         mapl.asm):01273                 BEQ     DECS1                             ;IF SO, QUIT
284D 3402             (         mapl.asm):01274                 PSHS    A                                 ;SAVE A
284F 8620             (         mapl.asm):01275                 LDA     #' '                              ;GET SPACE
2851 A7C0             (         mapl.asm):01276                 STA     ,U+                               ;SAVE
2853 3502             (         mapl.asm):01277                 PULS    A                                 ;RESTORE
2855 3121             (         mapl.asm):01278                 LEAY    1,Y                               ;ADVANCE LENGTH
2857 3002             (         mapl.asm):01279                 LEAX    2,X                               ;ADVANCE TO NEXT
2859 20D6             (         mapl.asm):01280                 BRA     DECS2                             ;AND CONTINUE
285B                  (         mapl.asm):01281         DECS1
285B BE4000           (         mapl.asm):01282                 LDX     FREE                              ;POINT TO OUTPUT
285E 10AF01           (         mapl.asm):01283                 STY     1,X                               ;SET UP LENGTH
2861 3560             (         mapl.asm):01284                 PULS    Y,U                               ;RESTORE REGS
2863 16FDD0           (         mapl.asm):01285                 LBRA    NXTOPR                            ;AND GET NEXT
                      (         mapl.asm):01286         ;* BRANCH OPERATOR
2866                  (         mapl.asm):01287         BRANCH
2866 8162             (         mapl.asm):01288                 CMPA    #'b'                              ;IS IT BRANCH?
2868 261D             (         mapl.asm):01289                 BNE     TRAVEL                            ;NO, TRY TRAVEL
286A A684             (         mapl.asm):01290                 LDA     ,X                                ;GET TYPE
286C 10270A9C         (         mapl.asm):01291                 LBEQ    CDOM                              ;INDICATE DOMAIN ERROR
2870 EC01             (         mapl.asm):01292                 LDD     1,X                               ;GET LENGTH
2872 270D             (         mapl.asm):01293                 BEQ     NOBRA                             ;DON'T BRANCH
2874 10830001         (         mapl.asm):01294                 CMPD    #1                                ;IS IT PROPER LENGTH?
2878 10260A89         (         mapl.asm):01295                 LBNE    CLEN                              ;INDICATE LENGTH ERROR
287C EC03             (         mapl.asm):01296                 LDD     3,X                               ;GET VALUE
287E FD3C98           (         mapl.asm):01297                 STD     GOTO                              ;SAVE IN FLAG
2881                  (         mapl.asm):01298         NOBRA
2881 7A3CA4           (         mapl.asm):01299                 DEC     ASSFLG                            ;INSURE NO JUMP
2884 16FDAF           (         mapl.asm):01300                 LBRA    NXTOPR                            ;GO FOR IT
                      (         mapl.asm):01301         ;* OPERATOR TRAVEL
2887                  (         mapl.asm):01302         TRAVEL
2887 815C             (         mapl.asm):01303                 CMPA    #'\'                              ;IS IT TRAVEL
2889 102600A8         (         mapl.asm):01304                 LBNE    REDUC                             ;NO, TRY REDUCTION
288D 17FC0D           (         mapl.asm):01305                 LBSR    SKBKP                             ;GET NEXT OPERATOR
2890 6D84             (         mapl.asm):01306                 TST     ,X                                ;TEST TYPE OF OPERAND
2892 10270A76         (         mapl.asm):01307                 LBEQ    CDOM                              ;NOT VALID WITH CHARACTER
2896 3430             (         mapl.asm):01308                 PSHS    X,Y                               ;SAVE REGISTERS
2898 C601             (         mapl.asm):01309                 LDB     #1                                ;GET TYPE OF RESULT
289A E780             (         mapl.asm):01310                 STB     ,X+                               ;SAVE TYPE
289C 10AE84           (         mapl.asm):01311                 LDY     ,X                                ;GET LENGTH
289F 3121             (         mapl.asm):01312                 LEAY    1,Y                               ;CONVERT
28A1 4F               (         mapl.asm):01313                 CLRA                                      ;     ZERO HIGH BYTE
28A2 ED81             (         mapl.asm):01314                 STD     ,X++                              ;SAVE NEW LENGTH
28A4 A6F802           (         mapl.asm):01315                 LDA     [2,S]                             ;GET OPERATOR BACK
28A7 812B             (         mapl.asm):01316                 CMPA    #'+'                              ;ADDITION?
28A9 260A             (         mapl.asm):01317                 BNE     CMP1                              ;NO, TRY MULTIPLY
28AB 4F               (         mapl.asm):01318                 CLRA
28AC 5F               (         mapl.asm):01319                 CLRB                                      ;     INITIAL VALUE IS ZERO
28AD                  (         mapl.asm):01320         CMPA
28AD 313F             (         mapl.asm):01321                 LEAY    -1,Y                              ;REDUCE COUNT
28AF 273D             (         mapl.asm):01322                 BEQ     CMP9                              ;END OF OPERAND, QUIT
28B1 E381             (         mapl.asm):01323                 ADDD    ,X++                              ;ADD NEXT ELEMENT
28B3 20F8             (         mapl.asm):01324                 BRA     CMPA                              ;DO NEXT
28B5                  (         mapl.asm):01325         CMP1
28B5 8178             (         mapl.asm):01326                 CMPA    #'x'                              ;MULTIPLY?
28B7 2614             (         mapl.asm):01327                 BNE     CMP2                              ;NO, TRY LOGICAL AND
28B9 CC0001           (         mapl.asm):01328                 LDD     #1                                ;INITIAL VALUE IS ONE
28BC                  (         mapl.asm):01329         CMPB
28BC 313F             (         mapl.asm):01330                 LEAY    -1,Y                              ;REDUCE COUNT
28BE 272E             (         mapl.asm):01331                 BEQ     CMP9                              ;END OF OPERAND, QUIT
28C0 3410             (         mapl.asm):01332                 PSHS    X                                 ;SAVE POINTER TO OPERAND
28C2 AE84             (         mapl.asm):01333                 LDX     ,X                                ;GET VALUE
28C4 17FCC5           (         mapl.asm):01334                 LBSR    MULT                              ;PERFORM MULTIPLY
28C7 3510             (         mapl.asm):01335                 PULS    X                                 ;RESTORE POINTER
28C9 3002             (         mapl.asm):01336                 LEAX    2,X                               ;ADVANCE TO NEXT
28CB 20EF             (         mapl.asm):01337                 BRA     CMPB                              ;GO AGAIN
28CD                  (         mapl.asm):01338         CMP2
28CD 8126             (         mapl.asm):01339                 CMPA    #'&'                              ;LOGICAL AND?
28CF 260D             (         mapl.asm):01340                 BNE     CMP3                              ;NO, TRY LOGICAL OR
28D1 CCFFFF           (         mapl.asm):01341                 LDD     #$FFFF                            ;INTIAL VALUE
28D4                  (         mapl.asm):01342         CMPC
28D4 313F             (         mapl.asm):01343                 LEAY    -1,Y                              ;REDUCE COUNT
28D6 2716             (         mapl.asm):01344                 BEQ     CMP9                              ;END, QUIT
28D8 A480             (         mapl.asm):01345                 ANDA    ,X+                               ;AND HIGH BYTE
28DA E480             (         mapl.asm):01346                 ANDB    ,X+                               ;AND LOW BYTE
28DC 20F6             (         mapl.asm):01347                 BRA     CMPC                              ;AND CONTINUE
28DE                  (         mapl.asm):01348         CMP3
28DE 8121             (         mapl.asm):01349                 CMPA    #'!'                              ;LOGICAL OR?
28E0 2615             (         mapl.asm):01350                 BNE     CMP6                              ;NO, TRY XOR
28E2 4F               (         mapl.asm):01351                 CLRA
28E3 5F               (         mapl.asm):01352                 CLRB                                      ;     START WITH ZERO
28E4                  (         mapl.asm):01353         CMPD
28E4 313F             (         mapl.asm):01354                 LEAY    -1,Y                              ;REDUCE COUNT
28E6 2706             (         mapl.asm):01355                 BEQ     CMP9                              ;END, QUIT
28E8 AA80             (         mapl.asm):01356                 ORA     ,X+                               ;OR HIGH BYTE
28EA EA80             (         mapl.asm):01357                 ORB     ,X+                               ;OR LOW BYTE
28EC 20F6             (         mapl.asm):01358                 BRA     CMPD                              ;GO AGAIN
28EE                  (         mapl.asm):01359         CMP9
28EE 3530             (         mapl.asm):01360                 PULS    X,Y                               ;RESTORE REGISTERS
28F0 313F             (         mapl.asm):01361                 LEAY    -1,Y                              ;BACKUP PAST OPERATOR
28F2 ED03             (         mapl.asm):01362                 STD     3,X                               ;SAVE VALUE OR RESULT
28F4 16FD3F           (         mapl.asm):01363                 LBRA    NXTOPR                            ;AND GET NEXT
28F7                  (         mapl.asm):01364         CMP6
28F7 817C             (         mapl.asm):01365                 CMPA    #'|'                              ;XOR?
28F9 260C             (         mapl.asm):01366                 BNE     CMP4                              ;NO, TRY GREATOR OF
28FB 4F               (         mapl.asm):01367                 CLRA
28FC 5F               (         mapl.asm):01368                 CLRB                                      ;     START WITH ZERO
28FD                  (         mapl.asm):01369         CMPZ
28FD 313F             (         mapl.asm):01370                 LEAY    -1,Y                              ;REDUCE COUNT
28FF 27ED             (         mapl.asm):01371                 BEQ     CMP9                              ;END IF DONE
2901 A880             (         mapl.asm):01372                 EORA    ,X+                               ;XOR HIGH BYTE
2903 E880             (         mapl.asm):01373                 EORB    ,X+                               ;XOR LOW BYTE
2905 20F6             (         mapl.asm):01374                 BRA     CMPZ                              ;CONTINUE
2907                  (         mapl.asm):01375         CMP4
2907 8167             (         mapl.asm):01376                 CMPA    #'g'                              ;GREATOR OF?
2909 260F             (         mapl.asm):01377                 BNE     CMP5                              ;NO, TRY LESS OF
290B 4F               (         mapl.asm):01378                 CLRA
290C 5F               (         mapl.asm):01379                 CLRB                                      ;     START WITH ZERO
290D                  (         mapl.asm):01380         CMPE
290D 313F             (         mapl.asm):01381                 LEAY    -1,Y                              ;REDUCE COUNT
290F 27DD             (         mapl.asm):01382                 BEQ     CMP9                              ;END, QUIT
2911 10A381           (         mapl.asm):01383                 CMPD    ,X++                              ;TEST FOR GREATOR
2914 24F7             (         mapl.asm):01384                 BHS     CMPE                              ;NO, SKIP IT
2916 EC1E             (         mapl.asm):01385                 LDD     -2,X                              ;REPLACE VALUE
2918 20F3             (         mapl.asm):01386                 BRA     CMPE                              ;AND TRY AGAIN
291A                  (         mapl.asm):01387         CMP5
291A 816C             (         mapl.asm):01388                 CMPA    #'l'                              ;LESS OF?
291C 2610             (         mapl.asm):01389                 BNE     CSYNT                             ;NO, GET UPSET
291E CCFFFF           (         mapl.asm):01390                 LDD     #$FFFF                            ;START WITH FFFF
2921                  (         mapl.asm):01391         CMPF
2921 313F             (         mapl.asm):01392                 LEAY    -1,Y                              ;REDUCE COUNT
2923 27C9             (         mapl.asm):01393                 BEQ     CMP9                              ;END, QUIT
2925 10A381           (         mapl.asm):01394                 CMPD    ,X++                              ;TEST FOR LESS
2928 23F7             (         mapl.asm):01395                 BLS     CMPF                              ;NO, SKIP IT
292A EC1E             (         mapl.asm):01396                 LDD     -2,X                              ;REPLACE VALUE
292C 20F3             (         mapl.asm):01397                 BRA     CMPF                              ;AND GO AGAIN
292E                  (         mapl.asm):01398         CSYNT
292E 10BE3C9E         (         mapl.asm):01399                 LDY     TXTPTR                            ;POINT TO TEXT
2932 160AC6           (         mapl.asm):01400                 LBRA    SYNTAX
                      (         mapl.asm):01401         ;*
                      (         mapl.asm):01402         ;* EXTRACT OPERATOR
                      (         mapl.asm):01403         ;*
2935                  (         mapl.asm):01404         REDUC
2935 812F             (         mapl.asm):01405                 CMPA    #'/'                              ;EXTRACT?
2937 10260085         (         mapl.asm):01406                 LBNE    DYADIC                            ;NO, TRY DYADIC FUNCTIONS
293B 3450             (         mapl.asm):01407                 PSHS    X,U                               ;SAVE REGISTERS
293D 1705E2           (         mapl.asm):01408                 LBSR    GETPRM                            ;GET PARAMETER
2940 EEE4             (         mapl.asm):01409                 LDU     ,S                                ;GET POINTER BACK
2942 A680             (         mapl.asm):01410                 LDA     ,X+                               ;GET TYPE OF OPERAND?
2944 102709C4         (         mapl.asm):01411                 LBEQ    CDOM                              ;DOMAIN ERROR IF CHARACTER
2948 4F               (         mapl.asm):01412                 CLRA
2949 5F               (         mapl.asm):01413                 CLRB                                      ;     GET A ZERO
294A FD3C84           (         mapl.asm):01414                 STD     TEMP                              ;CLEAR LENGTH SAVER
294D EC81             (         mapl.asm):01415                 LDD     ,X++                              ;GET LENGTH
294F 3420             (         mapl.asm):01416                 PSHS    Y                                 ;SAVE Y POINTER
2951 10A341           (         mapl.asm):01417                 CMPD    1,U                               ;IS LENGTH THE SAME?
2954 3343             (         mapl.asm):01418                 LEAU    3,U                               ;SKIP TO DATA
2956 1F32             (         mapl.asm):01419                 TFR     U,Y                               ;SAVE FOR LATER
2958 262A             (         mapl.asm):01420                 BNE     RED1                              ;NO, TRY SCALER OPERATION
295A C30001           (         mapl.asm):01421                 ADDD    #1                                ;ADVANCE
295D 6D5D             (         mapl.asm):01422                 TST     -3,U                              ;CHARACTER?
295F 2741             (         mapl.asm):01423                 BEQ     RED5                              ;DO IT FOR CHARACTER
2961                  (         mapl.asm):01424         RED2
2961 830001           (         mapl.asm):01425                 SUBD    #1                                ;DEC. COUNT
2964 2719             (         mapl.asm):01426                 BEQ     RED3                              ;SAVE
2966 3406             (         mapl.asm):01427                 PSHS    A,B                               ;SAVE
2968 EC81             (         mapl.asm):01428                 LDD     ,X++                              ;TEST FOR NUMBER
296A 270D             (         mapl.asm):01429                 BEQ     RED4                              ;DON'T INCLUDE THIS ELEMENT
296C ECC4             (         mapl.asm):01430                 LDD     ,U                                ;GET ELEMENT
296E EDA1             (         mapl.asm):01431                 STD     ,Y++                              ;SAVE IN OUTPUT
2970 FC3C84           (         mapl.asm):01432                 LDD     TEMP                              ;GET LENGTH
2973 C30001           (         mapl.asm):01433                 ADDD    #1                                ;ADVANCE
2976 FD3C84           (         mapl.asm):01434                 STD     TEMP                              ;RESAVE
2979                  (         mapl.asm):01435         RED4
2979 3506             (         mapl.asm):01436                 PULS    A,B                               ;RESTORE
297B 3342             (         mapl.asm):01437                 LEAU    2,U                               ;ADVANCE
297D 20E2             (         mapl.asm):01438                 BRA     RED2                              ;RESAVE
297F                  (         mapl.asm):01439         RED3
297F FC3C84           (         mapl.asm):01440                 LDD     TEMP                              ;GET LENGTH
2982 200E             (         mapl.asm):01441                 BRA     RED9                              ;SET LENGTH
2984                  (         mapl.asm):01442         RED1
2984 10830001         (         mapl.asm):01443                 CMPD    #1                                ;TEST FOR LENGTH 1?
2988 10260979         (         mapl.asm):01444                 LBNE    CLEN                              ;INVALID
298C EC84             (         mapl.asm):01445                 LDD     ,X                                ;GET VALUE
298E 260B             (         mapl.asm):01446                 BNE     RED8                              ;WORKED
2990 4F               (         mapl.asm):01447                 CLRA
2991 5F               (         mapl.asm):01448                 CLRB                                      ;     ZERO LENGTH
2992                  (         mapl.asm):01449         RED9
2992 3520             (         mapl.asm):01450                 PULS    Y                                 ;RESTORE POINTER
2994 3550             (         mapl.asm):01451                 PULS    X,U                               ;AND REGISTERS
2996 ED01             (         mapl.asm):01452                 STD     1,X                               ;SET LENGTH
2998 16FC9B           (         mapl.asm):01453                 LBRA    NXTOPR
299B                  (         mapl.asm):01454         RED8
299B 3520             (         mapl.asm):01455                 PULS    Y                                 ;RESTORE Y
299D 3550             (         mapl.asm):01456                 PULS    X,U                               ;RESTORE POINTERS
299F 16FC94           (         mapl.asm):01457                 LBRA    NXTOPR
29A2                  (         mapl.asm):01458         RED5
29A2 830001           (         mapl.asm):01459                 SUBD    #1                                ;DEC. COUNT
29A5 27D8             (         mapl.asm):01460                 BEQ     RED3                              ;SAVE
29A7 3406             (         mapl.asm):01461                 PSHS    A,B                               ;SAVE ACC
29A9 EC81             (         mapl.asm):01462                 LDD     ,X++                              ;TEST FOR NUMBER
29AB 270D             (         mapl.asm):01463                 BEQ     RED6                              ;DON'T INCLUDE THIS ELEMENT
29AD A6C4             (         mapl.asm):01464                 LDA     ,U                                ;GET ELEMENT
29AF A7A0             (         mapl.asm):01465                 STA     ,Y+                               ;SAVE IN OUTPUT
29B1 FC3C84           (         mapl.asm):01466                 LDD     TEMP                              ;GET LENGTH
29B4 C30001           (         mapl.asm):01467                 ADDD    #1                                ;ADVANCE
29B7 FD3C84           (         mapl.asm):01468                 STD     TEMP                              ;RESAVE
29BA                  (         mapl.asm):01469         RED6
29BA 3506             (         mapl.asm):01470                 PULS    A,B                               ;RESTORE
29BC 3341             (         mapl.asm):01471                 LEAU    1,U                               ;ADVANCE
29BE 20E2             (         mapl.asm):01472                 BRA     RED5                              ;RESAVE
                      (         mapl.asm):01473         ;*
                      (         mapl.asm):01474         ;* DYADIC OPERATORS
                      (         mapl.asm):01475         ;*
29C0                  (         mapl.asm):01476         DYADIC
29C0 813B             (         mapl.asm):01477                 CMPA    #';'                              ;IS IT JOIN?
29C2 2644             (         mapl.asm):01478                 BNE     SEARCH                            ;NO, TRY NEXT
29C4 3470             (         mapl.asm):01479                 PSHS    X,Y,U                             ;SAVE REGISTERS
29C6 170559           (         mapl.asm):01480                 LBSR    GETPRM                            ;GET OPERAND VALUE
29C9 10AF62           (         mapl.asm):01481                 STY     2,S                               ;SAVE NEW TEXT POSITION
29CC EEE4             (         mapl.asm):01482                 LDU     ,S                                ;GET OLD OPERAND LOCATION
29CE A6C0             (         mapl.asm):01483                 LDA     ,U+                               ;GET TYPE FOR OLD OPERAND
29D0 A180             (         mapl.asm):01484                 CMPA    ,X+                               ;TEST AGAIN OTHER OPERAND TYPE
29D2 10260936         (         mapl.asm):01485                 LBNE    CDOM                              ;MISMATCHED, ERROR
29D6 EC81             (         mapl.asm):01486                 LDD     ,X++                              ;GET LENGTH OF NEW OPERAND
29D8 271D             (         mapl.asm):01487                 BEQ     CON1                              ;IF ZERO, IT'S OK
29DA 3406             (         mapl.asm):01488                 PSHS    A,B                               ;SAVE LENGTH
29DC E3C4             (         mapl.asm):01489                 ADDD    ,U                                ;ADD TO OLD OPERAND LENGTH
29DE 10AEC4           (         mapl.asm):01490                 LDY     ,U                                ;GET OLD LENGTH
29E1 EDC1             (         mapl.asm):01491                 STD     ,U++                              ;SAVE NEW LENGTH VALUE
29E3 1F20             (         mapl.asm):01492                 TFR     Y,D                               ;PUT OLD LENGTH IN D
29E5 3520             (         mapl.asm):01493                 PULS    Y                                 ;GET NEW LENGTH IN Y
29E7 6D5D             (         mapl.asm):01494                 TST     -3,U                              ;CHECK FOR CHARACTER DATA
29E9 2711             (         mapl.asm):01495                 BEQ     CON3                              ;IT'S CHARACTER
29EB 58               (         mapl.asm):01496                 LSLB
29EC 49               (         mapl.asm):01497                 ROLA                                      ;     DOUBLE FOR WORD ELEMENTS
29ED 33CB             (         mapl.asm):01498                 LEAU    D,U                               ;OFFSET TO NEW LOCATION
29EF                  (         mapl.asm):01499         CON2
29EF EC81             (         mapl.asm):01500                 LDD     ,X++                              ;GET ELEMENT FROM OLD OPERAND
29F1 EDC1             (         mapl.asm):01501                 STD     ,U++                              ;SAVE IN NEW OPERAND
29F3 313F             (         mapl.asm):01502                 LEAY    -1,Y                              ;REDUCE COUNT
29F5 26F8             (         mapl.asm):01503                 BNE     CON2                              ;GO AGAIN
29F7                  (         mapl.asm):01504         CON1
29F7 3570             (         mapl.asm):01505                 PULS    X,Y,U                             ;RESTORE REGISTERS
29F9 16FC3A           (         mapl.asm):01506                 LBRA    NXTOPR
29FC                  (         mapl.asm):01507         CON3
29FC 33CB             (         mapl.asm):01508                 LEAU    D,U                               ;SKIP TO END OF CHARACTER ARRAY
29FE                  (         mapl.asm):01509         CON4
29FE A680             (         mapl.asm):01510                 LDA     ,X+                               ;GET CHARACTER FROM OLD
2A00 A7C0             (         mapl.asm):01511                 STA     ,U+                               ;SAVE IN NEW
2A02 313F             (         mapl.asm):01512                 LEAY    -1,Y                              ;REDUCE COUNT
2A04 26F8             (         mapl.asm):01513                 BNE     CON4                              ;GO AGAIN
2A06 20EF             (         mapl.asm):01514                 BRA     CON1                              ;AND GO HOME
                      (         mapl.asm):01515         ;* FIND SUBSTRING
2A08                  (         mapl.asm):01516         SEARCH
2A08 8166             (         mapl.asm):01517                 CMPA    #'f'                              ;IS IT SEARCH?
2A0A 1026008F         (         mapl.asm):01518                 LBNE    ADROP                             ;NO, TRY EQUALS TEST
2A0E 3450             (         mapl.asm):01519                 PSHS    X,U                               ;SAVE REGS
2A10 17050F           (         mapl.asm):01520                 LBSR    GETPRM                            ;GET PARAMETER VALUE
2A13 EEE4             (         mapl.asm):01521                 LDU     ,S                                ;GET OLD OPERAND POINTER BACK
2A15 A684             (         mapl.asm):01522                 LDA     ,X                                ;GET TYPE
2A17 A1C0             (         mapl.asm):01523                 CMPA    ,U+                               ;IS IT SAME?
2A19 102608EF         (         mapl.asm):01524                 LBNE    CDOM                              ;NO, ERROR
2A1D B73C88           (         mapl.asm):01525                 STA     TEMP1                             ;SAVE FOR LATER REF
2A20 3420             (         mapl.asm):01526                 PSHS    Y                                 ;SAVE TEXT POINTER
2A22 ECC1             (         mapl.asm):01527                 LDD     ,U++                              ;GET LENGTH OF STRING WE LOOK FOR
2A24 102708DD         (         mapl.asm):01528                 LBEQ    CLEN                              ;INDICATE INVALID LENGTH
2A28 10AE01           (         mapl.asm):01529                 LDY     1,X                               ;GET LENGTH OF SOURCE STRING
2A2B 10BF3C8A         (         mapl.asm):01530                 STY     TEMP2                             ;SAVE FOR LATER REF
2A2F 1708E1           (         mapl.asm):01531                 LBSR    CALLEN                            ;GET LENGTH
2A32 308B             (         mapl.asm):01532                 LEAX    D,X                               ;ADVANCE TO NEXT
2A34 1E13             (         mapl.asm):01533                 EXG     X,U                               ;SWAP
2A36 BF3C84           (         mapl.asm):01534                 STX     TEMP                              ;SAVE BACKUP POSITION
2A39 301D             (         mapl.asm):01535                 LEAX    -3,X                              ;BACKUP TO START
2A3B 1708D5           (         mapl.asm):01536                 LBSR    CALLEN                            ;CALCULATE LENGTH
2A3E 308B             (         mapl.asm):01537                 LEAX    D,X                               ;SKIP TO END
2A40 3410             (         mapl.asm):01538                 PSHS    X                                 ;SAVE POINTER
2A42 3121             (         mapl.asm):01539                 LEAY    1,Y                               ;ADVANCE FOR DEC
2A44 7D3C88           (         mapl.asm):01540                 TST     TEMP1                             ;CHARACTER VALUES?
2A47 273F             (         mapl.asm):01541                 BEQ     SER1                              ;LOOK FOR CHARACTER STRING
2A49                  (         mapl.asm):01542         SER2
2A49 313F             (         mapl.asm):01543                 LEAY    -1,Y                              ;BACKUP
2A4B 2736             (         mapl.asm):01544                 BEQ     SER7                              ;GO FOR IT
2A4D ECC3             (         mapl.asm):01545                 LDD     ,--U                              ;GET VALUE FROM SOURCE
2A4F 10A383           (         mapl.asm):01546                 CMPD    ,--X                              ;MATCH?
2A52 2704             (         mapl.asm):01547                 BEQ     SER3                              ;OK
2A54 AEE4             (         mapl.asm):01548                 LDX     ,S                                ;RESTORE POINTER
2A56 20F1             (         mapl.asm):01549                 BRA     SER2
2A58                  (         mapl.asm):01550         SER3
2A58 BC3C84           (         mapl.asm):01551                 CMPX    TEMP                              ;HAVE WE REACHED END?
2A5B 26EC             (         mapl.asm):01552                 BNE     SER2                              ;NO, WE ARE STILL HERE
2A5D                  (         mapl.asm):01553         SER5
2A5D 1F20             (         mapl.asm):01554                 TFR     Y,D                               ;GET VALUE
2A5F BE3C84           (         mapl.asm):01555                 LDX     TEMP                              ;POINT TO DATA SPACE
2A62 E31E             (         mapl.asm):01556                 ADDD    -2,X                              ;BACKUP TO FIRST CHARACTER OF SUBSTRING
2A64 3406             (         mapl.asm):01557                 PSHS    A,B                               ;SAVE
2A66 FC3C8A           (         mapl.asm):01558                 LDD     TEMP2                             ;GET LENGTH
2A69 A3E1             (         mapl.asm):01559                 SUBD    ,S++                              ;AND CALCULATE FINAL VALUE
2A6B C30001           (         mapl.asm):01560                 ADDD    #1                                ;CONVERT TO PROPER OFFSET
2A6E                  (         mapl.asm):01561         SER8
2A6E F34002           (         mapl.asm):01562                 ADDD    ORIGIN                            ;AND OFFSET FOR ORIGIN VALUE
2A71 3540             (         mapl.asm):01563                 PULS    U                                 ;RESTORE POINTER
2A73 3520             (         mapl.asm):01564                 PULS    Y                                 ;RESTORE Y POINTER
2A75 3550             (         mapl.asm):01565                 PULS    X,U                               ;RESTORE X POINTER
2A77 ED03             (         mapl.asm):01566                 STD     3,X                               ;SAVE VALUE
2A79 CC0001           (         mapl.asm):01567                 LDD     #1                                ;LENGTH/TYPE=1
2A7C E784             (         mapl.asm):01568                 STB     ,X                                ;SET TYPE
2A7E ED01             (         mapl.asm):01569                 STD     1,X                               ;SET LENGTH
2A80 16FBB3           (         mapl.asm):01570                 LBRA    NXTOPR                            ;GET NEXT OPERAND
2A83                  (         mapl.asm):01571         SER7
2A83 FC3C8A           (         mapl.asm):01572                 LDD     TEMP2                             ;GET OPERAND LENGTH
2A86 20E6             (         mapl.asm):01573                 BRA     SER8
2A88                  (         mapl.asm):01574         SER1
2A88 313F             (         mapl.asm):01575                 LEAY    -1,Y                              ;BACKUP
2A8A 27F7             (         mapl.asm):01576                 BEQ     SER7                              ;GO FOR IT
2A8C A6C2             (         mapl.asm):01577                 LDA     ,-U                               ;GET VALUE FROM SOURCE
2A8E A182             (         mapl.asm):01578                 CMPA    ,-X                               ;MATCH?
2A90 2704             (         mapl.asm):01579                 BEQ     SER6                              ;OK
2A92 AEE4             (         mapl.asm):01580                 LDX     ,S                                ;RESTORE POINTER
2A94 20F2             (         mapl.asm):01581                 BRA     SER1
2A96                  (         mapl.asm):01582         SER6
2A96 BC3C84           (         mapl.asm):01583                 CMPX    TEMP                              ;HAVE WE REACHED END?
2A99 26ED             (         mapl.asm):01584                 BNE     SER1                              ;NO, WE ARE STILL HERE
2A9B 20C0             (         mapl.asm):01585                 BRA     SER5                              ;GO HOME
                      (         mapl.asm):01586         ;* DROP ELEMENTS FROM START OF VECTOR
2A9D                  (         mapl.asm):01587         ADROP
2A9D 8164             (         mapl.asm):01588                 CMPA    #'d'                              ;DROP?
2A9F 2628             (         mapl.asm):01589                 BNE     TAKE                              ;NO, TRY NEXT
2AA1 3450             (         mapl.asm):01590                 PSHS    X,U                               ;SAVE REGISTERS
2AA3 17047C           (         mapl.asm):01591                 LBSR    GETPRM                            ;GET FORWARD PARAMETER
2AA6 EEE4             (         mapl.asm):01592                 LDU     ,S                                ;RESTORE REGISTERS
2AA8 A680             (         mapl.asm):01593                 LDA     ,X+                               ;GET TYPE
2AAA 1027085E         (         mapl.asm):01594                 LBEQ    CDOM                              ;INDICATE DOMAIN ERROR
2AAE EC81             (         mapl.asm):01595                 LDD     ,X++                              ;GET LENGTH
2AB0 10830001         (         mapl.asm):01596                 CMPD    #1                                ;INSURE LENGTH OF ONE
2AB4 1026084D         (         mapl.asm):01597                 LBNE    CLEN                              ;INDICATE BAD LENGTH
2AB8 3341             (         mapl.asm):01598                 LEAU    1,U                               ;SKIP TYPE
2ABA ECC4             (         mapl.asm):01599                 LDD     ,U                                ;GET LENGTH
2ABC A384             (         mapl.asm):01600                 SUBD    ,X                                ;PERFORM DROP
2ABE 2402             (         mapl.asm):01601                 BCC     DRP1                              ;ALL IS OK
2AC0 4F               (         mapl.asm):01602                 CLRA
2AC1 5F               (         mapl.asm):01603                 CLRB                                      ;     SET LENGTH TO ZERO
2AC2                  (         mapl.asm):01604         DRP1
2AC2 EDC4             (         mapl.asm):01605                 STD     ,U                                ;SET NEW LENGTH,
2AC4 3550             (         mapl.asm):01606                 PULS    X,U                               ;RESTORE REGISTERS
2AC6 16FB6D           (         mapl.asm):01607                 LBRA    NXTOPR                            ;GET NEXT OPERATOR
                      (         mapl.asm):01608         ;* TAKE A NUMBER OF ELEMENTS FROM THE START OF A STRUCTURE
2AC9                  (         mapl.asm):01609         TAKE
2AC9 8174             (         mapl.asm):01610                 CMPA    #'t'                              ;TAKE?
2ACB 267D             (         mapl.asm):01611                 BNE     MEMBER                            ;NO, TRY SOMETING ELSE
2ACD 3450             (         mapl.asm):01612                 PSHS    X,U                               ;SAVE REGISTERS
2ACF 170450           (         mapl.asm):01613                 LBSR    GETPRM                            ;GET PARAMETER
2AD2 3540             (         mapl.asm):01614                 PULS    U                                 ;GET POINTER TO OLD
2AD4 A680             (         mapl.asm):01615                 LDA     ,X+                               ;GET TYPE OF NEW
2AD6 10270832         (         mapl.asm):01616                 LBEQ    CDOM                              ;INDICATE INVALID
2ADA EC81             (         mapl.asm):01617                 LDD     ,X++                              ;GET LENGTH?
2ADC 10830001         (         mapl.asm):01618                 CMPD    #1                                ;IS IT ONE?
2AE0 10260821         (         mapl.asm):01619                 LBNE    CLEN                              ;INDICATE LENGTH ERROR
2AE4 3420             (         mapl.asm):01620                 PSHS    Y                                 ;SAVE TEXT POINTER
2AE6 10AE81           (         mapl.asm):01621                 LDY     ,X++                              ;GET REQUESTED LENGTH
2AE9 1F31             (         mapl.asm):01622                 TFR     U,X                               ;COPY TO X
2AEB 3343             (         mapl.asm):01623                 LEAU    3,U                               ;ADVANCE TO DATA SPACE
2AED FF3C84           (         mapl.asm):01624                 STU     TEMP                              ;SAVE
2AF0 FE4000           (         mapl.asm):01625                 LDU     FREE                              ;GET POINTER TO FREE SPACE
2AF3 10AF41           (         mapl.asm):01626                 STY     1,U                               ;SAVE LENGTH
2AF6 A684             (         mapl.asm):01627                 LDA     ,X                                ;GET TYPE OF OLD
2AF8 A7C4             (         mapl.asm):01628                 STA     ,U                                ;AND SAVE
2AFA 3402             (         mapl.asm):01629                 PSHS    A                                 ;SAVE ON STACK
2AFC 170814           (         mapl.asm):01630                 LBSR    CALLEN                            ;CALCULATE LENGTH
2AFF 308B             (         mapl.asm):01631                 LEAX    D,X                               ;SKIP TO END
2B01 1E13             (         mapl.asm):01632                 EXG     X,U                               ;SWAP
2B03 17080D           (         mapl.asm):01633                 LBSR    CALLEN                            ;LENGTH OF NEW
2B06 308B             (         mapl.asm):01634                 LEAX    D,X                               ;SKIP TO END
2B08 3121             (         mapl.asm):01635                 LEAY    1,Y                               ;ADVANCE
2B0A 6DE0             (         mapl.asm):01636                 TST     ,S+                               ;CHECK TYPE
2B0C 2722             (         mapl.asm):01637                 BEQ     TAK4                              ;TAKEING A CHARACTER
2B0E                  (         mapl.asm):01638         TAK1
2B0E 11B33C84         (         mapl.asm):01639                 CMPU    TEMP
2B12 230A             (         mapl.asm):01640                 BLS     TAK12
2B14 313F             (         mapl.asm):01641                 LEAY    -1,Y                              ;BACKUP
2B16 2710             (         mapl.asm):01642                 BEQ     TAK2                              ;END, QUIT
2B18 ECC3             (         mapl.asm):01643                 LDD     ,--U                              ;GET FROM OLD
2B1A ED83             (         mapl.asm):01644                 STD     ,--X                              ;SAVE IN NEW
2B1C 20F0             (         mapl.asm):01645                 BRA     TAK1
2B1E                  (         mapl.asm):01646         TAK12
2B1E 4F               (         mapl.asm):01647                 CLRA
2B1F 5F               (         mapl.asm):01648                 CLRB                                      ;     START WITH ZERO
2B20                  (         mapl.asm):01649         TAK3
2B20 313F             (         mapl.asm):01650                 LEAY    -1,Y                              ;BACKUP
2B22 2704             (         mapl.asm):01651                 BEQ     TAK2                              ;EXIT IF END
2B24 ED83             (         mapl.asm):01652                 STD     ,--X                              ;RESAVE
2B26 20F8             (         mapl.asm):01653                 BRA     TAK3                              ;GO AGAIN
2B28                  (         mapl.asm):01654         TAK2
2B28 3560             (         mapl.asm):01655                 PULS    Y,U                               ;RESTORE TEXT POINTER
2B2A BE4000           (         mapl.asm):01656                 LDX     FREE                              ;POINT TO NEW VALUE
2B2D 16FB06           (         mapl.asm):01657                 LBRA    NXTOPR                            ;GO AGAIN
2B30                  (         mapl.asm):01658         TAK4
2B30 11B33C84         (         mapl.asm):01659                 CMPU    TEMP
2B34 230A             (         mapl.asm):01660                 BLS     TAK41
2B36 313F             (         mapl.asm):01661                 LEAY    -1,Y                              ;BACKUP
2B38 27EE             (         mapl.asm):01662                 BEQ     TAK2                              ;END, QUIT
2B3A A6C2             (         mapl.asm):01663                 LDA     ,-U                               ;GET FROM OLD
2B3C A782             (         mapl.asm):01664                 STA     ,-X                               ;SAVE IN NEW
2B3E 20F0             (         mapl.asm):01665                 BRA     TAK4                              ;NO, IT'S OK
2B40                  (         mapl.asm):01666         TAK41
2B40 8620             (         mapl.asm):01667                 LDA     #' '                              ;GET SPACE
2B42                  (         mapl.asm):01668         TAK5
2B42 313F             (         mapl.asm):01669                 LEAY    -1,Y                              ;BACKUP
2B44 27E2             (         mapl.asm):01670                 BEQ     TAK2                              ;EXIT IF END
2B46 A782             (         mapl.asm):01671                 STA     ,-X                               ;RESAVE
2B48 20F8             (         mapl.asm):01672                 BRA     TAK5                              ;GO AGAIN
                      (         mapl.asm):01673         ;* MEMBER, DETERMINE IF EACH ELEMENT IS A MEMBER OF THE OTHER SET
2B4A                  (         mapl.asm):01674         MEMBER
2B4A 8175             (         mapl.asm):01675                 CMPA    #'u'                              ;MEMBER OPERATOR?
2B4C 267B             (         mapl.asm):01676                 BNE     XLATE                             ;NO, TRY TRANSLATE
2B4E 3450             (         mapl.asm):01677                 PSHS    X,U                               ;SAVE REGS
2B50 1703CF           (         mapl.asm):01678                 LBSR    GETPRM                            ;GET PARAMETER
2B53 3540             (         mapl.asm):01679                 PULS    U                                 ;GET REGISTER
2B55 3420             (         mapl.asm):01680                 PSHS    Y                                 ;SAVE REGISTERS
2B57 A6C0             (         mapl.asm):01681                 LDA     ,U+                               ;GET TYPE OF FIRST
2B59 A180             (         mapl.asm):01682                 CMPA    ,X+                               ;SAME AS SECOND?
2B5B 102607AD         (         mapl.asm):01683                 LBNE    CDOM                              ;NO, GET UPSET
2B5F FC4000           (         mapl.asm):01684                 LDD     FREE                              ;GET FREE POINTER
2B62 F34006           (         mapl.asm):01685                 ADDD    BUFSIZ                            ;GET SECOND BUFFER
2B65 1F02             (         mapl.asm):01686                 TFR     D,Y                               ;POINT U AT IT
2B67 3406             (         mapl.asm):01687                 PSHS    A,B                               ;SAVE IT
2B69 8601             (         mapl.asm):01688                 LDA     #1                                ;INTEGER
2B6B A7A0             (         mapl.asm):01689                 STA     ,Y+                               ;SET TYPE
2B6D EC81             (         mapl.asm):01690                 LDD     ,X++                              ;GET LENGTH OF RIGHT OPERATOR
2B6F EDA1             (         mapl.asm):01691                 STD     ,Y++                              ;SAVE IT
2B71 2751             (         mapl.asm):01692                 BEQ     MEMEND                            ;SPECIAL CASE, QUIT
2B73 6D1D             (         mapl.asm):01693                 TST     -3,X                              ;IS IT CHARACTER?
2B75 2728             (         mapl.asm):01694                 BEQ     MEMCHR                            ;IF SO, DO IT FOR CHARACTERS
2B77                  (         mapl.asm):01695         MEMLP
2B77 3466             (         mapl.asm):01696                 PSHS    A,B,Y,U                           ;SAVE REGS
2B79 EC81             (         mapl.asm):01697                 LDD     ,X++                              ;GET ELEMENT WE ARE TESTING
2B7B 10AEC1           (         mapl.asm):01698                 LDY     ,U++                              ;GET LENGTH OF LEFT OPERAND
2B7E 2709             (         mapl.asm):01699                 BEQ     MEML0                             ;DOES NOT EXIST
2B80                  (         mapl.asm):01700         MEMLX
2B80 10A3C1           (         mapl.asm):01701                 CMPD    ,U++                              ;DUZ IT MATCH
2B83 2707             (         mapl.asm):01702                 BEQ     MEML1                             ;OK
2B85 313F             (         mapl.asm):01703                 LEAY    -1,Y                              ;REDUCE COUNT
2B87 26F7             (         mapl.asm):01704                 BNE     MEMLX                             ;CONTINUE
2B89                  (         mapl.asm):01705         MEML0
2B89 5F               (         mapl.asm):01706                 CLRB
2B8A 2002             (         mapl.asm):01707                 BRA     MEML2                             ;CONTINUE
2B8C                  (         mapl.asm):01708         MEML1
2B8C C601             (         mapl.asm):01709                 LDB     #1                                ;INDICATE FOUND
2B8E                  (         mapl.asm):01710         MEML2
2B8E 4F               (         mapl.asm):01711                 CLRA                                      ;     ZERO HIGH BYTE
2B8F 10AE62           (         mapl.asm):01712                 LDY     2,S                               ;GET POINTER
2B92 EDA4             (         mapl.asm):01713                 STD     ,Y                                ;SAVE
2B94 3566             (         mapl.asm):01714                 PULS    A,B,Y,U                           ;RESTORE REGS
2B96 3122             (         mapl.asm):01715                 LEAY    2,Y                               ;ADVANCE
2B98 830001           (         mapl.asm):01716                 SUBD    #1                                ;MORE ELEMENTS
2B9B 26DA             (         mapl.asm):01717                 BNE     MEMLP                             ;CONTINUE
2B9D 2025             (         mapl.asm):01718                 BRA     MEMEND
2B9F                  (         mapl.asm):01719         MEMCHR
2B9F 3466             (         mapl.asm):01720                 PSHS    A,B,Y,U                           ;SAVE REGS
2BA1 A680             (         mapl.asm):01721                 LDA     ,X+                               ;GET ELEMENT WE ARE TESTING
2BA3 10AEC1           (         mapl.asm):01722                 LDY     ,U++                              ;GET LENGTH OF LEFT OPERAND
2BA6 2708             (         mapl.asm):01723                 BEQ     MEMC0                             ;DOES NOT EXIST
2BA8                  (         mapl.asm):01724         MEMCX
2BA8 A1C0             (         mapl.asm):01725                 CMPA    ,U+                               ;DOS IT MATCH
2BAA 2707             (         mapl.asm):01726                 BEQ     MEMC1                             ;OK
2BAC 313F             (         mapl.asm):01727                 LEAY    -1,Y                              ;REDUCE COUNT
2BAE 26F8             (         mapl.asm):01728                 BNE     MEMCX                             ;CONTINUE
2BB0                  (         mapl.asm):01729         MEMC0
2BB0 5F               (         mapl.asm):01730                 CLRB
2BB1 2002             (         mapl.asm):01731                 BRA     MEMC2                             ;CONTINUE
2BB3                  (         mapl.asm):01732         MEMC1
2BB3 C601             (         mapl.asm):01733                 LDB     #1                                ;INDICATE FOUND
2BB5                  (         mapl.asm):01734         MEMC2
2BB5 4F               (         mapl.asm):01735                 CLRA                                      ;     ZERO HIGH BYTE
2BB6 10AE62           (         mapl.asm):01736                 LDY     2,S                               ;GET POINTER
2BB9 EDA4             (         mapl.asm):01737                 STD     ,Y                                ;SAVE
2BBB 3566             (         mapl.asm):01738                 PULS    A,B,Y,U                           ;RESTORE REGS
2BBD 3122             (         mapl.asm):01739                 LEAY    2,Y                               ;ADVANCE
2BBF 830001           (         mapl.asm):01740                 SUBD    #1                                ;MORE ELEMENTS
2BC2 26DB             (         mapl.asm):01741                 BNE     MEMCHR                            ;CONTINUE
2BC4                  (         mapl.asm):01742         MEMEND
2BC4 3570             (         mapl.asm):01743                 PULS    X,Y,U                             ;RESTORE REGS
2BC6 16FA6D           (         mapl.asm):01744                 LBRA    NXTOPR                            ;CONTINUE
                      (         mapl.asm):01745         ;* TRANSLATE TABLE LOOKUP
2BC9                  (         mapl.asm):01746         XLATE
2BC9 816E             (         mapl.asm):01747                 CMPA    #'n'                              ;TRANSLATE OPERATOR?
2BCB 10260089         (         mapl.asm):01748                 LBNE    OPSYS                             ;NO, TRY OPSYS
2BCF 3450             (         mapl.asm):01749                 PSHS    X,U                               ;SAVE REGS
2BD1 17034E           (         mapl.asm):01750                 LBSR    GETPRM                            ;GET PARAMETER
2BD4 3540             (         mapl.asm):01751                 PULS    U                                 ;GET REGISTER
2BD6 3420             (         mapl.asm):01752                 PSHS    Y                                 ;SAVE REGISTERS
2BD8 A6C0             (         mapl.asm):01753                 LDA     ,U+                               ;GET TYPE OF FIRST
2BDA A180             (         mapl.asm):01754                 CMPA    ,X+                               ;SAME AS SECOND?
2BDC 1026072C         (         mapl.asm):01755                 LBNE    CDOM                              ;NO, GET UPSET
2BE0 FC4000           (         mapl.asm):01756                 LDD     FREE                              ;GET FREE POINTER
2BE3 F34006           (         mapl.asm):01757                 ADDD    BUFSIZ                            ;GET SECOND BUFFER
2BE6 1F02             (         mapl.asm):01758                 TFR     D,Y                               ;POINT U AT IT
2BE8 3406             (         mapl.asm):01759                 PSHS    A,B                               ;SAVE IT
2BEA 8601             (         mapl.asm):01760                 LDA     #1                                ;INTEGER
2BEC A7A0             (         mapl.asm):01761                 STA     ,Y+                               ;SET TYPE
2BEE ECC1             (         mapl.asm):01762                 LDD     ,U++                              ;GET LENGTH OF RIGHT OPERATOR
2BF0 EDA1             (         mapl.asm):01763                 STD     ,Y++                              ;SAVE IT
2BF2 275F             (         mapl.asm):01764                 BEQ     XLAEND                            ;SPECIAL CASE, QUIT
2BF4 6D1F             (         mapl.asm):01765                 TST     -1,X                              ;IS IT CHARACTER?
2BF6 272F             (         mapl.asm):01766                 BEQ     XLACHR                            ;IF SO, DO IT FOR CHARACTERS
2BF8                  (         mapl.asm):01767         XLALP
2BF8 3436             (         mapl.asm):01768                 PSHS    A,B,X,Y                           ;SAVE REGS
2BFA ECC1             (         mapl.asm):01769                 LDD     ,U++                              ;GET ELEMENT WE ARE TESTING
2BFC 10AE81           (         mapl.asm):01770                 LDY     ,X++                              ;GET LENGTH OF LEFT OPERAND
2BFF 2709             (         mapl.asm):01771                 BEQ     XLAL0                             ;DOES NOT EXIST
2C01                  (         mapl.asm):01772         XLALX
2C01 10A381           (         mapl.asm):01773                 CMPD    ,X++                              ;DUZ IT MATCH
2C04 270A             (         mapl.asm):01774                 BEQ     XLAL1                             ;OK
2C06 313F             (         mapl.asm):01775                 LEAY    -1,Y                              ;REDUCE COUNT
2C08 26F7             (         mapl.asm):01776                 BNE     XLALX                             ;CONTINUE
2C0A                  (         mapl.asm):01777         XLAL0
2C0A 10AEF802         (         mapl.asm):01778                 LDY     [2,S]                             ;POINT TO END
2C0E 3121             (         mapl.asm):01779                 LEAY    1,Y                               ;ADVANCE PAST END
2C10                  (         mapl.asm):01780         XLAL1
2C10 313F             (         mapl.asm):01781                 LEAY    -1,Y                              ;BACKUP TO ORIGIN ZERO
2C12 1F20             (         mapl.asm):01782                 TFR     Y,D                               ;COPY
2C14 F34002           (         mapl.asm):01783                 ADDD    ORIGIN                            ;OFFSET
2C17 10AE64           (         mapl.asm):01784                 LDY     4,S                               ;GET POINTER
2C1A EDA4             (         mapl.asm):01785                 STD     ,Y                                ;SAVE
2C1C 3536             (         mapl.asm):01786                 PULS    A,B,X,Y                           ;RESTORE REGS
2C1E 3122             (         mapl.asm):01787                 LEAY    2,Y                               ;ADVANCE
2C20 830001           (         mapl.asm):01788                 SUBD    #1                                ;MORE ELEMENTS
2C23 26D3             (         mapl.asm):01789                 BNE     XLALP                             ;CONTINUE
2C25 202C             (         mapl.asm):01790                 BRA     XLAEND
2C27                  (         mapl.asm):01791         XLACHR
2C27 3436             (         mapl.asm):01792                 PSHS    A,B,X,Y                           ;SAVE REGS
2C29 A6C0             (         mapl.asm):01793                 LDA     ,U+                               ;GET ELEMENT WE ARE TESTING
2C2B 10AE81           (         mapl.asm):01794                 LDY     ,X++                              ;GET LENGTH OF LEFT OPERAND
2C2E 2708             (         mapl.asm):01795                 BEQ     XLAC0                             ;DOES NOT EXIST
2C30                  (         mapl.asm):01796         XLACX
2C30 A180             (         mapl.asm):01797                 CMPA    ,X+                               ;DOS IT MATCH
2C32 270A             (         mapl.asm):01798                 BEQ     XLAC1                             ;OK
2C34 313F             (         mapl.asm):01799                 LEAY    -1,Y                              ;REDUCE COUNT
2C36 26F8             (         mapl.asm):01800                 BNE     XLACX                             ;CONTINUE
2C38                  (         mapl.asm):01801         XLAC0
2C38 10AEF802         (         mapl.asm):01802                 LDY     [2,S]                             ;GET HIGHEST VALIE
2C3C 3121             (         mapl.asm):01803                 LEAY    1,Y                               ;BACKUP TO ORIGIN ZERO
2C3E                  (         mapl.asm):01804         XLAC1
2C3E 313F             (         mapl.asm):01805                 LEAY    -1,Y                              ;ADVANCE
2C40 1F20             (         mapl.asm):01806                 TFR     Y,D                               ;COPY TO D
2C42 F34002           (         mapl.asm):01807                 ADDD    ORIGIN                            ;CONVERT
2C45 10AE64           (         mapl.asm):01808                 LDY     4,S                               ;GET POINTER
2C48 EDA4             (         mapl.asm):01809                 STD     ,Y                                ;SAVE
2C4A 3536             (         mapl.asm):01810                 PULS    A,B,X,Y                           ;RESTORE REGS
2C4C 3122             (         mapl.asm):01811                 LEAY    2,Y                               ;ADVANCE
2C4E 830001           (         mapl.asm):01812                 SUBD    #1                                ;MORE ELEMENTS
2C51 26D4             (         mapl.asm):01813                 BNE     XLACHR                            ;CONTINUE
2C53                  (         mapl.asm):01814         XLAEND
2C53 3570             (         mapl.asm):01815                 PULS    X,Y,U                             ;RESTORE REGS
2C55 16F9DE           (         mapl.asm):01816                 LBRA    NXTOPR                            ;CONTINUE
                      (         mapl.asm):01817         ;* OPERATING SYSTEM INTERFACE
2C58                  (         mapl.asm):01818         OPSYS
2C58 816F             (         mapl.asm):01819                 CMPA    #'o'                              ;OPERATING SYSTEM INTERFACE?
2C5A 2613             (         mapl.asm):01820                 BNE     EQUTST                            ;NO, TRY EQUALITY TEST
2C5C 3470             (         mapl.asm):01821                 PSHS    X,Y,U                             ;SAVE OPERAND POINTER
2C5E 1702C1           (         mapl.asm):01822                 LBSR    GETPRM                            ;GET PARAMETER
2C61 10AF62           (         mapl.asm):01823                 STY     2,S                               ;RESET LINE PTR
2C64 10AEE4           (         mapl.asm):01824                 LDY     ,S                                ;'Y' POINTS TO FIRST
2C67 170DEF           (         mapl.asm):01825                 LBSR    OSFUNC                            ;EXECUTE OS FUNCTION
2C6A 3570             (         mapl.asm):01826                 PULS    X,Y,U                             ;RESTORE ALL REGS
2C6C 16F9C7           (         mapl.asm):01827                 LBRA    NXTOPR                            ;AND GET NEXT OPERATOR
                      (         mapl.asm):01828         ;* EQUALS AND ASSOCIATED FUNCTIONS
2C6F                  (         mapl.asm):01829         EQUTST
2C6F 813D             (         mapl.asm):01830                 CMPA    #'='                              ;EQUALS?
2C71 102600EB         (         mapl.asm):01831                 LBNE    DYFNS                             ;NO, SKIP IT
2C75 3450             (         mapl.asm):01832                 PSHS    X,U                               ;SAVE U REGISTER
2C77 A6A4             (         mapl.asm):01833                 LDA     ,Y                                ;GET NEXT OPERAND
2C79 313F             (         mapl.asm):01834                 LEAY    -1,Y                              ;BACKUP
2C7B CE2E8D           (         mapl.asm):01835                 LDU     #DYGE                             ;INDICATE GREATER/EQUALS
2C7E 813E             (         mapl.asm):01836                 CMPA    #'>'                              ;TEST FOR GE
2C80 2712             (         mapl.asm):01837                 BEQ     DODYA1                            ;DO IT
2C82 CE2E97           (         mapl.asm):01838                 LDU     #DYLE                             ;TEST FOR LT
2C85 813C             (         mapl.asm):01839                 CMPA    #'<'                              ;IS THIS IT?
2C87 270B             (         mapl.asm):01840                 BEQ     DODYA1                            ;IF SO, DO IT
2C89 CE2EA4           (         mapl.asm):01841                 LDU     #DYEQ                             ;POINT AT HANDLER
2C8C 813D             (         mapl.asm):01842                 CMPA    #'='                              ;EQUALS
2C8E 2607             (         mapl.asm):01843                 BNE     EQU1                              ;NOT IT
2C90 6D84             (         mapl.asm):01844                 TST     ,X                                ;IS IT NUMERIC?
2C92 270E             (         mapl.asm):01845                 BEQ     CEQU                              ;IT'S CHARACTER
2C94                  (         mapl.asm):01846         DODYA1
2C94 1600DE           (         mapl.asm):01847                 LBRA    DODYA                             ;GO FOR IT
                      (         mapl.asm):01848         ;* CHARACTER EQUALITY TEST
2C97                  (         mapl.asm):01849         EQU1
2C97 CE2EAD           (         mapl.asm):01850                 LDU     #DYNE                             ;POINT AT IT
2C9A 812D             (         mapl.asm):01851                 CMPA    #'-'                              ;IS THIS IT?
2C9C 2679             (         mapl.asm):01852                 BNE     EQU9                              ;MUST BE ASSIGNMENT
2C9E 6D84             (         mapl.asm):01853                 TST     ,X                                ;IS THIS IT?
2CA0 26F2             (         mapl.asm):01854                 BNE     DODYA1                            ;GO FOR IT
2CA2                  (         mapl.asm):01855         CEQU
2CA2 CE2D4B           (         mapl.asm):01856                 LDU     #DCEQU                            ;POINT TO EQUALS
2CA5 813D             (         mapl.asm):01857                 CMPA    #'='                              ;IS IT EQUALS
2CA7 2703             (         mapl.asm):01858                 BEQ     CEQ2                              ;IT'S OK
2CA9 CE2D56           (         mapl.asm):01859                 LDU     #DCNEQ                            ;POINT TO NOT EQUALS
2CAC                  (         mapl.asm):01860         CEQ2
2CAC FF3C8A           (         mapl.asm):01861                 STU     TEMP2                             ;SAVE POINTER
2CAF 170270           (         mapl.asm):01862                 LBSR    GETPRM                            ;GET SECOND OPERAND
2CB2 6D80             (         mapl.asm):01863                 TST     ,X+                               ;TEST FOR TYPE
2CB4 10260654         (         mapl.asm):01864                 LBNE    CDOM                              ;INVALID
2CB8 EEE4             (         mapl.asm):01865                 LDU     ,S                                ;POINT TO OLD PARM
2CBA 3341             (         mapl.asm):01866                 LEAU    1,U                               ;SKIP TYPE
2CBC EC81             (         mapl.asm):01867                 LDD     ,X++                              ;GET LENGTH
2CBE 10A3C1           (         mapl.asm):01868                 CMPD    ,U++                              ;ARE THEY THE SAME?
2CC1 2614             (         mapl.asm):01869                 BNE     CEQU1                             ;NO, TRY SCALAR COMPARISIONS
2CC3 C30001           (         mapl.asm):01870                 ADDD    #1                                ;ADVANCE FOR LATER DEC
2CC6                  (         mapl.asm):01871         CEQ1
2CC6 830001           (         mapl.asm):01872                 SUBD    #1                                ;BACKUP
2CC9 275C             (         mapl.asm):01873                 BEQ     CEQ3                              ;END, GET OUT
2CCB 3402             (         mapl.asm):01874                 PSHS    A                                 ;SAVE REGISTERS
2CCD AD9F3C8A         (         mapl.asm):01875                 JSR     [TEMP2]                           ;PERFORM IT
2CD1 3001             (         mapl.asm):01876                 LEAX    1,X                               ;NEXT
2CD3 3502             (         mapl.asm):01877                 PULS    A                                 ;GET THEM BACK
2CD5 20EF             (         mapl.asm):01878                 BRA     CEQ1                              ;AND DO IT
2CD7                  (         mapl.asm):01879         CEQU1
2CD7 10830001         (         mapl.asm):01880                 CMPD    #1                                ;IS THIS A SCALAR?
2CDB 2614             (         mapl.asm):01881                 BNE     CEQU2                             ;NO, TRY NEXT
2CDD EC5E             (         mapl.asm):01882                 LDD     -2,U                              ;GET LENGTH BACK
2CDF C30001           (         mapl.asm):01883                 ADDD    #1                                ;ADVANCE FOR LATER DEC
2CE2                  (         mapl.asm):01884         CEQ4
2CE2 830001           (         mapl.asm):01885                 SUBD    #1                                ;DEC
2CE5 2740             (         mapl.asm):01886                 BEQ     CEQ3                              ;GET OUT
2CE7 3402             (         mapl.asm):01887                 PSHS    A                                 ;SAVE IT
2CE9 AD9F3C8A         (         mapl.asm):01888                 JSR     [TEMP2]                           ;DO IT
2CED 3502             (         mapl.asm):01889                 PULS    A                                 ;RESTORE
2CEF 20F1             (         mapl.asm):01890                 BRA     CEQ4                              ;GO AGAIN
2CF1                  (         mapl.asm):01891         CEQU2
2CF1 EC5E             (         mapl.asm):01892                 LDD     -2,U                              ;GET IT
2CF3 10830001         (         mapl.asm):01893                 CMPD    #1                                ;IS THIS IT?
2CF7 1026060A         (         mapl.asm):01894                 LBNE    CLEN                              ;GET REAL
2CFB EC1E             (         mapl.asm):01895                 LDD     -2,X                              ;GET LENGTH BACK
2CFD ED5E             (         mapl.asm):01896                 STD     -2,U                              ;SET OUTPUT LENGTH
2CFF C30001           (         mapl.asm):01897                 ADDD    #1                                ;ADVANCE
2D02                  (         mapl.asm):01898         CEQ5
2D02 830001           (         mapl.asm):01899                 SUBD    #1                                ;DECREMENT COUNTER
2D05 2720             (         mapl.asm):01900                 BEQ     CEQ3                              ;QUIT IF DONE
2D07 3402             (         mapl.asm):01901                 PSHS    A                                 ;SAVE REGSITER
2D09 A6C4             (         mapl.asm):01902                 LDA     ,U                                ;GET VALUE
2D0B A741             (         mapl.asm):01903                 STA     1,U                               ;AND SAVE ONE UP
2D0D AD9F3C8A         (         mapl.asm):01904                 JSR     [TEMP2]                           ;DO IT
2D11 3001             (         mapl.asm):01905                 LEAX    1,X                               ;NEXT
2D13 3502             (         mapl.asm):01906                 PULS    A                                 ;RESTORE
2D15 20EB             (         mapl.asm):01907                 BRA     CEQ5                              ;DO IT AGAIN
                      (         mapl.asm):01908         ;* ASSIGNMENT
2D17                  (         mapl.asm):01909         EQU9
2D17 3550             (         mapl.asm):01910                 PULS    X,U                               ;RESTORE REGISTERS
2D19 3121             (         mapl.asm):01911                 LEAY    1,Y                               ;ADVANCE
2D1B 17F77F           (         mapl.asm):01912                 LBSR    SKBKP                             ;SKIP BACK
2D1E 170473           (         mapl.asm):01913                 LBSR    ASSIGN                            ;PERFORM ASSIGNMENT
2D21 7A3CA4           (         mapl.asm):01914                 DEC     ASSFLG                            ;SET ASSIGNMENT FLAG
2D24 16F90F           (         mapl.asm):01915                 LBRA    NXTOPR                            ;GET NEXT OPERATOR
                      (         mapl.asm):01916         ;* SAVE OUTPUT VECTOR AND CONVERT TO INTEGER (WORDS)
2D27                  (         mapl.asm):01917         CEQ3
2D27 AEE4             (         mapl.asm):01918                 LDX     ,S                                ;GET POINTER TO OUTPUT
2D29 3420             (         mapl.asm):01919                 PSHS    Y                                 ;SAVE POINTER
2D2B 10AE01           (         mapl.asm):01920                 LDY     1,X                               ;GET LENGTH
2D2E 3121             (         mapl.asm):01921                 LEAY    1,Y                               ;ADVANCE FOR LATER DEC
2D30 8601             (         mapl.asm):01922                 LDA     #1                                ;GET TYPE
2D32 A784             (         mapl.asm):01923                 STA     ,X                                ;SAVE TYPE
2D34 1705DC           (         mapl.asm):01924                 LBSR    CALLEN                            ;GET LENGTH
2D37 308B             (         mapl.asm):01925                 LEAX    D,X                               ;OFFSET
2D39 4F               (         mapl.asm):01926                 CLRA                                      ;     CLEAR HIGH ORDER BYTE
2D3A                  (         mapl.asm):01927         CEQ6
2D3A 313F             (         mapl.asm):01928                 LEAY    -1,Y                              ;BACKUP
2D3C 2706             (         mapl.asm):01929                 BEQ     CEQ7                              ;IF END, GO HOME
2D3E E6C2             (         mapl.asm):01930                 LDB     ,-U                               ;GET CHAR FROM OUTPUT
2D40 ED83             (         mapl.asm):01931                 STD     ,--X                              ;SAVE IN OUTPUT
2D42 20F6             (         mapl.asm):01932                 BRA     CEQ6                              ;AND GO AGAIN
2D44                  (         mapl.asm):01933         CEQ7
2D44 3520             (         mapl.asm):01934                 PULS    Y                                 ;RESTORE Y (AGAIN)
2D46 3550             (         mapl.asm):01935                 PULS    X,U                               ;RESTORE REGSITERS
2D48 16F8EB           (         mapl.asm):01936                 LBRA    NXTOPR
                      (         mapl.asm):01937         ;* CHARACTER EQUALS LOGIC
2D4B                  (         mapl.asm):01938         DCEQU
2D4B A684             (         mapl.asm):01939                 LDA     ,X                                ;GET CHAR
2D4D A1C4             (         mapl.asm):01940                 CMPA    ,U                                ;TEST FOR OK
2D4F 260B             (         mapl.asm):01941                 BNE     DCR0                              ;FALSE
2D51                  (         mapl.asm):01942         DCR1
2D51 8601             (         mapl.asm):01943                 LDA     #1                                ;GET ONE
2D53 A7C0             (         mapl.asm):01944                 STA     ,U+
2D55 39               (         mapl.asm):01945                 RTS
                      (         mapl.asm):01946         ;* CHARACTER NOT EQUALS LOGIC
2D56                  (         mapl.asm):01947         DCNEQ
2D56 A684             (         mapl.asm):01948                 LDA     ,X                                ;GET CHAR
2D58 A1C4             (         mapl.asm):01949                 CMPA    ,U                                ;TEST FOR NOT EQUAL
2D5A 26F5             (         mapl.asm):01950                 BNE     DCR1                              ;TRUE
2D5C                  (         mapl.asm):01951         DCR0
2D5C 4F               (         mapl.asm):01952                 CLRA                                      ;     FALSE
2D5D A7C0             (         mapl.asm):01953                 STA     ,U+
2D5F 39               (         mapl.asm):01954                 RTS
                      (         mapl.asm):01955         ;* STANDARD DYADIC FUNCTONS
2D60                  (         mapl.asm):01956         DYFNS
2D60 3450             (         mapl.asm):01957                 PSHS    X,U                               ;SAVE U REG
2D62 CE2DEF           (         mapl.asm):01958                 LDU     #DOTAB                            ;POINT TO TABLE
2D65                  (         mapl.asm):01959         DOD1
2D65 6DC4             (         mapl.asm):01960                 TST     ,U                                ;CHECK FOR END OF TABLE
2D67 1027014B         (         mapl.asm):01961                 LBEQ    FUNVAL                            ;INVALID, QUIT
2D6B A1C0             (         mapl.asm):01962                 CMPA    ,U+                               ;IS THIS IT?
2D6D 2704             (         mapl.asm):01963                 BEQ     DOD2                              ;YES, GRAB IT
2D6F 3342             (         mapl.asm):01964                 LEAU    2,U                               ;SKIP TO NEXT
2D71 20F2             (         mapl.asm):01965                 BRA     DOD1                              ;AND KEEP LOOKING
2D73                  (         mapl.asm):01966         DOD2
2D73 EEC4             (         mapl.asm):01967                 LDU     ,U                                ;GET HANDLER ADDRESS
2D75                  (         mapl.asm):01968         DODYA
2D75 1701AA           (         mapl.asm):01969                 LBSR    GETPRM                            ;GET PARAMETER VALUE
2D78 FF3C8A           (         mapl.asm):01970                 STU     TEMP2                             ;SAVE HANDLER ADDRESS
2D7B EEE4             (         mapl.asm):01971                 LDU     ,S                                ;GET OLD OPERAND VALUE
2D7D A680             (         mapl.asm):01972                 LDA     ,X+                               ;GET TYPE
2D7F 10270589         (         mapl.asm):01973                 LBEQ    CDOM                              ;NOT FOR CHARACTER VALUES
2D83 A6C0             (         mapl.asm):01974                 LDA     ,U+                               ;TEST TYPE OF OTHER OPERAND
2D85 10270583         (         mapl.asm):01975                 LBEQ    CDOM                              ;CHARACTER STILL INVALID
2D89 EC81             (         mapl.asm):01976                 LDD     ,X++                              ;GET LENGTH
2D8B 10A3C1           (         mapl.asm):01977                 CMPD    ,U++                              ;SAME AS OTHER?
2D8E 261B             (         mapl.asm):01978                 BNE     TSCALE                            ;NO, TRY SCALAR OPERATION
2D90 C30001           (         mapl.asm):01979                 ADDD    #1                                ;OFFSET FOR ZERO
2D93                  (         mapl.asm):01980         ZX1
2D93 830001           (         mapl.asm):01981                 SUBD    #1                                ;REDUCE COUNT
2D96 270E             (         mapl.asm):01982                 BEQ     ZX2                               ;END, QUIT
2D98 3416             (         mapl.asm):01983                 PSHS    A,B,X                             ;SAVE VALUES
2D9A AD9F3C8A         (         mapl.asm):01984                 JSR     [TEMP2]                           ;PERFORM OPERATION
2D9E 3516             (         mapl.asm):01985                 PULS    A,B,X                             ;RESTORE REGISTERS
2DA0 3002             (         mapl.asm):01986                 LEAX    2,X                               ;ADVANCE IN NEW
2DA2 3342             (         mapl.asm):01987                 LEAU    2,U                               ;ADVANCE IN OLD
2DA4 20ED             (         mapl.asm):01988                 BRA     ZX1                               ;GO AGAIN
2DA6                  (         mapl.asm):01989         ZX2
2DA6 3550             (         mapl.asm):01990                 PULS    X,U                               ;RESTORE REGISTERS
2DA8 16F88B           (         mapl.asm):01991                 LBRA    NXTOPR
2DAB                  (         mapl.asm):01992         TSCALE
2DAB 10830001         (         mapl.asm):01993                 CMPD    #1                                ;TEST FOR SCALER OPERATION
2DAF 2616             (         mapl.asm):01994                 BNE     TSCAL2                            ;NO, TRY OTHER WAY
2DB1 EC5E             (         mapl.asm):01995                 LDD     -2,U                              ;GET LENGTH
2DB3 C30001           (         mapl.asm):01996                 ADDD    #1                                ;ADD FOR LATER DEC
2DB6                  (         mapl.asm):01997         TSL2
2DB6 830001           (         mapl.asm):01998                 SUBD    #1                                ;REDUCE COUNT
2DB9 27EB             (         mapl.asm):01999                 BEQ     ZX2                               ;END, QUIT
2DBB 3416             (         mapl.asm):02000                 PSHS    A,B,X                             ;SAVE REGISTERS
2DBD AD9F3C8A         (         mapl.asm):02001                 JSR     [TEMP2]                           ;PERFORM OPERATION
2DC1 3516             (         mapl.asm):02002                 PULS    A,B,X                             ;RESTORE REGISTERS
2DC3 3342             (         mapl.asm):02003                 LEAU    2,U                               ;ADVANCE POINTER
2DC5 20EF             (         mapl.asm):02004                 BRA     TSL2                              ;AND GO IT AGAIN
2DC7                  (         mapl.asm):02005         TSCAL2
2DC7 EC5E             (         mapl.asm):02006                 LDD     -2,U                              ;GET OTHER LENGTH
2DC9 10830001         (         mapl.asm):02007                 CMPD    #1                                ;TEST FOR LENGTH ONE
2DCD 10260534         (         mapl.asm):02008                 LBNE    CLEN                              ;INVALID LENGTHS
2DD1 EC1E             (         mapl.asm):02009                 LDD     -2,X                              ;GET LENGTH OF NEW OPERAND
2DD3 ED5E             (         mapl.asm):02010                 STD     -2,U                              ;SET LENGTH OR RESULT
2DD5 C30001           (         mapl.asm):02011                 ADDD    #1                                ;ADVANCE FOR LATER DEC
2DD8                  (         mapl.asm):02012         TSC2
2DD8 830001           (         mapl.asm):02013                 SUBD    #1                                ;REDUCE COUNT
2DDB 27C9             (         mapl.asm):02014                 BEQ     ZX2                               ;END, QUIT
2DDD 3416             (         mapl.asm):02015                 PSHS    A,B,X                             ;SAVE REGISTERS
2DDF ECC4             (         mapl.asm):02016                 LDD     ,U                                ;GET VALUE
2DE1 ED42             (         mapl.asm):02017                 STD     2,U                               ;SAVE LATER
2DE3 AD9F3C8A         (         mapl.asm):02018                 JSR     [TEMP2]                           ;PERFORM OPERATION
2DE7 3516             (         mapl.asm):02019                 PULS    A,B,X                             ;RESTORE REGISTERS
2DE9 3002             (         mapl.asm):02020                 LEAX    2,X                               ;ADVANCE IN NEW
2DEB 3342             (         mapl.asm):02021                 LEAU    2,U                               ;ADVANCE IN OLD
2DED 20E9             (         mapl.asm):02022                 BRA     TSC2                              ;AND CONTINUE
                      (         mapl.asm):02023         ;*
                      (         mapl.asm):02024         ;* DYADIC FUNCTION TABLE
                      (         mapl.asm):02025         ;*
2DEF                  (         mapl.asm):02026         DOTAB
2DEF 2B               (         mapl.asm):02027                 FCC     '+'                               ;ADDITION
2DF0 2E14             (         mapl.asm):02028                 FDB     DYADD
2DF2 2D               (         mapl.asm):02029                 FCC     '-'                               ;SUBTRACTON
2DF3 2E1B             (         mapl.asm):02030                 FDB     DYSUB
2DF5 78               (         mapl.asm):02031                 FCC     'x'                               ;MULTIPLICATION
2DF6 2E22             (         mapl.asm):02032                 FDB     DYMUL
2DF8 25               (         mapl.asm):02033                 FCC     '%'                               ;DIVIDE
2DF9 2E2C             (         mapl.asm):02034                 FDB     DYDIV
2DFB 67               (         mapl.asm):02035                 FCC     'g'                               ;GREATEST
2DFC 2E4B             (         mapl.asm):02036                 FDB     DYCEIL
2DFE 6C               (         mapl.asm):02037                 FCC     'l'                               ;LEAST
2DFF 2E57             (         mapl.asm):02038                 FDB     DYFLOR
2E01 26               (         mapl.asm):02039                 FCC     '&'                               ;LOGICAL AND
2E02 2E60             (         mapl.asm):02040                 FDB     DYAND
2E04 21               (         mapl.asm):02041                 FCC     '!'                               ;LOGICAL OR
2E05 2E69             (         mapl.asm):02042                 FDB     DYOR
2E07 6D               (         mapl.asm):02043                 FCC     'm'                               ;MODULUS
2E08 2E3D             (         mapl.asm):02044                 FDB     DYMOD
2E0A 3E               (         mapl.asm):02045                 FCC     '>'                               ;GREATER THAN
2E0B 2E7B             (         mapl.asm):02046                 FDB     DYGT
2E0D 3C               (         mapl.asm):02047                 FCC     '<'                               ;LESS THAN
2E0E 2E84             (         mapl.asm):02048                 FDB     DYLT
2E10 7C               (         mapl.asm):02049                 FCC     '|'                               ;EXCLUSIVE OR
2E11 2E72             (         mapl.asm):02050                 FDB     DYXOR
2E13 00               (         mapl.asm):02051                 FCB     0
                      (         mapl.asm):02052         ;* DYADIC FUNCTION ROUTINES
2E14                  (         mapl.asm):02053         DYADD
2E14 EC84             (         mapl.asm):02054                 LDD     ,X                                ;GET NEW VALUE
2E16 E3C4             (         mapl.asm):02055                 ADDD    ,U                                ;ADD OLD VALUE
2E18 EDC4             (         mapl.asm):02056                 STD     ,U                                ;SAVE BACK
2E1A 39               (         mapl.asm):02057                 RTS
2E1B                  (         mapl.asm):02058         DYSUB
2E1B EC84             (         mapl.asm):02059                 LDD     ,X                                ;GET NEW VALUE
2E1D A3C4             (         mapl.asm):02060                 SUBD    ,U                                ;SUBTRACT OLD VALUE
2E1F EDC4             (         mapl.asm):02061                 STD     ,U                                ;SAVE BACK
2E21 39               (         mapl.asm):02062                 RTS
2E22                  (         mapl.asm):02063         DYMUL
2E22 EC84             (         mapl.asm):02064                 LDD     ,X                                ;GET NEW
2E24 AEC4             (         mapl.asm):02065                 LDX     ,U                                ;GET OLD
2E26 17F763           (         mapl.asm):02066                 LBSR    MULT                              ;DO MULTIPLY
2E29 EDC4             (         mapl.asm):02067                 STD     ,U                                ;RESAVE
2E2B 39               (         mapl.asm):02068                 RTS
2E2C                  (         mapl.asm):02069         DYDIV
2E2C ECC4             (         mapl.asm):02070                 LDD     ,U                                ;GET OLD
2E2E 102704DA         (         mapl.asm):02071                 LBEQ    CDOM                              ;INDICATE ERROR IF %0
2E32 AE84             (         mapl.asm):02072                 LDX     ,X                                ;GET NEW
2E34 17F775           (         mapl.asm):02073                 LBSR    DIV                               ;DO DIVISION
2E37 AFC4             (         mapl.asm):02074                 STX     ,U                                ;SAVE RESULT
2E39 FD3C9C           (         mapl.asm):02075                 STD     DIVREM                            ;SAVE REMAINDER
2E3C 39               (         mapl.asm):02076                 RTS
2E3D                  (         mapl.asm):02077         DYMOD
2E3D EC84             (         mapl.asm):02078                 LDD     ,X                                ;GET NEW VALUE
2E3F 102704C9         (         mapl.asm):02079                 LBEQ    CDOM                              ;DIVISION BY ZERO
2E43 AEC4             (         mapl.asm):02080                 LDX     ,U                                ;GET OLD VALUE
2E45 17F764           (         mapl.asm):02081                 LBSR    DIV                               ;DO DIVISION
2E48 EDC4             (         mapl.asm):02082                 STD     ,U                                ;SAVE RESULT
2E4A 39               (         mapl.asm):02083                 RTS
2E4B                  (         mapl.asm):02084         DYCEIL
2E4B ECC4             (         mapl.asm):02085                 LDD     ,U                                ;GET OLD VALUE
2E4D 10A384           (         mapl.asm):02086                 CMPD    ,X                                ;PERFORM TEST
2E50 2204             (         mapl.asm):02087                 BHI     DYRTS                             ;OK, GO HOME
2E52                  (         mapl.asm):02088         DYSWP
2E52 EC84             (         mapl.asm):02089                 LDD     ,X                                ;GET OTHER VALUE
2E54 EDC4             (         mapl.asm):02090                 STD     ,U                                ;AND SAVE
2E56                  (         mapl.asm):02091         DYRTS
2E56 39               (         mapl.asm):02092                 RTS
2E57                  (         mapl.asm):02093         DYFLOR
2E57 ECC4             (         mapl.asm):02094                 LDD     ,U                                ;GET OLD VALUE
2E59 10A384           (         mapl.asm):02095                 CMPD    ,X                                ;PERFORM TEST
2E5C 25F8             (         mapl.asm):02096                 BLO     DYRTS                             ;OK, GO HOME
2E5E 20F2             (         mapl.asm):02097                 BRA     DYSWP                             ;SWAP
2E60                  (         mapl.asm):02098         DYAND
2E60 ECC4             (         mapl.asm):02099                 LDD     ,U                                ;GET OLD
2E62 A484             (         mapl.asm):02100                 ANDA    ,X                                ;AND HIGH BYTE
2E64 E401             (         mapl.asm):02101                 ANDB    1,X                               ;AND LOW BYTE
2E66 EDC4             (         mapl.asm):02102                 STD     ,U                                ;RESAVE
2E68 39               (         mapl.asm):02103                 RTS
2E69                  (         mapl.asm):02104         DYOR
2E69 ECC4             (         mapl.asm):02105                 LDD     ,U                                ;GET OLD
2E6B AA84             (         mapl.asm):02106                 ORA     ,X                                ;OR HIGH BYTE
2E6D EA01             (         mapl.asm):02107                 ORB     1,X                               ;OR LOW BYTE
2E6F EDC4             (         mapl.asm):02108                 STD     ,U                                ;SAVE RESULT
2E71 39               (         mapl.asm):02109                 RTS
2E72                  (         mapl.asm):02110         DYXOR
2E72 ECC4             (         mapl.asm):02111                 LDD     ,U                                ;GET OLD
2E74 A884             (         mapl.asm):02112                 EORA    ,X                                ;XOR HIGH BYTE
2E76 E801             (         mapl.asm):02113                 EORB    1,X                               ;XOR LOW BYTE
2E78 EDC4             (         mapl.asm):02114                 STD     ,U                                ;RESAVE
2E7A 39               (         mapl.asm):02115                 RTS
2E7B                  (         mapl.asm):02116         DYGT
2E7B EC84             (         mapl.asm):02117                 LDD     ,X                                ;GET NEW
2E7D 10A3C4           (         mapl.asm):02118                 CMPD    ,U                                ;TEST AGAINST OLD
2E80 221C             (         mapl.asm):02119                 BHI     RET1                              ;ITS TRUE
2E82 2010             (         mapl.asm):02120                 BRA     RET0
2E84                  (         mapl.asm):02121         DYLT
2E84 EC84             (         mapl.asm):02122                 LDD     ,X                                ;GET NEW
2E86 10A3C4           (         mapl.asm):02123                 CMPD    ,U                                ;TEST AGAINST OLD
2E89 2513             (         mapl.asm):02124                 BLO     RET1                              ;TRUE
2E8B 2007             (         mapl.asm):02125                 BRA     RET0                              ;FALES
2E8D                  (         mapl.asm):02126         DYGE
2E8D EC84             (         mapl.asm):02127                 LDD     ,X                                ;GET NEW
2E8F 10A3C4           (         mapl.asm):02128                 CMPD    ,U                                ;TEST AGAINST OLD
2E92 240A             (         mapl.asm):02129                 BHS     RET1                              ;OK
2E94                  (         mapl.asm):02130         RET0
2E94 5F               (         mapl.asm):02131                 CLRB
2E95 2009             (         mapl.asm):02132                 BRA     RETX
2E97                  (         mapl.asm):02133         DYLE
2E97 EC84             (         mapl.asm):02134                 LDD     ,X                                ;GET NEW
2E99 10A3C4           (         mapl.asm):02135                 CMPD    ,U                                ;TEST AGAINST OLD
2E9C 22F6             (         mapl.asm):02136                 BHI     RET0                              ;FALSE
2E9E                  (         mapl.asm):02137         RET1
2E9E C601             (         mapl.asm):02138                 LDB     #1                                ;TRUE
2EA0                  (         mapl.asm):02139         RETX
2EA0 4F               (         mapl.asm):02140                 CLRA                                      ;     CLEAR HIGH BYTE,
2EA1 EDC4             (         mapl.asm):02141                 STD     ,U                                ;SAVE VALUE
2EA3 39               (         mapl.asm):02142                 RTS
2EA4                  (         mapl.asm):02143         DYEQ
2EA4 EC84             (         mapl.asm):02144                 LDD     ,X                                ;GET NEW
2EA6 10A3C4           (         mapl.asm):02145                 CMPD    ,U                                ;TEST AGAINAT OLD
2EA9 27F3             (         mapl.asm):02146                 BEQ     RET1                              ;OK
2EAB 26E7             (         mapl.asm):02147                 BNE     RET0                              ;FALSE
2EAD                  (         mapl.asm):02148         DYNE
2EAD EC84             (         mapl.asm):02149                 LDD     ,X                                ;GET NEW
2EAF 10A3C4           (         mapl.asm):02150                 CMPD    ,U                                ;TEST AGAINST OLD
2EB2 27E0             (         mapl.asm):02151                 BEQ     RET0                              ;FALSE
2EB4 20E8             (         mapl.asm):02152                 BRA     RET1                              ;TRUE
                      (         mapl.asm):02153         ;* EXECUTE FUNCTION WITH A VALUE
2EB6                  (         mapl.asm):02154         FUNVAL
2EB6 3550             (         mapl.asm):02155                 PULS    X,U                               ;RESTORE STACK
2EB8 BF3C84           (         mapl.asm):02156                 STX     TEMP                              ;SAVE PARAMETER ADDRESS
2EBB 3121             (         mapl.asm):02157                 LEAY    1,Y                               ;BACK FOR FUNCTION NAME
2EBD 17F64B           (         mapl.asm):02158                 LBSR    LOOKUP                            ;LOOK FOR IT
2EC0 8102             (         mapl.asm):02159                 CMPA    #2                                ;IS IT A FUNCTION
2EC2 1024FA68         (         mapl.asm):02160                 LBHS    CSYNT                             ;SYNTAX ERROR
2EC6 1705D7           (         mapl.asm):02161                 LBSR    FUNC                              ;PERFORM FUNCTION
2EC9 16F76A           (         mapl.asm):02162                 LBRA    NXTOPR                            ;GET NEXT OPERATOR
                      (         mapl.asm):02163         ;*
                      (         mapl.asm):02164         ;* DISPLAYS VALUE OF A STRUCTURE (X)
                      (         mapl.asm):02165         ;*
2ECC                  (         mapl.asm):02166         DISPLY
2ECC 3450             (         mapl.asm):02167                 PSHS    X,U                               ;SAVE VARIABLES
2ECE A680             (         mapl.asm):02168                 LDA     ,X+                               ;GET TYPE
2ED0 2719             (         mapl.asm):02169                 BEQ     CHROUT                            ;IT'S CHARACTER DATA
2ED2 EC81             (         mapl.asm):02170                 LDD     ,X++                              ;GET LENGTH
2ED4 2726             (         mapl.asm):02171                 BEQ     NULOUT                            ;NOTHING TO OUTPUT
2ED6 3406             (         mapl.asm):02172                 PSHS    D                                 ;SAVE TEMP
2ED8 E3E4             (         mapl.asm):02173                 ADDD    ,S                                ;DOUBLE FOR INTEGERS
2EDA 338B             (         mapl.asm):02174                 LEAU    D,X                               ;SKIP TO END
2EDC 3510             (         mapl.asm):02175                 PULS    X                                 ;GET # ELEMENTS IN X
2EDE                  (         mapl.asm):02176         DIS1
2EDE ECC3             (         mapl.asm):02177                 LDD     ,--U                              ;GET VALUE
2EE0 8D1C             (         mapl.asm):02178                 BSR     DECOUT                            ;OUTPUT
2EE2 17F59A           (         mapl.asm):02179                 LBSR    SPACE                             ;DISPLAY SPACE
2EE5 301F             (         mapl.asm):02180                 LEAX    -1,X                              ;REDUCE COUNT
2EE7 26F5             (         mapl.asm):02181                 BNE     DIS1                              ;AND CONTINUE
2EE9 2011             (         mapl.asm):02182                 BRA     NULOUT                            ;GO AWAY
2EEB                  (         mapl.asm):02183         CHROUT
2EEB EC81             (         mapl.asm):02184                 LDD     ,X++                              ;GET LENGTH
2EED 270D             (         mapl.asm):02185                 BEQ     NULOUT                            ;NULL STRING
2EEF 338B             (         mapl.asm):02186                 LEAU    D,X                               ;SKIP TO END
2EF1 1F01             (         mapl.asm):02187                 TFR     D,X                               ;COPY TO X
2EF3                  (         mapl.asm):02188         DIS2
2EF3 A6C2             (         mapl.asm):02189                 LDA     ,-U                               ;GET CHARACTER
2EF5 17F580           (         mapl.asm):02190                 LBSR    PUTCHR                            ;OUTPUT
2EF8 301F             (         mapl.asm):02191                 LEAX    -1,X                              ;REDUCE LENGTH,
2EFA 26F7             (         mapl.asm):02192                 BNE     DIS2                              ;KEEP GOING
2EFC                  (         mapl.asm):02193         NULOUT
2EFC 35D0             (         mapl.asm):02194                 PULS    X,U,PC                            ;BACK TO WORK
                      (         mapl.asm):02195         ;*
                      (         mapl.asm):02196         ;* DISPLAY NUMBER (D) IN DECIMAL
                      (         mapl.asm):02197         ;*
2EFE                  (         mapl.asm):02198         DECOUT
2EFE 3430             (         mapl.asm):02199                 PSHS    X,Y
2F00 1F01             (         mapl.asm):02200                 TFR     D,X                               ;COPY
2F02 108E0000         (         mapl.asm):02201                 LDY     #0                                ;START WITH ZERO CHARS
2F06                  (         mapl.asm):02202         DEC1
2F06 CC000A           (         mapl.asm):02203                 LDD     #10                               ;DIVIDE BY 10
2F09 17F6A0           (         mapl.asm):02204                 LBSR    DIV                               ;PERFORM DIVISION
2F0C 3404             (         mapl.asm):02205                 PSHS    B                                 ;SAVE IT
2F0E 3121             (         mapl.asm):02206                 LEAY    1,Y                               ;ADVANCE
2F10 8C0000           (         mapl.asm):02207                 CMPX    #0                                ;OVER YET?
2F13 26F1             (         mapl.asm):02208                 BNE     DEC1                              ;NO, KEEP GOING
2F15                  (         mapl.asm):02209         DEC2
2F15 3502             (         mapl.asm):02210                 PULS    A                                 ;GET CHAR BACK
2F17 8A30             (         mapl.asm):02211                 ORA     #$30                              ;CONVERT TO DISPLAYABLE
2F19 17F55C           (         mapl.asm):02212                 LBSR    PUTCHR                            ;OUTPUT IT
2F1C 313F             (         mapl.asm):02213                 LEAY    -1,Y                              ;REDUCE COUNT OF CHARACTERS
2F1E 26F5             (         mapl.asm):02214                 BNE     DEC2                              ;AND CONTINUE
2F20 35B0             (         mapl.asm):02215                 PULS    X,Y,PC
                      (         mapl.asm):02216         ;*
                      (         mapl.asm):02217         ;* GETS A VALUE FOR THE WORKSPACE (,X)
                      (         mapl.asm):02218         ;*
2F22                  (         mapl.asm):02219         GETPRM
2F22 BE4000           (         mapl.asm):02220                 LDX     FREE                              ;POINT TO FREE SPACE
2F25 10BF3C9E         (         mapl.asm):02221                 STY     TXTPTR                            ;SAVE TEXT POSITION
2F29 8D05             (         mapl.asm):02222                 BSR     GETVAL                            ;GET VALUE
2F2B 1026F9FF         (         mapl.asm):02223                 LBNE    CSYNT                             ;IF NONE, PROCLAIM ERROR
2F2F 39               (         mapl.asm):02224                 RTS
2F30                  (         mapl.asm):02225         GETVAL
2F30 3450             (         mapl.asm):02226                 PSHS    X,U                               ;SAVE REGSITERS
2F32 17F568           (         mapl.asm):02227                 LBSR    SKBKP                             ;BACKUP
2F35 8129             (         mapl.asm):02228                 CMPA    #')'                              ;EXPRESSION
2F37 2610             (         mapl.asm):02229                 BNE     GETV0                             ;NO, CONTINUE
2F39 17F6DA           (         mapl.asm):02230                 LBSR    DOEXPR                            ;DO EXPRESSION
2F3C 8128             (         mapl.asm):02231                 CMPA    #'('                              ;CLOSED PROPERLY?
2F3E 102604B9         (         mapl.asm):02232                 LBNE    SYNTAX                            ;INDICATE INVALID
2F42 AFE4             (         mapl.asm):02233                 STX     ,S                                ;SAVE OUTPUT ADDRESS
2F44 17F558           (         mapl.asm):02234                 LBSR    SKBK                              ;BACKUP
2F47 2064             (         mapl.asm):02235                 BRA     NV1                               ;GO AGAIN
2F49                  (         mapl.asm):02236         GETV0
2F49 815D             (         mapl.asm):02237                 CMPA    #']'                              ;IS IT INDEX?
2F4B 10260092         (         mapl.asm):02238                 LBNE    GETN0                             ;NO, EVERYTHING IS OK
                      (         mapl.asm):02239         ;* LOOK UP INDEX VALUE
2F4F 17F6C4           (         mapl.asm):02240                 LBSR    DOEXPR                            ;GET VALUE
2F52 815B             (         mapl.asm):02241                 CMPA    #'['                              ;CLOSE PROPERLY
2F54 102604A3         (         mapl.asm):02242                 LBNE    SYNTAX                            ;INVALID SYNTAX
2F58 A684             (         mapl.asm):02243                 LDA     ,X                                ;GET TYPE
2F5A 8101             (         mapl.asm):02244                 CMPA    #1                                ;IS IT INTEGER?
2F5C 102604A5         (         mapl.asm):02245                 LBNE    DOMAIN                            ;INDICATE DOMAIN ERROR
2F60 17F53C           (         mapl.asm):02246                 LBSR    SKBK                              ;BACKUP
2F63 AFE4             (         mapl.asm):02247                 STX     ,S                                ;SAVE POINTER TO ENTRY
2F65 FC3C90           (         mapl.asm):02248                 LDD     TEMP5                             ;GET BUFFER ADDRESS
2F68 B34006           (         mapl.asm):02249                 SUBD    BUFSIZ                            ;ALLOCATE ANOTHER BUFFER
2F6B FD3C90           (         mapl.asm):02250                 STD     TEMP5                             ;RESAVE
2F6E 17FFB1           (         mapl.asm):02251                 LBSR    GETPRM                            ;GET VALUE
2F71 FC3C90           (         mapl.asm):02252                 LDD     TEMP5                             ;GET BUFFER ADDRESS
2F74 F34006           (         mapl.asm):02253                 ADDD    BUFSIZ                            ;RELEASE BUFFER
2F77 FD3C90           (         mapl.asm):02254                 STD     TEMP5                             ;RESAVE
2F7A EEE4             (         mapl.asm):02255                 LDU     ,S                                ;GET ORIG. PARM BACK
2F7C EC01             (         mapl.asm):02256                 LDD     1,X                               ;GET LENGTH
2F7E 830001           (         mapl.asm):02257                 SUBD    #1                                ;CONVERT TO OFFSET FROM ZERO
2F81 FD3C8E           (         mapl.asm):02258                 STD     TEMP4                             ;SAVE FOR REF
2F84 A684             (         mapl.asm):02259                 LDA     ,X                                ;GET ARG. TYPE
2F86 3003             (         mapl.asm):02260                 LEAX    3,X                               ;SKIP TO DATA
2F88 A7C0             (         mapl.asm):02261                 STA     ,U+                               ;SET DEST TYPE
2F8A 2725             (         mapl.asm):02262                 BEQ     CHRI                              ;CHARACTER INDEX
2F8C ECC1             (         mapl.asm):02263                 LDD     ,U++                              ;GET LENGTH
2F8E                  (         mapl.asm):02264         NUMI
2F8E 3406             (         mapl.asm):02265                 PSHS    A,B                               ;SAVE
2F90 ECC4             (         mapl.asm):02266                 LDD     ,U                                ;GET INDEX VALUE
2F92 B34002           (         mapl.asm):02267                 SUBD    ORIGIN                            ;SUBTRACT ORIGIN VALUE
2F95 3406             (         mapl.asm):02268                 PSHS    A,B                               ;SAVE VALUE ON STACK
2F97 FC3C8E           (         mapl.asm):02269                 LDD     TEMP4                             ;GET VALUE
2F9A A3E1             (         mapl.asm):02270                 SUBD    ,S++                              ;CONVERT TO PROPER OFFSET
2F9C 1025046F         (         mapl.asm):02271                 LBCS    INDEX                             ;INDICATE INDEX ERROR
2FA0 58               (         mapl.asm):02272                 LSLB
2FA1 49               (         mapl.asm):02273                 ROLA                                      ;     DOUBLE FOR TWO BYTE ENTRIES
2FA2 EC8B             (         mapl.asm):02274                 LDD     D,X                               ;GET OPERAND
2FA4 EDC1             (         mapl.asm):02275                 STD     ,U++                              ;SAVE IN OUTPUT
2FA6 3506             (         mapl.asm):02276                 PULS    A,B                               ;GET LENGTH BACK
2FA8 830001           (         mapl.asm):02277                 SUBD    #1                                ;REDUCE
2FAB 26E1             (         mapl.asm):02278                 BNE     NUMI                              ;AND KEEP GOING
2FAD                  (         mapl.asm):02279         NV1
2FAD 1A04             (         mapl.asm):02280                 ORCC    #4                                ;SET Z FLAG
2FAF 35D0             (         mapl.asm):02281                 PULS    X,U,PC                            ;GO HOME
2FB1                  (         mapl.asm):02282         CHRI
2FB1 ECC1             (         mapl.asm):02283                 LDD     ,U++                              ;SAVE VALUE
2FB3 10BF3C9E         (         mapl.asm):02284                 STY     TXTPTR                            ;SAVE TEXT POINTER
2FB7 1F32             (         mapl.asm):02285                 TFR     U,Y                               ;POINT TO CHARACTER SPACE
2FB9                  (         mapl.asm):02286         CHRI1
2FB9 3406             (         mapl.asm):02287                 PSHS    A,B                               ;SAVE
2FBB ECC1             (         mapl.asm):02288                 LDD     ,U++                              ;GET INDEX VALUE
2FBD B34002           (         mapl.asm):02289                 SUBD    ORIGIN                            ;SUBTRACT ORIGIN VALUE
2FC0 3406             (         mapl.asm):02290                 PSHS    A,B                               ;SAVE VALUE ON STACK
2FC2 FC3C8E           (         mapl.asm):02291                 LDD     TEMP4                             ;GET VALUE
2FC5 A3E1             (         mapl.asm):02292                 SUBD    ,S++                              ;CONVERT TO PROPER OFFSET
2FC7 2511             (         mapl.asm):02293                 BCS     CIDX                              ;INDICATE INDEX ERROR
2FC9 A68B             (         mapl.asm):02294                 LDA     D,X                               ;GET OPERAND
2FCB A7A0             (         mapl.asm):02295                 STA     ,Y+                               ;SAVE IN OUTPUT
2FCD 3506             (         mapl.asm):02296                 PULS    A,B                               ;GET LENGTH BACK
2FCF 830001           (         mapl.asm):02297                 SUBD    #1                                ;REDUCE
2FD2 26E5             (         mapl.asm):02298                 BNE     CHRI1                             ;AND KEEP GOING
2FD4 10BE3C9E         (         mapl.asm):02299                 LDY     TXTPTR                            ;GI IT AGAIN
2FD8 20D3             (         mapl.asm):02300                 BRA     NV1
2FDA                  (         mapl.asm):02301         CIDX
2FDA 10BE3C9E         (         mapl.asm):02302                 LDY     TXTPTR                            ;GET TEXT POINTER AGAIN
2FDE 16042E           (         mapl.asm):02303                 LBRA    INDEX                             ;GET UPSET
                      (         mapl.asm):02304         ;* TEST FOR NUMBER
2FE1                  (         mapl.asm):02305         GETN0
2FE1 17F4DE           (         mapl.asm):02306                 LBSR    VALNUM                            ;IS IT A NUMBER?
2FE4 261A             (         mapl.asm):02307                 BNE     GETV1                             ;NO, TRY STRING
2FE6 8601             (         mapl.asm):02308                 LDA     #1                                ;INDICATE ONE VARIABLE
2FE8 A784             (         mapl.asm):02309                 STA     ,X                                ;SET TYPE
2FEA 3003             (         mapl.asm):02310                 LEAX    3,X                               ;SKIP POSITION
2FEC CE0000           (         mapl.asm):02311                 LDU     #0                                ;START WITH ZERO ELEMENTS
2FEF                  (         mapl.asm):02312         GETN1
2FEF 17F4AB           (         mapl.asm):02313                 LBSR    SKBKP                             ;LOOK FOR NUMBER
2FF2 17F4CD           (         mapl.asm):02314                 LBSR    VALNUM                            ;VALID NUMBER?
2FF5 2633             (         mapl.asm):02315                 BNE     GETV9                             ;LAST NUMBER
2FF7 3341             (         mapl.asm):02316                 LEAU    1,U                               ;ADVANCE
2FF9 17F4DB           (         mapl.asm):02317                 LBSR    GETDEC                            ;GET A NUMBER
2FFC ED81             (         mapl.asm):02318                 STD     ,X++                              ;SAVE VALUE
2FFE 20EF             (         mapl.asm):02319                 BRA     GETN1                             ;AND TRY AGAIN
3000                  (         mapl.asm):02320         GETV1
3000 8127             (         mapl.asm):02321                 CMPA    #$27                              ;IS IT A CHARACTER VALUE?
3002 262E             (         mapl.asm):02322                 BNE     GETV2                             ;NO, TRY NEXT
                      (         mapl.asm):02323         ;* GETS A CHARACTER VALUE FOR THE WORKSPACE
3004 6F84             (         mapl.asm):02324                 CLR     ,X                                ;INDICATE CHARACTER DATA
3006 3003             (         mapl.asm):02325                 LEAX    3,X                               ;SKIP FOR NOW
3008 CE0000           (         mapl.asm):02326                 LDU     #0                                ;START WITH ZERO CHARACTER
300B                  (         mapl.asm):02327         GETC2
300B A6A2             (         mapl.asm):02328                 LDA     ,-Y                               ;GET NEXT CHARACTER
300D 8127             (         mapl.asm):02329                 CMPA    #$27                              ;CLOSING QUOTE?
300F 270C             (         mapl.asm):02330                 BEQ     GETC3                             ;IF SO, QUIT
3011 810D             (         mapl.asm):02331                 CMPA    #$0D                              ;END OF LINE?
3013 102703E4         (         mapl.asm):02332                 LBEQ    SYNTAX                            ;INDICATE ERROR
3017                  (         mapl.asm):02333         GETC5
3017 3341             (         mapl.asm):02334                 LEAU    1,U                               ;INC. NUMBER OF CHARACTERS IN STRING
3019 A780             (         mapl.asm):02335                 STA     ,X+                               ;SAVE IN OUTPUT VALUE
301B 20EE             (         mapl.asm):02336                 BRA     GETC2                             ;NO TRY FOR ANOTHER
301D                  (         mapl.asm):02337         GETC3
301D A63F             (         mapl.asm):02338                 LDA     -1,Y                              ;GET PRECEDING CHAR
301F 8127             (         mapl.asm):02339                 CMPA    #$27                              ;QUOTE?
3021 2604             (         mapl.asm):02340                 BNE     GETC4                             ;NO, TERMINATE
3023 A6A2             (         mapl.asm):02341                 LDA     ,-Y                               ;GET CHARACTER
3025 20F0             (         mapl.asm):02342                 BRA     GETC5
3027                  (         mapl.asm):02343         GETC4
3027 17F475           (         mapl.asm):02344                 LBSR    SKBK                              ;ADVANCE BACKWARDS
302A                  (         mapl.asm):02345         GETV9
302A AEE4             (         mapl.asm):02346                 LDX     ,S                                ;GET OFFSET
302C EF01             (         mapl.asm):02347                 STU     1,X                               ;SAVE SIZE
302E 1A04             (         mapl.asm):02348                 ORCC    #4                                ;SET Z FLAG
3030 35D0             (         mapl.asm):02349                 PULS    X,U,PC                            ;BACKUP AND RETURN
                      (         mapl.asm):02350         ;* TEST FOR SYSTEM VARIABLE
3032                  (         mapl.asm):02351         GETV2
3032 8124             (         mapl.asm):02352                 CMPA    #'$'                              ;SYS VAR?
3034 265C             (         mapl.asm):02353                 BNE     GETV3                             ;NO, TRY SYMBOL
3036 C601             (         mapl.asm):02354                 LDB     #1                                ;GET TYPE, INTEGER
3038 E780             (         mapl.asm):02355                 STB     ,X+                               ;SAVE IN RAM
303A 4F               (         mapl.asm):02356                 CLRA                                      ;     SET LENGTH TO 1
303B ED81             (         mapl.asm):02357                 STD     ,X++                              ;SAVE LENGTH
303D A6A2             (         mapl.asm):02358                 LDA     ,-Y                               ;GET SYMBOL LENGTH
303F 814C             (         mapl.asm):02359                 CMPA    #'L'                              ;IS IT LINE NUMBER?
3041 2605             (         mapl.asm):02360                 BNE     SYS1                              ;NO, TRY ORIGIN
3043 FC3C96           (         mapl.asm):02361                 LDD     LINCT                             ;GET COUNTER
3046 2041             (         mapl.asm):02362                 BRA     SYS9                              ;AND EXIT WITH IT
3048                  (         mapl.asm):02363         SYS1
3048 814F             (         mapl.asm):02364                 CMPA    #'O'                              ;ORIGIN?
304A 2605             (         mapl.asm):02365                 BNE     SYS2                              ;NO, TRY WSSIZE.
304C FC4002           (         mapl.asm):02366                 LDD     ORIGIN                            ;GET ORIGIN VALUE
304F 2038             (         mapl.asm):02367                 BRA     SYS9                              ;AND EXIT
3051                  (         mapl.asm):02368         SYS2
3051 8157             (         mapl.asm):02369                 CMPA    #'W'                              ;IS IT WORKSPACE SIZE?
3053 2608             (         mapl.asm):02370                 BNE     SYS3                              ;NO, TRY DIV REM
3055 FC3C90           (         mapl.asm):02371                 LDD     TEMP5                             ;GET FREE ADDRESS
3058 B34000           (         mapl.asm):02372                 SUBD    FREE                              ;CONVERT TO SIMPLE OFFSET
305B 202C             (         mapl.asm):02373                 BRA     SYS9                              ;END EXIT
305D                  (         mapl.asm):02374         SYS3
305D 8152             (         mapl.asm):02375                 CMPA    #'R'                              ;REMAINDER?
305F 2605             (         mapl.asm):02376                 BNE     SYS4                              ;NO, TRY SEED
3061 FC3C9C           (         mapl.asm):02377                 LDD     DIVREM                            ;GET REMANDER
3064 2023             (         mapl.asm):02378                 BRA     SYS9                              ;AND EXIT
3066                  (         mapl.asm):02379         SYS4
3066 8153             (         mapl.asm):02380                 CMPA    #'S'                              ;SEED?
3068 2605             (         mapl.asm):02381                 BNE     ATOM                              ;NO, TRY ATOMIC VECTOR
306A FC4004           (         mapl.asm):02382                 LDD     SEED                              ;GET SEED VALUE
306D 201A             (         mapl.asm):02383                 BRA     SYS9                              ;AND SAVE
306F                  (         mapl.asm):02384         ATOM
306F 8143             (         mapl.asm):02385                 CMPA    #'C'                              ;CHARACTER STRING?
3071 260F             (         mapl.asm):02386                 BNE     SY5                               ;NO, TRY NEXT
3073 6F1D             (         mapl.asm):02387                 CLR     -3,X                              ;INDICATE CHARACTER
3075 CC0100           (         mapl.asm):02388                 LDD     #256                              ;LENGTH OF IT
3078 ED1E             (         mapl.asm):02389                 STD     -2,X                              ;SET IT UP
307A 4F               (         mapl.asm):02390                 CLRA                                      ;     START WITH NULL
307B                  (         mapl.asm):02391         AV1
307B 4A               (         mapl.asm):02392                 DECA                                      ;     BACKUP THROUGH CHARACTER SET
307C A780             (         mapl.asm):02393                 STA     ,X+                               ;SAVE IN VECTOR
307E 26FB             (         mapl.asm):02394                 BNE     AV1                               ;KEEP GOING
3080 2009             (         mapl.asm):02395                 BRA     SYSX                              ;GO  HOME
3082                  (         mapl.asm):02396         SY5
3082 8142             (         mapl.asm):02397                 CMPA    #'B'                              ;BUFFER SIZE?
3084 2646             (         mapl.asm):02398                 BNE     SYSPRM                            ;NO, TRY PARM
3086 FC4006           (         mapl.asm):02399                 LDD     BUFSIZ                            ;GET BUFFER SIZE
3089                  (         mapl.asm):02400         SYS9
3089 ED84             (         mapl.asm):02401                 STD     ,X                                ;SAVE VALUE
308B                  (         mapl.asm):02402         SYSX
308B 17F411           (         mapl.asm):02403                 LBSR    SKBK                              ;SKIP BACK TO NEXT
308E 1A04             (         mapl.asm):02404                 ORCC    #4                                ;SET Z FLAG
3090 35D0             (         mapl.asm):02405                 PULS    X,U,PC                            ;AND GO HOME
                      (         mapl.asm):02406         ;* LOOK FOR SYMBOL IN TABLE
3092                  (         mapl.asm):02407         GETV3
3092 17F437           (         mapl.asm):02408                 LBSR    VALSYM                            ;IS IT A SYMBOL
3095 2631             (         mapl.asm):02409                 BNE     GETV4                             ;NOT VALID
3097 CC3A3E           (         mapl.asm):02410                 LDD     #IOTA0                            ;DEFAULT PARAMETER
309A FD3C84           (         mapl.asm):02411                 STD     TEMP                              ;SAVE
309D 17F46B           (         mapl.asm):02412                 LBSR    LOOKUP                            ;LOOK UP VALUE
30A0 1026035C         (         mapl.asm):02413                 LBNE    VALUE                             ;INDICATE VALUE ERROR
30A4 8102             (         mapl.asm):02414                 CMPA    #2                                ;IS IT A VARIABLE
30A6 2604             (         mapl.asm):02415                 BNE     GETV5                             ;NO, TRY LABEL
30A8 AE85             (         mapl.asm):02416                 LDX     B,X                               ;POINT TO VARIABLE ENTRY
30AA 2016             (         mapl.asm):02417                 BRA     GETV6                             ;GO FOR IT
30AC                  (         mapl.asm):02418         GETV5
30AC 8103             (         mapl.asm):02419                 CMPA    #3                                ;IS IT A LABEL?
30AE 260F             (         mapl.asm):02420                 BNE     GETV7                             ;NO, TRY.
30B0 EC85             (         mapl.asm):02421                 LDD     B,X                               ;GET VALUE
30B2 AEE4             (         mapl.asm):02422                 LDX     ,S                                ;GET STACK VALUE
30B4 ED03             (         mapl.asm):02423                 STD     3,X                               ;SAVE IT
30B6 C601             (         mapl.asm):02424                 LDB     #1                                ;GET TYPE
30B8 4F               (         mapl.asm):02425                 CLRA                                      ;     ZERO HIGH BYTE
30B9 E784             (         mapl.asm):02426                 STB     ,X                                ;SAVE TYPE
30BB ED01             (         mapl.asm):02427                 STD     1,X                               ;SAVE LENGTH
30BD 2003             (         mapl.asm):02428                 BRA     GETV6
30BF                  (         mapl.asm):02429         GETV7
30BF 1703DE           (         mapl.asm):02430                 LBSR    FUNC                              ;CALL FUNCTION
30C2                  (         mapl.asm):02431         GETV6
30C2 3262             (         mapl.asm):02432                 LEAS    2,S                               ;SKIP X VALUE FROM STACK
30C4 1A04             (         mapl.asm):02433                 ORCC    #4                                ;SET Z FLAG
30C6 35C0             (         mapl.asm):02434                 PULS    U,PC                              ;AND GO HOME
30C8                  (         mapl.asm):02435         GETV4
30C8 1CFB             (         mapl.asm):02436                 ANDCC   #$FB                              ;CLEAR Z FLAG
30CA 35D0             (         mapl.asm):02437                 PULS    X,U,PC                            ;AND RETURN
                      (         mapl.asm):02438         ;* 'P$' SYSTEM VARIABLE
30CC                  (         mapl.asm):02439         SYSPRM
30CC 8150             (         mapl.asm):02440                 CMPA    #'P'                              ;IS IT PARAMETER
30CE 2608             (         mapl.asm):02441                 BNE     KREAD                             ;NO, TRY TO READ TERMINAL
30D0 17F3CC           (         mapl.asm):02442                 LBSR    SKBK                              ;BACKUP
30D3 BE3C94           (         mapl.asm):02443                 LDX     PARM                              ;GET PARAMETER POINTER
30D6 20EA             (         mapl.asm):02444                 BRA     GETV6                             ;RETURN
                      (         mapl.asm):02445         ;* READ A SINGLE KEYBOARD KEY
30D8                  (         mapl.asm):02446         KREAD
30D8 814B             (         mapl.asm):02447                 CMPA    #'K'                              ;READ KEYBOARD?
30DA 260E             (         mapl.asm):02448                 BNE     INTER                             ;NO, TRY READ LINE
30DC 6F1D             (         mapl.asm):02449                 CLR     -3,X                              ;SET TYPE TO CHARACTER
30DE CC0001           (         mapl.asm):02450                 LDD     #1                                ;GET LENGTH OF ONE
30E1 ED1E             (         mapl.asm):02451                 STD     -2,X                              ;SAVE
30E3 17F35C           (         mapl.asm):02452                 LBSR    GETCHR                            ;READ A CHARACTER
30E6 A784             (         mapl.asm):02453                 STA     ,X                                ;SAVE IT
30E8                  (         mapl.asm):02454         SYSX1
30E8 20A1             (         mapl.asm):02455                 BRA     SYSX                              ;GO HOME
                      (         mapl.asm):02456         ;* READ LINE FROM TERMINAL
30EA                  (         mapl.asm):02457         INTER
30EA 8146             (         mapl.asm):02458                 CMPA    #'F'                              ;FORMATTED INPUT?
30EC 2620             (         mapl.asm):02459                 BNE     INNUM                             ;NO, TRY FOR NUMERIC INPUT
30EE 3420             (         mapl.asm):02460                 PSHS    Y                                 ;SAVE VARIABLE POINTER
30F0 10BE3C90         (         mapl.asm):02461                 LDY     TEMP5                             ;GET BUFFER ADDRESS
30F4 31A880           (         mapl.asm):02462                 LEAY    -128,Y                            ;BACKUP TO FREE RAM
30F7 17F311           (         mapl.asm):02463                 LBSR    GETLIN                            ;READ IT
30FA 5A               (         mapl.asm):02464                 DECB                                      ;     BACKUP
30FB 4F               (         mapl.asm):02465                 CLRA                                      ;     SET HIGH BYTE TO ZERO
30FC A71D             (         mapl.asm):02466                 STA     -3,X                              ;SET TYPE TO CHARACTER
30FE ED1E             (         mapl.asm):02467                 STD     -2,X                              ;SET LENGTH
3100 2708             (         mapl.asm):02468                 BEQ     INTER2                            ;ZERO LENGTH
3102                  (         mapl.asm):02469         INTER1
3102 5A               (         mapl.asm):02470                 DECB                                      ;     BACKUP
3103 A6A5             (         mapl.asm):02471                 LDA     B,Y                               ;GET CHARACTER FROM BUFFER
3105 A780             (         mapl.asm):02472                 STA     ,X+                               ;SAVE IN OUTPUT
3107 5D               (         mapl.asm):02473                 TSTB                                      ;     BACKUP
3108 26F8             (         mapl.asm):02474                 BNE     INTER1                            ;SAVE IT ALL
310A                  (         mapl.asm):02475         INTER2
310A 3520             (         mapl.asm):02476                 PULS    Y                                 ;RESTORE TEXT POINTER
310C 20DA             (         mapl.asm):02477                 BRA     SYSX1                             ;AND GO HOME
310E                  (         mapl.asm):02478         INNUM
310E 8154             (         mapl.asm):02479                 CMPA    #'T'                              ;TERMINAL INP?
3110 102602E7         (         mapl.asm):02480                 LBNE    SYNTAX                            ;NO, GET UPSET
3114                  (         mapl.asm):02481         INN1
3114 FC3CA2           (         mapl.asm):02482                 LDD     RAMTOP                            ;GET TOP OF RAM
3117 3426             (         mapl.asm):02483                 PSHS    A,B,Y                             ;SAVE
3119 10BE3C9A         (         mapl.asm):02484                 LDY     NAMPTR                            ;POINT TO NAME
311D FC3C96           (         mapl.asm):02485                 LDD     LINCT                             ;GET LINE COUNTER
3120 3426             (         mapl.asm):02486                 PSHS    A,B,Y                             ;SAVE
3122 10BE3C98         (         mapl.asm):02487                 LDY     GOTO                              ;GET GOTO POINTER
3126 FC3C94           (         mapl.asm):02488                 LDD     PARM                              ;GET PARAMETERS
3129 3426             (         mapl.asm):02489                 PSHS    A,B,Y                             ;SAVE
312B 10BE3CA0         (         mapl.asm):02490                 LDY     SAVSTK                            ;SAVED STACK POINTER
312F FC3CA6           (         mapl.asm):02491                 LDD     INPSTK                            ;GET INPUT STACK
3132 3426             (         mapl.asm):02492                 PSHS    A,B,Y                             ;SAVE
3134 10FF3CA6         (         mapl.asm):02493                 STS     INPSTK                            ;SAVE OUR STACK POINTER
3138 FC3C90           (         mapl.asm):02494                 LDD     TEMP5                             ;GET BUFFER ADDRESS
313B FD3CA2           (         mapl.asm):02495                 STD     RAMTOP                            ;SAVE IT BACK
313E                  (         mapl.asm):02496         INN2
313E 863F             (         mapl.asm):02497                 LDA     #'?'                              ;GET PROMPT
3140 17F335           (         mapl.asm):02498                 LBSR    PUTCHR                            ;DISPLAY
3143 10BE3C90         (         mapl.asm):02499                 LDY     TEMP5                             ;POINT TO RAM ADDRESS
3147 31A880           (         mapl.asm):02500                 LEAY    -128,Y                            ;BACKUP FOR SOME BUFFER SPACE
314A 10BF3C90         (         mapl.asm):02501                 STY     TEMP5                             ;RESERVE THIS BUFFER
314E 17F2BA           (         mapl.asm):02502                 LBSR    GETLIN                            ;GET A LINE
3151 17F32F           (         mapl.asm):02503                 LBSR    SKP                               ;ADVANCE
3154 810D             (         mapl.asm):02504                 CMPA    #$0D                              ;CR?
3156 27E6             (         mapl.asm):02505                 BEQ     INN2                              ;IF SO, GO AGAIN
3158 860D             (         mapl.asm):02506                 LDA     #$0D                              ;GET CR
315A A73F             (         mapl.asm):02507                 STA     -1,Y                              ;SAVE
315C 17F48E           (         mapl.asm):02508                 LBSR    EXPR                              ;DO EXPRESSION
315F                  (         mapl.asm):02509         INNP3
315F FC3CA2           (         mapl.asm):02510                 LDD     RAMTOP                            ;GET BUFFER ADRESS
3162 FD3C90           (         mapl.asm):02511                 STD     TEMP5                             ;RESAVE
3165 10FE3CA6         (         mapl.asm):02512                 LDS     INPSTK                            ;GET INPUT STACK
3169 3526             (         mapl.asm):02513                 PULS    A,B,Y                             ;GET VALUES BACK
316B FD3CA6           (         mapl.asm):02514                 STD     INPSTK                            ;SAVE INPUT FLAG
316E 10BF3CA0         (         mapl.asm):02515                 STY     SAVSTK                            ;RESAVE STACK
3172 3526             (         mapl.asm):02516                 PULS    A,B,Y                             ;GET MORE
3174 FD3C94           (         mapl.asm):02517                 STD     PARM                              ;SAVE PARM POINTER
3177 10BF3C98         (         mapl.asm):02518                 STY     GOTO                              ;SAVE GOTO FLAG
317B 3526             (         mapl.asm):02519                 PULS    A,B,Y                             ;GET LINCT AND NAMPTR
317D FD3C96           (         mapl.asm):02520                 STD     LINCT                             ;SAVE LINE COUNT
3180 10BF3C9A         (         mapl.asm):02521                 STY     NAMPTR                            ;RESAVE
3184 3526             (         mapl.asm):02522                 PULS    A,B,Y                             ;GET TOP OF RAM
3186 FD3CA2           (         mapl.asm):02523                 STD     RAMTOP                            ;AND RESAVE
3189 7D3CA5           (         mapl.asm):02524                 TST     ERRFLG                            ;DID AN ERROR OCCUR?
318C 2686             (         mapl.asm):02525                 BNE     INN1                              ;IF SO, GO AGAIN
318E 17F30E           (         mapl.asm):02526                 LBSR    SKBK                              ;BACKUP
3191 16FF2E           (         mapl.asm):02527                 LBRA    GETV6                             ;AND GO HOME
                      (         mapl.asm):02528         ;*
                      (         mapl.asm):02529         ;* ASSIGN VALUE(X) TO VARIABLE
                      (         mapl.asm):02530         ;*
3194                  (         mapl.asm):02531         ASSIGN
3194 3450             (         mapl.asm):02532                 PSHS    X,U                               ;SAVE VALUE
3196 10BF3C8C         (         mapl.asm):02533                 STY     TEMP3                             ;SAVE FOR LATER
319A A6A4             (         mapl.asm):02534                 LDA     ,Y                                ;GET VALUE
319C 815D             (         mapl.asm):02535                 CMPA    #']'                              ;INDEXED ASSIGNMENT
319E 102700C6         (         mapl.asm):02536                 LBEQ    IASS                              ;INDICATE SO
31A2 8124             (         mapl.asm):02537                 CMPA    #'$'                              ;IS IT A SYSTEM VARIABLE?
31A4 2662             (         mapl.asm):02538                 BNE     ASI1                              ;NO, NORMAL ASSIGNMENT
31A6 A6A2             (         mapl.asm):02539                 LDA     ,-Y                               ;GET NEXT CHARACTER
31A8 814F             (         mapl.asm):02540                 CMPA    #'O'                              ;SETORIGIN?
31AA 2605             (         mapl.asm):02541                 BNE     ASN1                              ;NO, TRY SEED
31AC CE4002           (         mapl.asm):02542                 LDU     #ORIGIN                           ;SAVE VALUE
31AF 2014             (         mapl.asm):02543                 BRA     ASN9                              ;AND QUIT
31B1                  (         mapl.asm):02544         ASN1
31B1 8143             (         mapl.asm):02545                 CMPA    #'C'                              ;CHARACTER?
31B3 2724             (         mapl.asm):02546                 BEQ     ASN8                              ;PERFORM DUMP
31B5 8153             (         mapl.asm):02547                 CMPA    #'S'                              ;SET RANDOM SEED?
31B7 2605             (         mapl.asm):02548                 BNE     ASN2                              ;NO, TRY NEXT
31B9 CE4004           (         mapl.asm):02549                 LDU     #SEED                             ;SAVE RANDOM SEED
31BC 2007             (         mapl.asm):02550                 BRA     ASN9                              ;SAVE VALUE
31BE                  (         mapl.asm):02551         ASN2
31BE 8142             (         mapl.asm):02552                 CMPA    #'B'                              ;BUFFER SIZE
31C0 261C             (         mapl.asm):02553                 BNE     LGOTO                             ;TRY GOTO LINE
31C2 CE4006           (         mapl.asm):02554                 LDU     #BUFSIZ                           ;POINT TO IT
31C5                  (         mapl.asm):02555         ASN9
31C5 A684             (         mapl.asm):02556                 LDA     ,X                                ;GET TYPE
31C7 1027023A         (         mapl.asm):02557                 LBEQ    DOMAIN                            ;INVALID
31CB EC01             (         mapl.asm):02558                 LDD     1,X                               ;GET LENGTH
31CD                  (         mapl.asm):02559         ASN89
31CD 10830001         (         mapl.asm):02560                 CMPD    #1                                ;SINGLE ELEMENT?
31D1 10260235         (         mapl.asm):02561                 LBNE    LENGTH                            ;NO, IT'S INVALID
31D5 EC03             (         mapl.asm):02562                 LDD     3,X                               ;GET VALUE
31D7 EDC4             (         mapl.asm):02563                 STD     ,U                                ;SAVE IN DEST
31D9                  (         mapl.asm):02564         ASN8
31D9 17F2C3           (         mapl.asm):02565                 LBSR    SKBK                              ;BACKUP
31DC 35D0             (         mapl.asm):02566                 PULS    X,U,PC                            ;RETURN
                      (         mapl.asm):02567         ;* BRANCH BY CHANGEING VALUE OF 'L$'
31DE                  (         mapl.asm):02568         LGOTO
31DE 814C             (         mapl.asm):02569                 CMPA    #'L'                              ;IS IT 'L'$
31E0 260F             (         mapl.asm):02570                 BNE     TEROUT                            ;NO, SAY ERROR
31E2 A684             (         mapl.asm):02571                 LDA     ,X                                ;GET TYPE
31E4 1027021D         (         mapl.asm):02572                 LBEQ    DOMAIN                            ;INVALID
31E8 EC01             (         mapl.asm):02573                 LDD     1,X                               ;GET LENGTH
31EA 27ED             (         mapl.asm):02574                 BEQ     ASN8                              ;IF ZERO, IGNORE
31EC CE3C98           (         mapl.asm):02575                 LDU     #GOTO
31EF 20DC             (         mapl.asm):02576                 BRA     ASN89
                      (         mapl.asm):02577         ;* DISPLAY VALUE ON TERMINAL
31F1                  (         mapl.asm):02578         TEROUT
31F1 8154             (         mapl.asm):02579                 CMPA    #'T'                              ;TERMINAL I/O?
31F3 2608             (         mapl.asm):02580                 BNE     FRMOUT                            ;NO, TRY FORMATTED
31F5 17FCD4           (         mapl.asm):02581                 LBSR    DISPLY                            ;DISPLAY IT
31F8 17F277           (         mapl.asm):02582                 LBSR    LFCR                              ;NEW LINE
31FB 20DC             (         mapl.asm):02583                 BRA     ASN8                              ;GO HOME
31FD                  (         mapl.asm):02584         FRMOUT
31FD 8146             (         mapl.asm):02585                 CMPA    #'F'                              ;FORMATTED OUTPUT?
31FF 102601F8         (         mapl.asm):02586                 LBNE    SYNTAX                            ;NO, GET UPSET
3203 17FCC6           (         mapl.asm):02587                 LBSR    DISPLY                            ;OUTPUT IT
3206 20D1             (         mapl.asm):02588                 BRA     ASN8                              ;AND GO IT AGAIN
                      (         mapl.asm):02589         ;* LOOK UP SYMBOL VALUE
3208                  (         mapl.asm):02590         ASI1
3208 17F2C1           (         mapl.asm):02591                 LBSR    VALSYM                            ;IS IT A VALID SYMBOL NAME
320B 102601EC         (         mapl.asm):02592                 LBNE    SYNTAX                            ;NO, GET UPSET
320F 170101           (         mapl.asm):02593                 LBSR    CALLEN                            ;GET LENGTH
3212 3406             (         mapl.asm):02594                 PSHS    A,B                               ;SAVE LENGTH
3214 17F2F4           (         mapl.asm):02595                 LBSR    LOOKUP                            ;LOOK FOR DATA
3217 2619             (         mapl.asm):02596                 BNE     NEWV                              ;CREATE NEW VARIABLE
3219 8102             (         mapl.asm):02597                 CMPA    #2                                ;IS IT A VARIABLE
321B 102601DC         (         mapl.asm):02598                 LBNE    SYNTAX                            ;INDICATE INVALID SYNTAX
321F BF3C8E           (         mapl.asm):02599                 STX     TEMP4                             ;SAVE FOR LATER
3222 AE85             (         mapl.asm):02600                 LDX     B,X                               ;GET ADDRESS OF VARIABLE
3224 1700EC           (         mapl.asm):02601                 LBSR    CALLEN                            ;DO THEY NEED SAME SPACE
3227 10A3E4           (         mapl.asm):02602                 CMPD    ,S                                ;ARE THEY SAME
322A 2728             (         mapl.asm):02603                 BEQ     ASI2                              ;IF SO, NO NEED TO CHANGE
322C BE3C8E           (         mapl.asm):02604                 LDX     TEMP4                             ;SYMBOL TABLE ENTRY BACK
322F 1705AB           (         mapl.asm):02605                 LBSR    ERASYM                            ;ERASE SYMBOL
3232                  (         mapl.asm):02606         NEWV
3232 8602             (         mapl.asm):02607                 LDA     #2                                ;GET TYPE
3234 10BE3C8C         (         mapl.asm):02608                 LDY     TEMP3                             ;POINT TO NAME
3238 17F319           (         mapl.asm):02609                 LBSR    CRESYM                            ;CREATE SYMBOL
323B 3506             (         mapl.asm):02610                 PULS    A,B                               ;GET LENGTH
323D EE84             (         mapl.asm):02611                 LDU     ,X                                ;GET ADDRESS OF SYMBOL
323F AEE4             (         mapl.asm):02612                 LDX     ,S                                ;GET SYMBOL VALUE
3241 3420             (         mapl.asm):02613                 PSHS    Y                                 ;SAVE POINTER
3243 1F02             (         mapl.asm):02614                 TFR     D,Y                               ;COPY TO Y
3245                  (         mapl.asm):02615         ASI3
3245 A680             (         mapl.asm):02616                 LDA     ,X+                               ;GET BYTE FROM STRUCTURE
3247 A7C0             (         mapl.asm):02617                 STA     ,U+                               ;RESAVE
3249 313F             (         mapl.asm):02618                 LEAY    -1,Y                              ;BACKUP
324B 26F8             (         mapl.asm):02619                 BNE     ASI3                              ;KEEP SAVEING
324D 3520             (         mapl.asm):02620                 PULS    Y                                 ;RESTORE Y
324F FF4000           (         mapl.asm):02621                 STU     FREE                              ;SAVE FREE VALUE
3252 35D0             (         mapl.asm):02622                 PULS    X,U,PC
3254                  (         mapl.asm):02623         ASI2
3254 3506             (         mapl.asm):02624                 PULS    A,B                               ;GET COUNT
3256 EEE4             (         mapl.asm):02625                 LDU     ,S                                ;GET OLD VALUE ADDRESS
3258 3420             (         mapl.asm):02626                 PSHS    Y                                 ;SAVE POINTR
325A 1F02             (         mapl.asm):02627                 TFR     D,Y                               ;COPY
325C                  (         mapl.asm):02628         ASI4
325C A6C0             (         mapl.asm):02629                 LDA     ,U+                               ;GET DATA FROM OLD
325E A780             (         mapl.asm):02630                 STA     ,X+                               ;SAVE IN NEW
3260 313F             (         mapl.asm):02631                 LEAY    -1,Y                              ;BACKUP
3262 26F8             (         mapl.asm):02632                 BNE     ASI4                              ;INSERT
3264 3520             (         mapl.asm):02633                 PULS    Y                                 ;RESTORE POINTER
3266 35D0             (         mapl.asm):02634                 PULS    X,U,PC                            ;COND CONTINUE
                      (         mapl.asm):02635         ;* INDEXED ASSIGNEMENT TO AN EXISTING VARIABLE
3268                  (         mapl.asm):02636         IASS
3268 17F3AB           (         mapl.asm):02637                 LBSR    DOEXPR                            ;GET ASSIGNMENT VALUE
326B 815B             (         mapl.asm):02638                 CMPA    #'['                              ;TEST FOR PROPER TERMINATION
326D 1026018A         (         mapl.asm):02639                 LBNE    SYNTAX                            ;INDICATE INVALID
3271 7A3CA4           (         mapl.asm):02640                 DEC     ASSFLG                            ;SET LAST OPERATOR
3274 A680             (         mapl.asm):02641                 LDA     ,X+                               ;GET TYPE OF INDEX VALUE
3276 8101             (         mapl.asm):02642                 CMPA    #1                                ;IS IT AN INTEGER VALUE
3278 10260189         (         mapl.asm):02643                 LBNE    DOMAIN                            ;IF NOT, SAY SO
327C 3410             (         mapl.asm):02644                 PSHS    X                                 ;SAVE POINTER TO VALUE
327E 17F21E           (         mapl.asm):02645                 LBSR    SKBK                              ;BACKUP AGAIN
3281 17F287           (         mapl.asm):02646                 LBSR    LOOKUP                            ;FIND VARIABLE
3284 10260178         (         mapl.asm):02647                 LBNE    VALUE                             ;IT'S BAD
3288 8102             (         mapl.asm):02648                 CMPA    #2                                ;IS IT A VARIABLE?
328A 1026016D         (         mapl.asm):02649                 LBNE    SYNTAX                            ;NO, GIVE UP
328E AE85             (         mapl.asm):02650                 LDX     B,X                               ;POINT TO VARIABLE ADDRESS
3290 3540             (         mapl.asm):02651                 PULS    U                                 ;GET INDEX BACK
3292 10BF3C9E         (         mapl.asm):02652                 STY     TXTPTR                            ;SAVE TEXT POINTER
3296 10AEE4           (         mapl.asm):02653                 LDY     ,S                                ;GET SOURCE VALUE
3299 A684             (         mapl.asm):02654                 LDA     ,X                                ;GET TYPE OF VARIABLE
329B A1A0             (         mapl.asm):02655                 CMPA    ,Y+                               ;SAME AS TYPE OF ARGUMENT
329D 266D             (         mapl.asm):02656                 BNE     CDOM                              ;NO, COMPLAIN
329F 7F3C84           (         mapl.asm):02657                 CLR     TEMP                              ;INDICATE SINGLE MODE
32A2 ECA1             (         mapl.asm):02658                 LDD     ,Y++                              ;GET LENGTH OF SOURCE
32A4 10830001         (         mapl.asm):02659                 CMPD    #1                                ;LENGTH ONE IS SPECIAL CASE
32A8 2708             (         mapl.asm):02660                 BEQ     IDA0                              ;IF SO, IT'S OK
32AA 10A3C4           (         mapl.asm):02661                 CMPD    ,U                                ;SAME SIZE AS INDEX
32AD 2656             (         mapl.asm):02662                 BNE     CLEN                              ;INDICATE LENGTH ERROR
32AF 7A3C84           (         mapl.asm):02663                 DEC     TEMP                              ;INDICATE NORMAL MODE
32B2                  (         mapl.asm):02664         IDA0
32B2 ECC1             (         mapl.asm):02665                 LDD     ,U++                              ;GET LENGTH OF INDEX
32B4 274F             (         mapl.asm):02666                 BEQ     CLEN                              ;INDICATE LENGTH ERROR IS ZERO LENGTH INDEX
32B6                  (         mapl.asm):02667         IDA1
32B6 3406             (         mapl.asm):02668                 PSHS    A,B                               ;SAVE IT
32B8 ECC1             (         mapl.asm):02669                 LDD     ,U++                              ;GET INDEX VALUE
32BA B34002           (         mapl.asm):02670                 SUBD    ORIGIN                            ;SET ORIGIN VALUE
32BD 3406             (         mapl.asm):02671                 PSHS    A,B                               ;SAVE IN STACK
32BF EC01             (         mapl.asm):02672                 LDD     1,X                               ;GET LENGTH OF DEST VARIABLE
32C1 830001           (         mapl.asm):02673                 SUBD    #1                                ;CONVERT TO ZERO OFFSET
32C4 A3E1             (         mapl.asm):02674                 SUBD    ,S++                              ;CONVERT OFFSET
32C6 1025FD10         (         mapl.asm):02675                 LBCS    CIDX                              ;INDEX ERROR IF OVER
32CA 6D84             (         mapl.asm):02676                 TST     ,X                                ;CHARACTER INFO?
32CC 2716             (         mapl.asm):02677                 BEQ     IDA2                              ;IF SO, DON'T DOUBLE ADDRESS
32CE 58               (         mapl.asm):02678                 LSLB
32CF 49               (         mapl.asm):02679                 ROLA                                      ;     DOUBLE FOR TWO BYTE ENTRIES
32D0 3440             (         mapl.asm):02680                 PSHS    U                                 ;SAVE Y POINTER
32D2 C30003           (         mapl.asm):02681                 ADDD    #3                                ;OFFSET FOR TYPE AND LENGTH
32D5 338B             (         mapl.asm):02682                 LEAU    D,X                               ;POINT TO OFFSET
32D7 ECA1             (         mapl.asm):02683                 LDD     ,Y++                              ;GET VALUE FROM SOURCE
32D9 EDC4             (         mapl.asm):02684                 STD     ,U                                ;SAVE IN DATA
32DB B63C84           (         mapl.asm):02685                 LDA     TEMP                              ;ADVANCE?
32DE 2616             (         mapl.asm):02686                 BNE     IDA3
32E0 313E             (         mapl.asm):02687                 LEAY    -2,Y                              ;BACKUP
32E2 2012             (         mapl.asm):02688                 BRA     IDA3                              ;END
32E4                  (         mapl.asm):02689         IDA2
32E4 3440             (         mapl.asm):02690                 PSHS    U                                 ;SAVE POINTER
32E6 C30003           (         mapl.asm):02691                 ADDD    #3                                ;OFFSET FOR TYPE AND LENGTH
32E9 338B             (         mapl.asm):02692                 LEAU    D,X                               ;OFFSET TO AREA
32EB A6A0             (         mapl.asm):02693                 LDA     ,Y+                               ;GET CHARACTER
32ED A7C4             (         mapl.asm):02694                 STA     ,U                                ;SAVE BACK
32EF 7D3C84           (         mapl.asm):02695                 TST     TEMP                              ;NORMAL?
32F2 2602             (         mapl.asm):02696                 BNE     IDA3                              ;YES, GOT FOR IT
32F4 313F             (         mapl.asm):02697                 LEAY    -1,Y                              ;BACKUP
32F6                  (         mapl.asm):02698         IDA3
32F6 3540             (         mapl.asm):02699                 PULS    U                                 ;RESTORE POINTER
32F8 3506             (         mapl.asm):02700                 PULS    A,B                               ;RESTORE COUNT
32FA 830001           (         mapl.asm):02701                 SUBD    #1                                ;OVER YET?
32FD 26B7             (         mapl.asm):02702                 BNE     IDA1                              ;NO, GO AGAIN
32FF 10BE3C9E         (         mapl.asm):02703                 LDY     TXTPTR                            ;RESTORE TEXT POINTER
3303 35D0             (         mapl.asm):02704                 PULS    X,U,PC                            ;GO HOME
3305                  (         mapl.asm):02705         CLEN
3305 10BE3C9E         (         mapl.asm):02706                 LDY     TXTPTR
3309 1600FE           (         mapl.asm):02707                 LBRA    LENGTH
330C                  (         mapl.asm):02708         CDOM
330C 10BE3C9E         (         mapl.asm):02709                 LDY     TXTPTR
3310 1600F2           (         mapl.asm):02710                 LBRA    DOMAIN
                      (         mapl.asm):02711         ;*
                      (         mapl.asm):02712         ;* RETURN LENGTH (IN BYTES) OF STRUCTURE(X)
                      (         mapl.asm):02713         ;*
3313                  (         mapl.asm):02714         CALLEN
3313 EC01             (         mapl.asm):02715                 LDD     1,X                               ;GET SHAPE
3315 6D84             (         mapl.asm):02716                 TST     ,X                                ;IS IT CHARACTER
3317 2702             (         mapl.asm):02717                 BEQ     CALL1                             ;YES, DON'T DOUBLE
3319 58               (         mapl.asm):02718                 LSLB
331A 49               (         mapl.asm):02719                 ROLA                                      ;     DOUBLE FOR TWO BYTE ENTRIES
331B                  (         mapl.asm):02720         CALL1
331B C30003           (         mapl.asm):02721                 ADDD    #3                                ;AND IN LENGTH, AND TYPE DATA
331E 39               (         mapl.asm):02722                 RTS
                      (         mapl.asm):02723         ;*
                      (         mapl.asm):02724         ;* INSURE DATA IS IN WORKSPACE
                      (         mapl.asm):02725         ;*
331F                  (         mapl.asm):02726         MVWRK
331F 3460             (         mapl.asm):02727                 PSHS    Y,U                               ;SAVE POINTER
3321 BC3C90           (         mapl.asm):02728                 CMPX    TEMP5                             ;IS IT IN WORKSPACE?
3324 272C             (         mapl.asm):02729                 BEQ     MVRTS                             ;ALL IS OK
3326 FE3C90           (         mapl.asm):02730                 LDU     TEMP5                             ;POINT
3329 A680             (         mapl.asm):02731                 LDA     ,X+                               ;GET POINTER
332B A7C0             (         mapl.asm):02732                 STA     ,U+                               ;SAVE
332D 10AE81           (         mapl.asm):02733                 LDY     ,X++                              ;GET LENGTH
3330 10AFC1           (         mapl.asm):02734                 STY     ,U++                              ;SAVE
3333 4D               (         mapl.asm):02735                 TSTA                                      ;     CHARACTER MOVE?
3334 270E             (         mapl.asm):02736                 BEQ     CHRMV                             ;IF SO, SPECIAL
3336                  (         mapl.asm):02737         MV1
3336 108C0000         (         mapl.asm):02738                 CMPY    #0                                ;ZERO LENGTH?
333A 2716             (         mapl.asm):02739                 BEQ     MVRTS                             ;IF SO, QUIT
333C 313F             (         mapl.asm):02740                 LEAY    -1,Y                              ;BACKUP
333E EC81             (         mapl.asm):02741                 LDD     ,X++                              ;GET FROM SOURCE
3340 EDC1             (         mapl.asm):02742                 STD     ,U++                              ;SAVE
3342 20F2             (         mapl.asm):02743                 BRA     MV1                               ;OK
3344                  (         mapl.asm):02744         CHRMV
3344 108C0000         (         mapl.asm):02745                 CMPY    #0                                ;ZERO LENGTH?
3348 2708             (         mapl.asm):02746                 BEQ     MVRTS                             ;IF SO, QUIT
334A 313F             (         mapl.asm):02747                 LEAY    -1,Y                              ;BACKUP
334C EC80             (         mapl.asm):02748                 LDD     ,X+                               ;GET CHAR
334E EDC0             (         mapl.asm):02749                 STD     ,U+                               ;SAVE CHAR
3350 20F2             (         mapl.asm):02750                 BRA     CHRMV                             ;OK
3352                  (         mapl.asm):02751         MVRTS
3352 BE3C90           (         mapl.asm):02752                 LDX     TEMP5                             ;POINT TO SPACE
3355 35E0             (         mapl.asm):02753                 PULS    Y,U,PC                            ;HOME
                      (         mapl.asm):02754         ;*
                      (         mapl.asm):02755         ;* LOOK UP AND EXECUTE COMMAND
                      (         mapl.asm):02756         ;*
3357                  (         mapl.asm):02757         CLOOK
3357 3420             (         mapl.asm):02758                 PSHS    Y                                 ;SAVE COMMAND POINTER
3359                  (         mapl.asm):02759         CL5
3359 A680             (         mapl.asm):02760                 LDA     ,X+                               ;GET CHARACTER FROM TABLE
335B 2B0E             (         mapl.asm):02761                 BMI     CCHK                              ;LAST ONE, CHECK IT
335D A1A0             (         mapl.asm):02762                 CMPA    ,Y+                               ;DOES IT MATCH?
335F 27F8             (         mapl.asm):02763                 BEQ     CL5                               ;YES, KEEP LOOKING
3361                  (         mapl.asm):02764         CL2
3361 A680             (         mapl.asm):02765                 LDA     ,X+                               ;GET NEXT
3363 2AFC             (         mapl.asm):02766                 BPL     CL2                               ;LOOK FOR END
3365                  (         mapl.asm):02767         CL3
3365 3002             (         mapl.asm):02768                 LEAX    2,X                               ;SKIP ADDRESS
3367 3520             (         mapl.asm):02769                 PULS    Y                                 ;RESTORE POINTER
3369 20EC             (         mapl.asm):02770                 BRA     CLOOK                             ;AND GO AGAIN
336B                  (         mapl.asm):02771         CCHK
336B 847F             (         mapl.asm):02772                 ANDA    #$7F                              ;REMOVE HIGH BIT
336D 2704             (         mapl.asm):02773                 BEQ     CL4                               ;END OF TABLE
336F A1A0             (         mapl.asm):02774                 CMPA    ,Y+                               ;IS IT SAME AS FROM BUFFER?
3371 26F2             (         mapl.asm):02775                 BNE     CL3                               ;NO, GO AGAIN
3373                  (         mapl.asm):02776         CL4
3373 3262             (         mapl.asm):02777                 LEAS    2,S                               ;CLEAN UP STACK
3375 17F10B           (         mapl.asm):02778                 LBSR    SKP                               ;ADVANCE TO PARAMETERS
3378 6E94             (         mapl.asm):02779                 JMP     [,X]                              ;EXECUTE CODE
                      (         mapl.asm):02780         ;*
                      (         mapl.asm):02781         ;* ERROR MESSAGES
                      (         mapl.asm):02782         ;*
337A                  (         mapl.asm):02783         SYMSG
337A 53594E54415800   (         mapl.asm):02784                 FCN     'SYNTAX'
3381                  (         mapl.asm):02785         VALMSG
3381 56414C554500     (         mapl.asm):02786                 FCN     'VALUE'
3387                  (         mapl.asm):02787         DOMMSG
3387 444F4D41494E00   (         mapl.asm):02788                 FCN     'DOMAIN'
338E                  (         mapl.asm):02789         LENMSG
338E 4C454E47544800   (         mapl.asm):02790                 FCN     'LENGTH'
3395                  (         mapl.asm):02791         INDMSG
3395 494E44455800     (         mapl.asm):02792                 FCN     'INDEX'
339B                  (         mapl.asm):02793         BRKMSG
339B 494E544552525550 (         mapl.asm):02794                 FCC     'INTERRUPT'
     54
33A4 0D               (         mapl.asm):02795                 FCB     $0D
                      (         mapl.asm):02796         ;*
                      (         mapl.asm):02797         ;* ERROR HANDLERS
                      (         mapl.asm):02798         ;*
33A5                  (         mapl.asm):02799         REBRK
33A5 FC3CA2           (         mapl.asm):02800                 LDD     RAMTOP                            ;GET BUFFER ADRESS
33A8 FD3C90           (         mapl.asm):02801                 STD     TEMP5                             ;RESAVE
33AB 10FE3CA6         (         mapl.asm):02802                 LDS     INPSTK                            ;GET INPUT STACK
33AF 3526             (         mapl.asm):02803                 PULS    A,B,Y                             ;GET VALUES BACK
33B1 FD3CA6           (         mapl.asm):02804                 STD     INPSTK                            ;SAVE INPUT FLAG
33B4 10BF3CA0         (         mapl.asm):02805                 STY     SAVSTK                            ;RESAVE STACK
33B8 3526             (         mapl.asm):02806                 PULS    A,B,Y                             ;GET MORE
33BA FD3C94           (         mapl.asm):02807                 STD     PARM                              ;SAVE PARM POINTER
33BD 10BF3C98         (         mapl.asm):02808                 STY     GOTO                              ;SAVE GOTO FLAG
33C1 3526             (         mapl.asm):02809                 PULS    A,B,Y                             ;GET LINCT AND NAMPTR
33C3 FD3C96           (         mapl.asm):02810                 STD     LINCT                             ;SAVE LINE COUNT
33C6 10BF3C9A         (         mapl.asm):02811                 STY     NAMPTR                            ;RESAVE
33CA 3526             (         mapl.asm):02812                 PULS    A,B,Y                             ;GET TOP OF RAM
33CC FD3CA2           (         mapl.asm):02813                 STD     RAMTOP                            ;AND RESAVE
33CF                  (         mapl.asm):02814         BREAK
33CF FC3CA6           (         mapl.asm):02815                 LDD     INPSTK                            ;ARE WE INPUTTING?
33D2 26D1             (         mapl.asm):02816                 BNE     REBRK                             ;YES, FIX IT UP
33D4 B63C83           (         mapl.asm):02817                 LDA     EXEC                              ;EXECUTING FUNCTION?
33D7 270D             (         mapl.asm):02818                 BEQ     BRK0                              ;OK TO DISPLAY
33D9 A69F3C9A         (         mapl.asm):02819                 LDA     [NAMPTR]        GET TYPE BITS
33DD 8420             (         mapl.asm):02820                 ANDA    #$20                              ;IS IT LOCKED
33DF 2705             (         mapl.asm):02821                 BEQ     BRK0                              ;NO, IT'S OK
33E1 1704AB           (         mapl.asm):02822                 LBSR    RELEAS                            ;RELEASE THIS ONE
33E4 20E9             (         mapl.asm):02823                 BRA     BREAK                             ;ALWAYS A DOMAIN ERROR
33E6                  (         mapl.asm):02824         BRK0
33E6 8E339B           (         mapl.asm):02825                 LDX     #BRKMSG                           ;DISPLAY
33E9 17EF9E           (         mapl.asm):02826                 LBSR    OULI                              ;DISPLAY
33EC 2048             (         mapl.asm):02827                 BRA     ERR0                              ;AND CONTINUE
                      (         mapl.asm):02828         ;* WORKSACE IS FULL
33EE                  (         mapl.asm):02829         WSFUL
33EE 17F075           (         mapl.asm):02830                 LBSR    SYSMSG                            ;DISPLAY MESSAGE
33F1 57532046554C4C00 (         mapl.asm):02831                 FCN     'WS FULL'
33F9 203B             (         mapl.asm):02832                 BRA     ERR0                              ;CONTINUE
33FB                  (         mapl.asm):02833         SYNTAX
33FB 8E337A           (         mapl.asm):02834                 LDX     #SYMSG
33FE 2012             (         mapl.asm):02835                 BRA     ERROR
3400                  (         mapl.asm):02836         VALUE
3400 8E3381           (         mapl.asm):02837                 LDX     #VALMSG
3403 200D             (         mapl.asm):02838                 BRA     ERROR
3405                  (         mapl.asm):02839         DOMAIN
3405 8E3387           (         mapl.asm):02840                 LDX     #DOMMSG
3408 2008             (         mapl.asm):02841                 BRA     ERROR
340A                  (         mapl.asm):02842         LENGTH
340A 8E338E           (         mapl.asm):02843                 LDX     #LENMSG
340D 2003             (         mapl.asm):02844                 BRA     ERROR
340F                  (         mapl.asm):02845         INDEX
340F 8E3395           (         mapl.asm):02846                 LDX     #INDMSG
3412                  (         mapl.asm):02847         ERROR
3412 B63C83           (         mapl.asm):02848                 LDA     EXEC                              ;EXECUTING FUNCTION?
3415 2712             (         mapl.asm):02849                 BEQ     OKDISP                            ;OK TO DISPLAY
3417 A69F3C9A         (         mapl.asm):02850                 LDA     [NAMPTR]        GET TYPE BITS
341B 8420             (         mapl.asm):02851                 ANDA    #$20                              ;IS IT LOCKED
341D 270A             (         mapl.asm):02852                 BEQ     OKDISP                            ;NO, IT'S OK
341F FC3CA6           (         mapl.asm):02853                 LDD     INPSTK                            ;INPUTTING?
3422 2605             (         mapl.asm):02854                 BNE     OKDISP                            ;CONTINUE
3424 170468           (         mapl.asm):02855                 LBSR    RELEAS                            ;RELEASE THIS ONE
3427 20DC             (         mapl.asm):02856                 BRA     DOMAIN                            ;ALWAYS A DOMAIN ERROR
3429                  (         mapl.asm):02857         OKDISP
3429 17EF5E           (         mapl.asm):02858                 LBSR    OULI                              ;DISPLAY MESSAGE
342C 17F037           (         mapl.asm):02859                 LBSR    SYSMSG
342F 204552524F5200   (         mapl.asm):02860                 FCN     ' ERROR'
3436                  (         mapl.asm):02861         ERR0
3436 B63C83           (         mapl.asm):02862                 LDA     EXEC                              ;EXECUTING FUNCTION?
3439 2711             (         mapl.asm):02863                 BEQ     ERR01                             ;NO
343B BE3C9A           (         mapl.asm):02864                 LDX     NAMPTR                            ;POINT TO ENTRY
343E FC3C96           (         mapl.asm):02865                 LDD     LINCT                             ;GET LINE COUNTER
3441 17003F           (         mapl.asm):02866                 LBSR    DSPNAM                            ;DISPLAY IT
3444 17F02B           (         mapl.asm):02867                 LBSR    LFCR                              ;NEW LINE
3447 FC3C96           (         mapl.asm):02868                 LDD     LINCT                             ;LINE ZERO?
344A 272A             (         mapl.asm):02869                 BEQ     ERR9
344C                  (         mapl.asm):02870         ERR01
344C 5F               (         mapl.asm):02871                 CLRB                                      ;     START WITH ZERO OFFSET
344D                  (         mapl.asm):02872         ERR1
344D A6A4             (         mapl.asm):02873                 LDA     ,Y                                ;GET CHARACTER FROM Y REGISTER
344F 810D             (         mapl.asm):02874                 CMPA    #$0D                              ;END OF LINE?
3451 2705             (         mapl.asm):02875                 BEQ     ERR5                              ;IF SO, TOO BAD
3453 5C               (         mapl.asm):02876                 INCB                                      ;     ADVANCE
3454 313F             (         mapl.asm):02877                 LEAY    -1,Y                              ;AND BACKUP IN LINE
3456 20F5             (         mapl.asm):02878                 BRA     ERR1                              ;CONTINUE
3458                  (         mapl.asm):02879         ERR5
3458 3121             (         mapl.asm):02880                 LEAY    1,Y                               ;BACK TO BEFORE CR
345A                  (         mapl.asm):02881         ERR2
345A A6A0             (         mapl.asm):02882                 LDA     ,Y+                               ;GET CHARACTER
345C 17F019           (         mapl.asm):02883                 LBSR    PUTCHR                            ;DISPLAY
345F 810A             (         mapl.asm):02884                 CMPA    #$0A                              ;END OF LINE?
3461 26F7             (         mapl.asm):02885                 BNE     ERR2                              ;NO, KEEP GOING
3463 5D               (         mapl.asm):02886                 TSTB                                      ;     CHECK FOR OVER
3464 2708             (         mapl.asm):02887                 BEQ     ERR4                              ;ALL DONE
3466                  (         mapl.asm):02888         ERR3
3466 5A               (         mapl.asm):02889                 DECB                                      ;     REDUCE COUNT
3467 2705             (         mapl.asm):02890                 BEQ     ERR4                              ;OK
3469 17F013           (         mapl.asm):02891                 LBSR    SPACE                             ;SPACE OVER
346C 20F8             (         mapl.asm):02892                 BRA     ERR3                              ;TILL WE ARE UNDER IT
346E                  (         mapl.asm):02893         ERR4
346E 865E             (         mapl.asm):02894                 LDA     #'^'                              ;GET ERROR MARK
3470 17F005           (         mapl.asm):02895                 LBSR    PUTCHR                            ;DISPLAY
3473 17EFFC           (         mapl.asm):02896                 LBSR    LFCR                              ;NEW LINE
3476                  (         mapl.asm):02897         ERR9
3476 7A3CA5           (         mapl.asm):02898                 DEC     ERRFLG                            ;INDICATE ERROR HAPPENED
3479 FC3CA6           (         mapl.asm):02899                 LDD     INPSTK                            ;ARE WE INPUTTING
347C 1026FCDF         (         mapl.asm):02900                 LBNE    INNP3                             ;IF SO, RECOVER
3480 16EBFD           (         mapl.asm):02901                 LBRA    CMD                               ;ENTER COMMAND MODE
                      (         mapl.asm):02902         ;* DISPLAY NAME OF FUNCTION, A,B= LINE NUMBER, X= NAME POINTER
3483                  (         mapl.asm):02903         DSPNAM
3483 3406             (         mapl.asm):02904                 PSHS    A,B                               ;SAVE REGS
3485 E680             (         mapl.asm):02905                 LDB     ,X+                               ;GET LENGTH OF NAME
3487 C41F             (         mapl.asm):02906                 ANDB    #$1F                              ;MASKOFF SHIT
3489                  (         mapl.asm):02907         ERRP
3489 A685             (         mapl.asm):02908                 LDA     B,X                               ;GET CHARACTER
348B 17EFEA           (         mapl.asm):02909                 LBSR    PUTCHR                            ;DISPLAY
348E 5A               (         mapl.asm):02910                 DECB                                      ;     REDUCE COUNT
348F 26F8             (         mapl.asm):02911                 BNE     ERRP                              ;KEEP GOING
3491 865B             (         mapl.asm):02912                 LDA     #'['                              ;START
3493 17EFE2           (         mapl.asm):02913                 LBSR    PUTCHR                            ;DISPLAY
3496 3506             (         mapl.asm):02914                 PULS    A,B                               ;RESTORE IT
3498 17FA63           (         mapl.asm):02915                 LBSR    DECOUT                            ;DISPLAY
349B 865D             (         mapl.asm):02916                 LDA     #']'                              ;CLOSING BRACE
349D 16EFD8           (         mapl.asm):02917                 LBRA    PUTCHR                            ;DISPLAY
                      (         mapl.asm):02918         ;*
                      (         mapl.asm):02919         ;* START A FUNCTION
                      (         mapl.asm):02920         ;*
34A0                  (         mapl.asm):02921         FUNC
34A0 3420             (         mapl.asm):02922                 PSHS    Y                                 ;SAVE TEXT POINTER
34A2 10BE3CA2         (         mapl.asm):02923                 LDY     RAMTOP                            ;GET TOP OF FREE RAM
34A6 3420             (         mapl.asm):02924                 PSHS    Y                                 ;RESAVE
34A8 10BE3C9A         (         mapl.asm):02925                 LDY     NAMPTR                            ;GET NAME POINTER
34AC 3420             (         mapl.asm):02926                 PSHS    Y                                 ;SAVE
34AE BF3C9A           (         mapl.asm):02927                 STX     NAMPTR                            ;SAVE OUR NAME
34B1 10AE85           (         mapl.asm):02928                 LDY     B,X                               ;GET TEXT POINTER
34B4 BE3C96           (         mapl.asm):02929                 LDX     LINCT                             ;GET LINE COUNTER
34B7 FC3C98           (         mapl.asm):02930                 LDD     GOTO                              ;GET GOTO POINTER
34BA 3416             (         mapl.asm):02931                 PSHS    A,B,X                             ;SAVE
34BC BE3C94           (         mapl.asm):02932                 LDX     PARM                              ;SAVE OUT GOTO VALUE
34BF FC3CA0           (         mapl.asm):02933                 LDD     SAVSTK                            ;GET SAVED STACK VALUE
34C2 3416             (         mapl.asm):02934                 PSHS    A,B,X                             ;SAVE
34C4 FC3C84           (         mapl.asm):02935                 LDD     TEMP                              ;GET TEMPORARY STORAGE
34C7 FD3C94           (         mapl.asm):02936                 STD     PARM                              ;SAVE PARAMETER
34CA 4F               (         mapl.asm):02937                 CLRA                                      ;     CLEAR IT
34CB 5F               (         mapl.asm):02938                 CLRB                                      ;     START WITH LINE #0
34CC FD3C96           (         mapl.asm):02939                 STD     LINCT                             ;SET LINE NUMBER
34CF FD3C98           (         mapl.asm):02940                 STD     GOTO                              ;SAVE WHERE WE WANT TO GO
34D2 3420             (         mapl.asm):02941                 PSHS    Y                                 ;SAVE POINTER TO LOCAL SYMBOLS
34D4 7C3C82           (         mapl.asm):02942                 INC     LEVEL                             ;DOWN ANOTHER LEVEL
34D7 7C3C83           (         mapl.asm):02943                 INC     EXEC                              ;EXECUTING
34DA 10FF3CA0         (         mapl.asm):02944                 STS     SAVSTK                            ;SAVE STACK
34DE FC3C90           (         mapl.asm):02945                 LDD     TEMP5                             ;GET TOP OF FREE RAM
34E1 FD3CA2           (         mapl.asm):02946                 STD     RAMTOP                            ;SET IT UP
                      (         mapl.asm):02947         ;* FIX UP FOR LOCAL SYMBOLS
34E4                  (         mapl.asm):02948         LCVAR
34E4 17EFA7           (         mapl.asm):02949                 LBSR    SKIP                              ;ADVANCE TO NEXT
34E7 810D             (         mapl.asm):02950                 CMPA    #$0D                              ;END OF LINE?
34E9 271B             (         mapl.asm):02951                 BEQ     FNGO                              ;GO AHEAD
34EB 813B             (         mapl.asm):02952                 CMPA    #';'                              ;SEMI?
34ED 1026FF0A         (         mapl.asm):02953                 LBNE    SYNTAX                            ;INDICATE SYNTAX ERROR
34F1 17EFC1           (         mapl.asm):02954                 LBSR    SFSYM                             ;ADVANCE
34F4 3420             (         mapl.asm):02955                 PSHS    Y                                 ;SAVE
34F6 313F             (         mapl.asm):02956                 LEAY    -1,Y                              ;BACK TO SYMBOL
34F8 17F010           (         mapl.asm):02957                 LBSR    LOOKUP                            ;LOOK FOR IT
34FB 2605             (         mapl.asm):02958                 BNE     LCV1                              ;DON'T ZAP IF NOT THERE
34FD B63C82           (         mapl.asm):02959                 LDA     LEVEL                             ;GET OUR LEVEL
3500 A701             (         mapl.asm):02960                 STA     1,X                               ;INDICATE THAT IT IS NESTED
3502                  (         mapl.asm):02961         LCV1
3502 3520             (         mapl.asm):02962                 PULS    Y                                 ;RESTORE Y REG
3504 20DE             (         mapl.asm):02963                 BRA     LCVAR                             ;AND GO AGAIN
                      (         mapl.asm):02964         ;* CREATE LABEL ENTRIES IN SYMBOL TABLE
3506                  (         mapl.asm):02965         FNGO
3506 CE0000           (         mapl.asm):02966                 LDU     #0
3509                  (         mapl.asm):02967         FUNGT
3509 A6A0             (         mapl.asm):02968                 LDA     ,Y+                               ;GET CHAR FROM LINE
350B 2B2D             (         mapl.asm):02969                 BMI     FNGOX                             ;END OF FILE, QUIT
350D 810D             (         mapl.asm):02970                 CMPA    #$0D                              ;LOOK FOR CARRAGE RETURN
350F 26F8             (         mapl.asm):02971                 BNE     FUNGT                             ;LOOK TILL WE FIND
3511 3341             (         mapl.asm):02972                 LEAU    1,U                               ;ADVANCE
3513 17EF9F           (         mapl.asm):02973                 LBSR    SFSYM                             ;SKIP FORWARD
3516 27F1             (         mapl.asm):02974                 BEQ     FUNGT                             ;NO SYMBOL, GET UPSET
3518 813A             (         mapl.asm):02975                 CMPA    #':'                              ;LABEL?
351A 26ED             (         mapl.asm):02976                 BNE     FUNGT                             ;NO, SKIP IT
351C 3420             (         mapl.asm):02977                 PSHS    Y                                 ;SAVE POINTER
351E 313F             (         mapl.asm):02978                 LEAY    -1,Y                              ;BACKUP
3520 17EFE8           (         mapl.asm):02979                 LBSR    LOOKUP                            ;DOES IT EXIST?
3523 2605             (         mapl.asm):02980                 BNE     FNGOZ                             ;NO, DON'T SAVE IT
3525 B63C82           (         mapl.asm):02981                 LDA     LEVEL                             ;GET LEVEL
3528 A701             (         mapl.asm):02982                 STA     1,X                               ;SAVE IT
352A                  (         mapl.asm):02983         FNGOZ
352A 10AEE4           (         mapl.asm):02984                 LDY     ,S                                ;GET POINTER BACK
352D 313F             (         mapl.asm):02985                 LEAY    -1,Y                              ;BACKUP
352F 8603             (         mapl.asm):02986                 LDA     #3                                ;INDICATE LABEL
3531 17F020           (         mapl.asm):02987                 LBSR    CRESYM                            ;SAVE IT
3534 EF84             (         mapl.asm):02988                 STU     ,X                                ;SAVE LINE NUMBER
3536 3520             (         mapl.asm):02989                 PULS    Y                                 ;RESTORE Y
3538 20CF             (         mapl.asm):02990                 BRA     FUNGT                             ;CONTINUE
353A                  (         mapl.asm):02991         FNGOX
353A 8E3A3E           (         mapl.asm):02992                 LDX     #IOTA0                            ;POINT TO EMPTY VECTOR FOR DEFAULT RETURN
353D 10AEE4           (         mapl.asm):02993                 LDY     ,S                                ;GET TEXT POINTER
                      (         mapl.asm):02994         ;* START IT UP
3540                  (         mapl.asm):02995         FNXLIN
3540 A6A0             (         mapl.asm):02996                 LDA     ,Y+                               ;ADVANCE TO NEXT
3542 810D             (         mapl.asm):02997                 CMPA    #$0D                              ;END OF LINE?
3544 26FA             (         mapl.asm):02998                 BNE     FNXLIN                            ;CONTINUE
3546 FC3C98           (         mapl.asm):02999                 LDD     GOTO                              ;IS THIS WEHERE WE WANT TO GO?
3549 2710             (         mapl.asm):03000                 BEQ     GOTOK                             ;GOTO IS OK
354B 3410             (         mapl.asm):03001                 PSHS    X                                 ;SAVE X
354D AE62             (         mapl.asm):03002                 LDX     2,S                               ;GET TEXT ADRESS
354F 17EE47           (         mapl.asm):03003                 LBSR    FNDL1                             ;LOCATE THE LINE
3552 1F12             (         mapl.asm):03004                 TFR     X,Y                               ;COPY BACK
3554 3510             (         mapl.asm):03005                 PULS    X                                 ;RESTORE X
3556 FC3C8C           (         mapl.asm):03006                 LDD     TEMP3                             ;GET LINE NUMBER
3559 2006             (         mapl.asm):03007                 BRA     GOT1
355B                  (         mapl.asm):03008         GOTOK
355B FC3C96           (         mapl.asm):03009                 LDD     LINCT                             ;GET LINE COUNTER
355E C30001           (         mapl.asm):03010                 ADDD    #1                                ;ADVANCE
3561                  (         mapl.asm):03011         GOT1
3561 FD3C96           (         mapl.asm):03012                 STD     LINCT                             ;RESAVE
3564 4F               (         mapl.asm):03013                 CLRA
3565 5F               (         mapl.asm):03014                 CLRB
3566 FD3C98           (         mapl.asm):03015                 STD     GOTO                              ;RESET GOTO FLAG
3569 A6A4             (         mapl.asm):03016                 LDA     ,Y                                ;GET NEXT CHARACTER
356B 81FF             (         mapl.asm):03017                 CMPA    #$FF                              ;END OF FUNCTION?
356D 2711             (         mapl.asm):03018                 BEQ     EFUNC                             ;NO, GO AGAIN
356F 812A             (         mapl.asm):03019                 CMPA    #'*'                              ;COMMENT?
3571 27CD             (         mapl.asm):03020                 BEQ     FNXLIN                            ;GO TO NEXT LINE
3573 3F               (         mapl.asm):03021                 SWI
3574 23               (         mapl.asm):03022                 FCB     35                                ;LOOK FOR KEYBOARD KEY
3575 8103             (         mapl.asm):03023                 CMPA    #$03                              ;CONTROL C?
3577 1027FE54         (         mapl.asm):03024                 LBEQ    BREAK                             ;INTERRUPT PROGRAM
357B                  (         mapl.asm):03025         NOINT1
357B 17F06F           (         mapl.asm):03026                 LBSR    EXPR                              ;EXECUTE
357E 20C0             (         mapl.asm):03027                 BRA     FNXLIN
                      (         mapl.asm):03028         ;* END OF A FUNCTION
3580                  (         mapl.asm):03029         EFUNC
3580 3520             (         mapl.asm):03030                 PULS    Y                                 ;GET POINTER BACK
3582 3410             (         mapl.asm):03031                 PSHS    X                                 ;SAVE IT
3584                  (         mapl.asm):03032         EFUN1
3584 17EF07           (         mapl.asm):03033                 LBSR    SKIP                              ;LOOK FOR IT
3587 810D             (         mapl.asm):03034                 CMPA    #$0D                              ;END?
3589 2713             (         mapl.asm):03035                 BEQ     EFUPOT                            ;IF SO, EXIT
358B 17EF27           (         mapl.asm):03036                 LBSR    SFSYM                             ;SKIP TO END
358E 3420             (         mapl.asm):03037                 PSHS    Y                                 ;SAVE IT
3590 313F             (         mapl.asm):03038                 LEAY    -1,Y                              ;BACKUP
3592 17EF76           (         mapl.asm):03039                 LBSR    LOOKUP                            ;LOOK FOR IT
3595 2603             (         mapl.asm):03040                 BNE     EFUN3                             ;NOT FOUND
3597 170243           (         mapl.asm):03041                 LBSR    ERASYM                            ;ERASE IT
359A                  (         mapl.asm):03042         EFUN3
359A 3520             (         mapl.asm):03043                 PULS    Y                                 ;RESTORE POINTER
359C 20E6             (         mapl.asm):03044                 BRA     EFUN1                             ;AND GO AGAIN
359E                  (         mapl.asm):03045         EFUPOT
359E A6A0             (         mapl.asm):03046                 LDA     ,Y+                               ;GET CHAR
35A0 2B1D             (         mapl.asm):03047                 BMI     EFUN2                             ;END, QUIT
35A2 810D             (         mapl.asm):03048                 CMPA    #$0D                              ;END OF LINE?
35A4 26F8             (         mapl.asm):03049                 BNE     EFUPOT                            ;GO
35A6 17EF0C           (         mapl.asm):03050                 LBSR    SFSYM                             ;SCAN FOR SYMBOL
35A9 27F3             (         mapl.asm):03051                 BEQ     EFUPOT                            ;NONE, SKIP IT
35AB 813A             (         mapl.asm):03052                 CMPA    #':'                              ;IS IT LOCAL LABEL?
35AD 26EF             (         mapl.asm):03053                 BNE     EFUPOT                            ;NO, SKIP IT
35AF 3420             (         mapl.asm):03054                 PSHS    Y                                 ;SAVE IT
35B1 313F             (         mapl.asm):03055                 LEAY    -1,Y                              ;BACKUP
35B3 17EF55           (         mapl.asm):03056                 LBSR    LOOKUP                            ;LOOK FOR IT
35B6 2603             (         mapl.asm):03057                 BNE     NOFUNE                            ;DON'T ERASE
35B8 170222           (         mapl.asm):03058                 LBSR    ERASYM                            ;ERASE IT
35BB                  (         mapl.asm):03059         NOFUNE
35BB 3520             (         mapl.asm):03060                 PULS    Y                                 ;RESTORE Y
35BD 20DF             (         mapl.asm):03061                 BRA     EFUPOT                            ;CONTINUE
                      (         mapl.asm):03062         ;* REPLACE SMUDGED VARIABLES
35BF                  (         mapl.asm):03063         EFUN2
35BF 8E400A           (         mapl.asm):03064                 LDX     #SYMTAB                           ;POINT TO SYMBOL TABLE
35C2 B63C82           (         mapl.asm):03065                 LDA     LEVEL                             ;GET OUR LEVEL
35C5                  (         mapl.asm):03066         EFUN4
35C5 E684             (         mapl.asm):03067                 LDB     ,X                                ;GET TYPE BYTE
35C7 C41F             (         mapl.asm):03068                 ANDB    #$1F                              ;MASK GARBAGE
35C9 270B             (         mapl.asm):03069                 BEQ     EFUN5                             ;END OF TABLE
35CB A101             (         mapl.asm):03070                 CMPA    1,X                               ;IS THIS ONE WE NESTED?
35CD 2602             (         mapl.asm):03071                 BNE     EFUN6                             ;NO, SKIP IT
35CF 6F01             (         mapl.asm):03072                 CLR     1,X                               ;RELEASE IT
35D1                  (         mapl.asm):03073         EFUN6
35D1 CB04             (         mapl.asm):03074                 ADDB    #4                                ;ADVANCE EXTRA BYTES
35D3 3A               (         mapl.asm):03075                 ABX                                       ;     SKIP AHEAD
35D4 20EF             (         mapl.asm):03076                 BRA     EFUN4                             ;GO IT AGAIN
35D6                  (         mapl.asm):03077         EFUN5
35D6 3510             (         mapl.asm):03078                 PULS    X                                 ;RESTORE REGISTERS
35D8 3526             (         mapl.asm):03079                 PULS    A,B,Y                             ;RESTORE PARAMETER ADDRESS
35DA FD3CA0           (         mapl.asm):03080                 STD     SAVSTK                            ;REPLACE SAVED STACK POINTER
35DD 10BF3C94         (         mapl.asm):03081                 STY     PARM                              ;SET PARAMETER VALUE
35E1 3526             (         mapl.asm):03082                 PULS    A,B,Y                             ;RESTORE NAME POINTER
35E3 FD3C98           (         mapl.asm):03083                 STD     GOTO                              ;SAVE
35E6 10BF3C96         (         mapl.asm):03084                 STY     LINCT                             ;SAVE LINE COUNTER
35EA 3526             (         mapl.asm):03085                 PULS    A,B,Y                             ;RESTORE VARIABLES
35EC FD3C9A           (         mapl.asm):03086                 STD     NAMPTR                            ;RESET LINE COUNTER
35EF 10BF3CA2         (         mapl.asm):03087                 STY     RAMTOP                            ;SET BUFFER ADDRESS
35F3 7A3C82           (         mapl.asm):03088                 DEC     LEVEL                             ;RESET MODE
35F6 7A3C83           (         mapl.asm):03089                 DEC     EXEC                              ;RELEASE EXECUTION FLAG
35F9 7F3CA4           (         mapl.asm):03090                 CLR     ASSFLG                            ;NO ASSIGNMENT
35FC 35A0             (         mapl.asm):03091                 PULS    Y,PC                              ;BACKUP AND RETURN
                      (         mapl.asm):03092         ;*
                      (         mapl.asm):03093         ;* SYSTEM COMMAND DEFINTIONS
                      (         mapl.asm):03094         ;*
                      (         mapl.asm):03095         ;* CONTINUE COMMAND
35FE                  (         mapl.asm):03096         CONCMD
35FE 108E3A4C         (         mapl.asm):03097                 LDY     #CONTIN                           ;POINT AT FILENAME
3602 170175           (         mapl.asm):03098                 LBSR    SAV5                              ;PERFORM SAVE
                      (         mapl.asm):03099         ;* ')OFF' COMMAND
3605                  (         mapl.asm):03100         OFF
3605 4F               (         mapl.asm):03101                 CLRA                                      ;     INDICATE MESSAGES
3606 3F               (         mapl.asm):03102                 SWI
3607 68               (         mapl.asm):03103                 FCB     104                               ;WITH DOS COMMAND
3608 4F               (         mapl.asm):03104                 CLRA                                      ;     SET ZERO RC
3609 3F               (         mapl.asm):03105                 SWI
360A 00               (         mapl.asm):03106                 FCB     0                                 ;RETURN TO OS
                      (         mapl.asm):03107         ;* ')LBLS' COMMAND
360B                  (         mapl.asm):03108         LBLS
360B 8660             (         mapl.asm):03109                 LDA     #$60                              ;GET TYPE
360D B73C84           (         mapl.asm):03110                 STA     TEMP                              ;SAVE IT
3610 2005             (         mapl.asm):03111                 BRA     FNST1                             ;SAVE SINGLE TYPE LIST
                      (         mapl.asm):03112         ;* ')VARS' COMMAND
3612                  (         mapl.asm):03113         VARS
3612 8640             (         mapl.asm):03114                 LDA     #$40                              ;INDICATE LOOKING FOR VARIABLES
3614 B73C84           (         mapl.asm):03115                 STA     TEMP                              ;SET INDICATOR
3617                  (         mapl.asm):03116         FNST1
3617 86E0             (         mapl.asm):03117                 LDA     #$E0                              ;SET MASK
3619 2005             (         mapl.asm):03118                 BRA     SRCSY                             ;SEARCH SYMBOL TABLE
                      (         mapl.asm):03119         ;* ')FNS' COMMAND
361B                  (         mapl.asm):03120         FNS
361B 7F3C84           (         mapl.asm):03121                 CLR     TEMP                              ;INDICATE LOOKING FOR FUNCTIONS
361E 86C0             (         mapl.asm):03122                 LDA     #$C0                              ;PROPER MASK
3620                  (         mapl.asm):03123         SRCSY
3620 B73C85           (         mapl.asm):03124                 STA     TEMP+1                            ;SAVE IN LOCATION
3623 86FF             (         mapl.asm):03125                 LDA     #$FF                              ;GET END OF TABLE POINTER
3625 A79F4000         (         mapl.asm):03126                 STA     [FREE]                            ;INITIALIZE WORKSPACE
3629 8E400A           (         mapl.asm):03127                 LDX     #SYMTAB                           ;POINT TO TABLE
362C                  (         mapl.asm):03128         FNS1
362C E680             (         mapl.asm):03129                 LDB     ,X+                               ;GET LENGTH
362E 1F98             (         mapl.asm):03130                 TFR     B,A                               ;SAVE FOR TYPE REFERENCE
3630 C41F             (         mapl.asm):03131                 ANDB    #$1F                              ;REMOVE TYPE INFO
3632 2754             (         mapl.asm):03132                 BEQ     FNS4                              ;QUIT IF END
3634 B43C85           (         mapl.asm):03133                 ANDA    TEMP+1                            ;MASK OFF TYPE INFO
3637 B13C84           (         mapl.asm):03134                 CMPA    TEMP                              ;DOES IT MATCH?
363A 2643             (         mapl.asm):03135                 BNE     FNS3                              ;NO, SKIP IT
363C 10BE4000         (         mapl.asm):03136                 LDY     FREE                              ;POINT TO WORK SPACE
3640                  (         mapl.asm):03137         INW0
3640 3424             (         mapl.asm):03138                 PSHS    B,Y                               ;SAVE WRKSPC POINTER
3642 A6A4             (         mapl.asm):03139                 LDA     ,Y                                ;IS THIS THE END?
3644 81FF             (         mapl.asm):03140                 CMPA    #$FF                              ;END OF TABLE?
3646 2717             (         mapl.asm):03141                 BEQ     INW2                              ;PUT IT HERE
3648                  (         mapl.asm):03142         INW1
3648 A6A0             (         mapl.asm):03143                 LDA     ,Y+                               ;GET CHARCTER FROM TABLE
364A 270B             (         mapl.asm):03144                 BEQ     INW3                              ;DON'T PUT IT HERE
364C A185             (         mapl.asm):03145                 CMPA    B,X                               ;ARE WE OVER
364E 2507             (         mapl.asm):03146                 BLO     INW3                              ;DON'T PUT IT HERE
3650 220D             (         mapl.asm):03147                 BHI     INW2                              ;YES, GO FOR IT
3652 5A               (         mapl.asm):03148                 DECB                                      ;     BACKUP
3653 26F3             (         mapl.asm):03149                 BNE     INW1                              ;KEEP GOING TILL DONE
3655 2008             (         mapl.asm):03150                 BRA     INW2                              ;INSERT IT HERE
3657                  (         mapl.asm):03151         INW3
3657 3524             (         mapl.asm):03152                 PULS    B,Y                               ;RESTORE
3659                  (         mapl.asm):03153         INW5
3659 A6A0             (         mapl.asm):03154                 LDA     ,Y+                               ;ADVANCE
365B 26FC             (         mapl.asm):03155                 BNE     INW5                              ;TILL WE FIND NEXT
365D 20E1             (         mapl.asm):03156                 BRA     INW0                              ;AND TRY AGAIN
365F                  (         mapl.asm):03157         INW2
365F A6A0             (         mapl.asm):03158                 LDA     ,Y+                               ;FIND END
3661 81FF             (         mapl.asm):03159                 CMPA    #$FF                              ;KEEP LOOKING
3663 26FA             (         mapl.asm):03160                 BNE     INW2                              ;NOT HERE
3665 3504             (         mapl.asm):03161                 PULS    B                                 ;RESTORE LENGTH
3667 5C               (         mapl.asm):03162                 INCB                                      ;     ADVANCE FOR ZERO VALUE
3668                  (         mapl.asm):03163         INW4
3668 A6A4             (         mapl.asm):03164                 LDA     ,Y                                ;GET DATA FROM TABLE
366A A7A5             (         mapl.asm):03165                 STA     B,Y                               ;SAVE HIGHER UP
366C 313F             (         mapl.asm):03166                 LEAY    -1,Y                              ;BACKUP FOR LATER
366E 10ACE4           (         mapl.asm):03167                 CMPY    ,S                                ;ARE WE BACK YET?
3671 24F5             (         mapl.asm):03168                 BHS     INW4                              ;NO, KEEP LOOKING
3673 3520             (         mapl.asm):03169                 PULS    Y                                 ;RESTORE POITION
3675 5A               (         mapl.asm):03170                 DECB                                      ;     CONVERT BACK TO LENGTH
3676                  (         mapl.asm):03171         FNS2
3676 A685             (         mapl.asm):03172                 LDA     B,X                               ;GET CHARACTER
3678 A7A0             (         mapl.asm):03173                 STA     ,Y+                               ;SAVE IN RAM
367A 5A               (         mapl.asm):03174                 DECB                                      ;     REDUCE COUNT
367B 26F9             (         mapl.asm):03175                 BNE     FNS2                              ;AND KEEP GOING
367D 6FA4             (         mapl.asm):03176                 CLR     ,Y                                ;INDICATE END OF ENTRY
367F                  (         mapl.asm):03177         FNS3
367F E61F             (         mapl.asm):03178                 LDB     -1,X                              ;GET LENGTH AGAIN
3681 C41F             (         mapl.asm):03179                 ANDB    #$1F                              ;REMOVE TYPE INFO
3683 CB03             (         mapl.asm):03180                 ADDB    #3                                ;OFFSET TO NEXT
3685 3A               (         mapl.asm):03181                 ABX     B,X                               ;SKIP TO NEXT
3686 20A4             (         mapl.asm):03182                 BRA     FNS1                              ;AND TRY AGAIN
3688                  (         mapl.asm):03183         FNS4
3688 BE4000           (         mapl.asm):03184                 LDX     FREE                              ;POINT TO WORKSPACE
368B                  (         mapl.asm):03185         FNS5
368B 5F               (         mapl.asm):03186                 CLRB                                      ;     SET PRINT POSITION TO ZERO
368C                  (         mapl.asm):03187         FNS6
368C A680             (         mapl.asm):03188                 LDA     ,X+                               ;GET DATA FROM WORKSPACE
368E 270A             (         mapl.asm):03189                 BEQ     FNS7                              ;ADVANCE TO NEXT
3690 81FF             (         mapl.asm):03190                 CMPA    #$FF                              ;END OF TABLE?
3692 2717             (         mapl.asm):03191                 BEQ     FNS8                              ;IF SO, STOP
3694 17EDE1           (         mapl.asm):03192                 LBSR    PUTCHR                            ;DISPLAY
3697 5C               (         mapl.asm):03193                 INCB                                      ;     INDICATE WE ADVANCED
3698 20F2             (         mapl.asm):03194                 BRA     FNS6                              ;AND CONTINUE
369A                  (         mapl.asm):03195         FNS7
369A 17EDE2           (         mapl.asm):03196                 LBSR    SPACE                             ;DISPLAY A SPACE
369D 5C               (         mapl.asm):03197                 INCB                                      ;     ADVANCE
369E C507             (         mapl.asm):03198                 BITB    #$07                              ;TEST FOR AT A TAB STOP
36A0 26F8             (         mapl.asm):03199                 BNE     FNS7                              ;NO, KEEP GOING
36A2 C13C             (         mapl.asm):03200                 CMPB    #60                               ;ARE WE OVER LIMIT?
36A4 25E6             (         mapl.asm):03201                 BLO     FNS6                              ;NO, WE ARE OK
36A6 17EDC9           (         mapl.asm):03202                 LBSR    LFCR                              ;NEW LINE
36A9 20E0             (         mapl.asm):03203                 BRA     FNS5                              ;AND TRY AGAIN
36AB                  (         mapl.asm):03204         FNS8
36AB 5D               (         mapl.asm):03205                 TSTB                                      ;     ARE WE AT BEGINNING OF LINE?
36AC 2703             (         mapl.asm):03206                 BEQ     NOLF                              ;NO NEED TO NEW LINE
36AE 17EDC1           (         mapl.asm):03207                 LBSR    LFCR                              ;NEW LINE
36B1                  (         mapl.asm):03208         NOLF
36B1 39               (         mapl.asm):03209                 RTS
                      (         mapl.asm):03210         ;* ')SYSTEM' COMMAND
36B2                  (         mapl.asm):03211         SYSTEM
36B2 3420             (         mapl.asm):03212                 PSHS    Y                                 ;SAVE COMMAND
36B4 4F               (         mapl.asm):03213                 CLRA
36B5 3F               (         mapl.asm):03214                 SWI
36B6 68               (         mapl.asm):03215                 FCB     104                               ;ENABLE DOS MESSAGES
36B7 3520             (         mapl.asm):03216                 PULS    Y                                 ;RESTORE COMMAND
36B9 17EDC7           (         mapl.asm):03217                 LBSR    SKP                               ;CHECK FOR OPERAND
36BC 2704             (         mapl.asm):03218                 BEQ     DOSENT                            ;EXECUTE DOS COMMAND
36BE 3F               (         mapl.asm):03219                 SWI
36BF 64               (         mapl.asm):03220                 FCB     100                               ;EXECUTE COMMAND
36C0 2002             (         mapl.asm):03221                 BRA     SYST1                             ;AND QUIT
36C2                  (         mapl.asm):03222         DOSENT
36C2 3F               (         mapl.asm):03223                 SWI
36C3 65               (         mapl.asm):03224                 FCB     101                               ;ENTER DOS
36C4                  (         mapl.asm):03225         SYST1
36C4 4F               (         mapl.asm):03226                 CLRA                                      ;     DISABLE MESSAGES
36C5 3F               (         mapl.asm):03227                 SWI
36C6 69               (         mapl.asm):03228                 FCB     105                               ;WITH DOS COMMAND
36C7 39               (         mapl.asm):03229                 RTS
                      (         mapl.asm):03230         ;* ')LIB' COMMAND
36C8                  (         mapl.asm):03231         LIB
36C8 17EDB8           (         mapl.asm):03232                 LBSR    SKP                               ;LOOK FOR NAME
36CB 2606             (         mapl.asm):03233                 BNE     LIB1                              ;DON'T ASSUME DEFAULT
36CD 108E3A41         (         mapl.asm):03234                 LDY     #DEFNAM                           ;POINT TO DEFAULT NAME
36D1 2003             (         mapl.asm):03235                 BRA     LIB2                              ;AND DISPLAY IT
36D3                  (         mapl.asm):03236         LIB1
36D3 17EEFA           (         mapl.asm):03237                 LBSR    FILNAM                            ;GET FILENAME
36D6                  (         mapl.asm):03238         LIB2
36D6 3F               (         mapl.asm):03239                 SWI
36D7 09               (         mapl.asm):03240                 FCB     9                                 ;GET FILENAME
36D8 102602AA         (         mapl.asm):03241                 LBNE    UNCMD                             ;ERROR, QUIT
36DC 3F               (         mapl.asm):03242                 SWI
36DD 5E               (         mapl.asm):03243                 FCB     94                                ;DISPLAY DIRECTORY
36DE 2711             (         mapl.asm):03244                 BEQ     LIB3                              ;OK
36E0 17ED83           (         mapl.asm):03245                 LBSR    SYSMSG                            ;DISPLAY MESSAGE
36E3 4C49425241525920 (         mapl.asm):03246                 FCN     'LIBRARY EMPTY'
     454D50545900
36F1                  (         mapl.asm):03247         LIB3
36F1 39               (         mapl.asm):03248                 RTS
                      (         mapl.asm):03249         ;* ')WSID' COMMAND
36F2                  (         mapl.asm):03250         WSID
36F2 17ED8E           (         mapl.asm):03251                 LBSR    SKP                               ;LOOK FOR OPERAND
36F5 2722             (         mapl.asm):03252                 BEQ     WSID1                             ;IF NONE, SHOW IT
36F7 17EED6           (         mapl.asm):03253                 LBSR    FILNAM                            ;GET FILENAME
36FA 3F               (         mapl.asm):03254                 SWI
36FB 0A               (         mapl.asm):03255                 FCB     10                                ;GET FROM OS
36FC 10260286         (         mapl.asm):03256                 LBNE    UNCMD                             ;FAILED
3700 3108             (         mapl.asm):03257                 LEAY    8,X                               ;SKIP TO NAME FIELD
3702 17ED55           (         mapl.asm):03258                 LBSR    DSPSTR                            ;DISPLAY MESSAGE
3705 5741532000       (         mapl.asm):03259                 FCN     'WAS '
370A 8D14             (         mapl.asm):03260                 BSR     DWSID                             ;DISPLAY WHAT IT WAS
370C                  (         mapl.asm):03261         WSISET
370C C608             (         mapl.asm):03262                 LDB     #8                                ;MOVE EIGHT CHARACTERS
370E 8E3CA8           (         mapl.asm):03263                 LDX     #ID                               ;POINT TO ID
3711                  (         mapl.asm):03264         WSID3
3711 A6A0             (         mapl.asm):03265                 LDA     ,Y+                               ;GET CHAR
3713 A780             (         mapl.asm):03266                 STA     ,X+                               ;SAVE ID
3715 5A               (         mapl.asm):03267                 DECB                                      ;     REDUCE COUNT
3716 26F9             (         mapl.asm):03268                 BNE     WSID3                             ;AND SAVE IT ALL
3718                  (         mapl.asm):03269         WSID2
3718 39               (         mapl.asm):03270                 RTS
3719                  (         mapl.asm):03271         WSID1
3719 17ED3E           (         mapl.asm):03272                 LBSR    DSPSTR                            ;DISPLAY MESSAGE
371C 49532000         (         mapl.asm):03273                 FCN     'IS '
                      (         mapl.asm):03274         ;* DISPLAY WORKSPACE ID
3720                  (         mapl.asm):03275         DWSID
3720 8E3CA8           (         mapl.asm):03276                 LDX     #ID                               ;POINT TO ID
3723 C608             (         mapl.asm):03277                 LDB     #8                                ;MAX EIGHT CHARACTERS
3725                  (         mapl.asm):03278         WSID4
3725 A680             (         mapl.asm):03279                 LDA     ,X+                               ;GET CHAR
3727 2706             (         mapl.asm):03280                 BEQ     WSID5                             ;QUIT
3729 17ED4C           (         mapl.asm):03281                 LBSR    PUTCHR                            ;OUTPUT
372C 5A               (         mapl.asm):03282                 DECB                                      ;     REDUCE COUNT
372D 26F6             (         mapl.asm):03283                 BNE     WSID4                             ;AND CONTINUE
372F                  (         mapl.asm):03284         WSID5
372F 17ED40           (         mapl.asm):03285                 LBSR    LFCR                              ;NEW LINE
3732 39               (         mapl.asm):03286                 RTS
3733                  (         mapl.asm):03287         NOTSI
3733 17ED30           (         mapl.asm):03288                 LBSR    SYSMSG                            ;DISPLAY MESSAGE
3736 4E4F542057495448 (         mapl.asm):03289                 FCN     'NOT WITH SI'
     20534900
3742 39               (         mapl.asm):03290                 RTS
                      (         mapl.asm):03291         ;* ')SAVE' COMMAND
3743                  (         mapl.asm):03292         SAVE
3743 17ED3D           (         mapl.asm):03293                 LBSR    SKP                               ;LOOK FOR PARAMETER
3746 262F             (         mapl.asm):03294                 BNE     SAV1                              ;USER SUPPLIED FILENAME
3748 8E3CA8           (         mapl.asm):03295                 LDX     #ID                               ;POINT TO SAVED ID
374B C608             (         mapl.asm):03296                 LDB     #8                                ;MAX EIGHT CHARACTERS
374D 108E206C         (         mapl.asm):03297                 LDY     #CID                              ;POINT TO CID
3751                  (         mapl.asm):03298         SAV6
3751 A680             (         mapl.asm):03299                 LDA     ,X+                               ;GET CHARACTER FROM ID
3753 A1A0             (         mapl.asm):03300                 CMPA    ,Y+                               ;IS IT SAME AS CLEAR
3755 2606             (         mapl.asm):03301                 BNE     SAV7                              ;NO, IT'S OK
3757 5A               (         mapl.asm):03302                 DECB                                      ;     REDUCE COUNT
3758 26F7             (         mapl.asm):03303                 BNE     SAV6                              ;KEEP LOOKING
375A 16E90C           (         mapl.asm):03304                 LBRA    CLMSG                             ;GET UPSET
375D                  (         mapl.asm):03305         SAV7
375D 8E3CA8           (         mapl.asm):03306                 LDX     #ID                               ;POINT TO ID
3760 C608             (         mapl.asm):03307                 LDB     #8                                ;MOVE EIGHT CHARACTERS
3762 108E3C00         (         mapl.asm):03308                 LDY     #RAM                              ;POINT TO INPUT BUFFER
3766 3420             (         mapl.asm):03309                 PSHS    Y                                 ;SAVE POINTER
3768                  (         mapl.asm):03310         SAV3
3768 A680             (         mapl.asm):03311                 LDA     ,X+                               ;GET CHAR
376A 2705             (         mapl.asm):03312                 BEQ     SAV4                              ;END, GO AGAIN
376C A7A0             (         mapl.asm):03313                 STA     ,Y+                               ;SAVE IN OUTPUT
376E 5A               (         mapl.asm):03314                 DECB                                      ;     REDUCE COUNT
376F 26F7             (         mapl.asm):03315                 BNE     SAV3                              ;AND KEEP GOING
3771                  (         mapl.asm):03316         SAV4
3771 860D             (         mapl.asm):03317                 LDA     #$0D                              ;GET CR
3773 A7A4             (         mapl.asm):03318                 STA     ,Y                                ;SAVE IN FILENAME
3775 3520             (         mapl.asm):03319                 PULS    Y                                 ;RESTORE POINTER
3777                  (         mapl.asm):03320         SAV1
3777 17EE56           (         mapl.asm):03321                 LBSR    FILNAM                            ;GET FILENAME
377A                  (         mapl.asm):03322         SAV5
377A FC3CA0           (         mapl.asm):03323                 LDD     SAVSTK                            ;GET SAVED STACK
377D 10834000         (         mapl.asm):03324                 CMPD    #STACK                            ;DO WE HAVE SI?
3781 26B0             (         mapl.asm):03325                 BNE     NOTSI                             ;NOT WITH SI
3783 3F               (         mapl.asm):03326                 SWI
3784 0A               (         mapl.asm):03327                 FCB     10                                ;TELL DOS
3785 102601FD         (         mapl.asm):03328                 LBNE    UNCMD                             ;IF BAD, SKIP IT
3789 3108             (         mapl.asm):03329                 LEAY    8,X                               ;POINT TO FILENAME
378B 17FF7E           (         mapl.asm):03330                 LBSR    WSISET                            ;SET ID
378E FC4000           (         mapl.asm):03331                 LDD     FREE                              ;GET FIRST FREE ADDRESS
3791 834000           (         mapl.asm):03332                 SUBD    #FREE                             ;AND CALCULATE OFFSET
3794 1F01             (         mapl.asm):03333                 TFR     D,X                               ;COPY TO X FOR DIVIDE
3796 CC0200           (         mapl.asm):03334                 LDD     #512                              ;SIZE OF DISK SECTORS
3799 17EE10           (         mapl.asm):03335                 LBSR    DIV                               ;PERFORM DIVISION
379C 10830000         (         mapl.asm):03336                 CMPD    #0                                ;ANY REMAINDER
37A0 2702             (         mapl.asm):03337                 BEQ     SAV2                              ;NO INC
37A2 3001             (         mapl.asm):03338                 LEAX    1,X                               ;ADVANCE FOR REMAINDER OF SECTOR
37A4                  (         mapl.asm):03339         SAV2
37A4 1F10             (         mapl.asm):03340                 TFR     X,D                               ;COPY SIZE TO D
37A6 8E4000           (         mapl.asm):03341                 LDX     #FREE                             ;POINT TO START OF WS
37A9 3F               (         mapl.asm):03342                 SWI
37AA 36               (         mapl.asm):03343                 FCB     54                                ;SAVE FILE OUT
37AB 102601ED         (         mapl.asm):03344                 LBNE    SYSERR                            ;INDICATE SYSTEM ERROR
37AF 39               (         mapl.asm):03345                 RTS
                      (         mapl.asm):03346         ;* ')ERASE' COMMAND
37B0                  (         mapl.asm):03347         ERASE
37B0 17ED02           (         mapl.asm):03348                 LBSR    SFSYM                             ;LOOK FOR SYMBOLS
37B3 102701CF         (         mapl.asm):03349                 LBEQ    UNCMD                             ;INVALID COMMAND
37B7 10BF3C84         (         mapl.asm):03350                 STY     TEMP                              ;SAVE FOR LATER
37BB 1700F5           (         mapl.asm):03351                 LBSR    DOREST                            ;PERFORM RESET
37BE 10BE3C84         (         mapl.asm):03352                 LDY     TEMP                              ;AND GET POINTER BACK
37C2 313F             (         mapl.asm):03353                 LEAY    -1,Y                              ;BACKUP TO SYMBOL
37C4 17ED44           (         mapl.asm):03354                 LBSR    LOOKUP                            ;LOOK FOR SYMBOL
37C7 2604             (         mapl.asm):03355                 BNE     NOTFNS                            ;DOES NOT EXIST
37C9 8D12             (         mapl.asm):03356                 BSR     ERASYM                            ;ERASE IT
37CB 200D             (         mapl.asm):03357                 BRA     NOTF1
37CD                  (         mapl.asm):03358         NOTFNS
37CD 17EC96           (         mapl.asm):03359                 LBSR    SYSMSG                            ;DISPLAY MESSAGE
37D0 4E4F5420464F554E (         mapl.asm):03360                 FCN     'NOT FOUND'
     4400
37DA                  (         mapl.asm):03361         NOTF1
37DA 16E8A3           (         mapl.asm):03362                 LBRA    CMD                               ;GO HOME
                      (         mapl.asm):03363         ;*
                      (         mapl.asm):03364         ;* ERASES SYMBOL TABLE ENTRY POINTED TO BY "X" REGISTER
                      (         mapl.asm):03365         ;*
                      (         mapl.asm):03366         ;* DETERMINE TYPE OF SYMBOL
37DD                  (         mapl.asm):03367         ERASYM
37DD 3410             (         mapl.asm):03368                 PSHS    X                                 ;SAVE POINTER TO SYMBOL
37DF A684             (         mapl.asm):03369                 LDA     ,X                                ;GET TYPE/LENGTH
37E1 1F89             (         mapl.asm):03370                 TFR     A,B                               ;COPY
37E3 84E0             (         mapl.asm):03371                 ANDA    #$E0                              ;MASK OFF LENGTH
37E5 C41F             (         mapl.asm):03372                 ANDB    #$1F                              ;MASK OFF TYPE
37E7 CB02             (         mapl.asm):03373                 ADDB    #2                                ;ADVANCE PAST TYPE/LENGTH, NEST
37E9 3A               (         mapl.asm):03374                 ABX                                       ;     ADVANCE PAST NAME
37EA 10AE81           (         mapl.asm):03375                 LDY     ,X++                              ;GET LENGTH
37ED 10BF3C88         (         mapl.asm):03376                 STY     TEMP1                             ;SAVE ADDRESS
37F1 7F3C8A           (         mapl.asm):03377                 CLR     TEMP2                             ;SET ZERO OFFSET
37F4 7F3C8B           (         mapl.asm):03378                 CLR     TEMP2+1                           ;SET ZERO OFFSET
37F7 8160             (         mapl.asm):03379                 CMPA    #$60                              ;IS IT LABEL TYPE SYMBOL?
37F9 2720             (         mapl.asm):03380                 BEQ     RMSYM                             ;IF SO, IT'S A SPECIAL CASE
                      (         mapl.asm):03381         ;* DETERMINE SIZE OF SYMBOL
37FB                  (         mapl.asm):03382         ERANXT
37FB 10BE4000         (         mapl.asm):03383                 LDY     FREE                              ;USE FREE FOR OFFSET
37FF E684             (         mapl.asm):03384                 LDB     ,X                                ;GET TYPE/LENGTH
3801 1F98             (         mapl.asm):03385                 TFR     B,A                               ;COPY
3803 84E0             (         mapl.asm):03386                 ANDA    #$E0                              ;MASK OFF LENGTH
3805 C41F             (         mapl.asm):03387                 ANDB    #$1F                              ;MASK OFF TYPE
3807 270A             (         mapl.asm):03388                 BEQ     FREOFF                            ;END OF TABLE, REMOVE IT
3809 CB02             (         mapl.asm):03389                 ADDB    #2                                ;ADVANCE PAST TYPE/LENGTH, NEST BYTES
380B 3A               (         mapl.asm):03390                 ABX                                       ;     SKIP NAME AS WELL
380C 10AE81           (         mapl.asm):03391                 LDY     ,X++                              ;GET ADDRESS
380F 8160             (         mapl.asm):03392                 CMPA    #$60                              ;IS IT LABEL TYPE SYMBOL?
3811 27E8             (         mapl.asm):03393                 BEQ     ERANXT                            ;IF SO, CONTINUE LOOKING
3813                  (         mapl.asm):03394         FREOFF
3813 1F20             (         mapl.asm):03395                 TFR     Y,D                               ;GET ADDRESS
3815 B33C88           (         mapl.asm):03396                 SUBD    TEMP1                             ;CONVERT TO OFFSET
3818 FD3C8A           (         mapl.asm):03397                 STD     TEMP2                             ;SAVE OFFSET
                      (         mapl.asm):03398         ;* REMOVE SYMBOL TABLE ENTRY, AND ADJUST ADDRESSES
381B                  (         mapl.asm):03399         RMSYM
381B 3510             (         mapl.asm):03400                 PULS    X                                 ;RESTORE POINTER TO SYMBOL
381D E684             (         mapl.asm):03401                 LDB     ,X                                ;GET LENGTH
381F C41F             (         mapl.asm):03402                 ANDB    #$1F                              ;MASK OFF LENGTH
3821 CB04             (         mapl.asm):03403                 ADDB    #4                                ;OFFSET TO NEXT
3823 3185             (         mapl.asm):03404                 LEAY    B,X                               ;POINT TO NEXT SYMBOL
3825                  (         mapl.asm):03405         RMS1
3825 E6A0             (         mapl.asm):03406                 LDB     ,Y+                               ;GET CHAR FROM SYMBOL
3827 E780             (         mapl.asm):03407                 STB     ,X+                               ;SAVE
3829 1F98             (         mapl.asm):03408                 TFR     B,A                               ;COPY
382B 84E0             (         mapl.asm):03409                 ANDA    #$E0                              ;MASK LENGTH
382D C41F             (         mapl.asm):03410                 ANDB    #$1F                              ;CALCULATE LENGTH
382F 271A             (         mapl.asm):03411                 BEQ     RMS2                              ;IF END, QUIT
3831 CB03             (         mapl.asm):03412                 ADDB    #3                                ;OFFSET FOR NEXT
3833 3402             (         mapl.asm):03413                 PSHS    A                                 ;SAVE SYMBOL TYPE
3835                  (         mapl.asm):03414         RMS11
3835 A6A0             (         mapl.asm):03415                 LDA     ,Y+                               ;GET BYTE
3837 A780             (         mapl.asm):03416                 STA     ,X+                               ;SAVE
3839 5A               (         mapl.asm):03417                 DECB                                      ;     REDUCE COUNT
383A 26F9             (         mapl.asm):03418                 BNE     RMS11                             ;CONTINUE COPYING
383C 3502             (         mapl.asm):03419                 PULS    A                                 ;RESTORE TYPE
383E 8160             (         mapl.asm):03420                 CMPA    #$60                              ;LABEL TYPE?
3840 27E3             (         mapl.asm):03421                 BEQ     RMS1                              ;IF SO, FORGET IT
3842 EC1E             (         mapl.asm):03422                 LDD     -2,X                              ;GET ADRESS
3844 B33C8A           (         mapl.asm):03423                 SUBD    TEMP2                             ;SUBTRACT OFFSET
3847 ED1E             (         mapl.asm):03424                 STD     -2,X                              ;RESAVE
3849 20DA             (         mapl.asm):03425                 BRA     RMS1                              ;AND CONTINUE
                      (         mapl.asm):03426         ;* MOVE MEMORY BACK REQUIRED AMOUNT
384B                  (         mapl.asm):03427         RMS2
384B FC3C8A           (         mapl.asm):03428                 LDD     TEMP2                             ;GET OFFSET
384E 2718             (         mapl.asm):03429                 BEQ     NOMOVE                            ;DON'T MOVE IF NO OFFSET
3850 10BE3C88         (         mapl.asm):03430                 LDY     TEMP1                             ;GET SYMBOL ADDRESS
3854 30AB             (         mapl.asm):03431                 LEAX    D,Y                               ;POINT TO NEW LOCATION
3856 BC4000           (         mapl.asm):03432                 CMPX    FREE                              ;SPACIAL CASE FOR LAST VARIABLE IN TABLE
3859 2409             (         mapl.asm):03433                 BHS     SAVFRE                            ;IF SO, SAVE IT
385B                  (         mapl.asm):03434         RMS3
385B A680             (         mapl.asm):03435                 LDA     ,X+                               ;GET FROM MEMORY
385D A7A0             (         mapl.asm):03436                 STA     ,Y+                               ;SAVE IN OLD LOCATION
385F BC4000           (         mapl.asm):03437                 CMPX    FREE                              ;ARE WE OVER
3862 25F7             (         mapl.asm):03438                 BLO     RMS3                              ;GO FOR IT
3864                  (         mapl.asm):03439         SAVFRE
3864 10BF4000         (         mapl.asm):03440                 STY     FREE                              ;RESAVE
3868                  (         mapl.asm):03441         NOMOVE
3868 39               (         mapl.asm):03442                 RTS
                      (         mapl.asm):03443         ;* ')SI' COMMAND
3869                  (         mapl.asm):03444         SI
3869 BE3C9A           (         mapl.asm):03445                 LDX     NAMPTR                            ;POINT TO NAME
386C FC3C96           (         mapl.asm):03446                 LDD     LINCT                             ;GET LINE COUNTER
386F 10BE3CA0         (         mapl.asm):03447                 LDY     SAVSTK                            ;POINT TO SAVED STACK POINTER
3873 108C4000         (         mapl.asm):03448                 CMPY    #STACK                            ;AT TOP?
3877 272A             (         mapl.asm):03449                 BEQ     NOSUSP                            ;NONE
3879                  (         mapl.asm):03450         SI1
3879 17FC07           (         mapl.asm):03451                 LBSR    DSPNAM                            ;DISPLAY
387C AEA4             (         mapl.asm):03452                 LDX     ,Y                                ;GET POINTER TO LOCAL VARIABLE LIST
387E 17EB09           (         mapl.asm):03453                 LBSR    OULI                              ;DISPLAY VARIABLES
3881 AE2A             (         mapl.asm):03454                 LDX     10,Y                              ;POINT TO NAME
3883 EC28             (         mapl.asm):03455                 LDD     8,Y                               ;GET LINE NUMBER
3885 10AE22           (         mapl.asm):03456                 LDY     2,Y                               ;GET NEXT SAVED STACK POINTER
3888 108C4000         (         mapl.asm):03457                 CMPY    #STACK                            ;ARE WE AT TOP?
388C 26EB             (         mapl.asm):03458                 BNE     SI1                               ;CONTINUE
388E 39               (         mapl.asm):03459                 RTS
                      (         mapl.asm):03460         ;* ')REL' RELEASE ONE SUSPENDED FUNCTION
388F                  (         mapl.asm):03461         RELEAS
388F 10BE3CA0         (         mapl.asm):03462                 LDY     SAVSTK                            ;GET STACK POINTER
3893 108C4000         (         mapl.asm):03463                 CMPY    #STACK                            ;AT TOP?
3897 270A             (         mapl.asm):03464                 BEQ     NOSUSP                            ;INDICATE NOTHING TO BE EXCITED ABOUT
3899                  (         mapl.asm):03465         REL1
3899 3506             (         mapl.asm):03466                 PULS    A,B                               ;GET PROGRAM COUNTER
389B EDA810           (         mapl.asm):03467                 STD     16,Y                              ;SET RETURN ADDRESS
389E 1F24             (         mapl.asm):03468                 TFR     Y,S                               ;COPY IT OVER
38A0 16FCDD           (         mapl.asm):03469                 LBRA    EFUNC                             ;AND DO IT
38A3                  (         mapl.asm):03470         NOSUSP
38A3 17EBC0           (         mapl.asm):03471                 LBSR    SYSMSG                            ;DISPLAY MESSAGE
38A6 4E4F20534920494E (         mapl.asm):03472                 FCN     'NO SI IN WS'
     20575300
38B2 39               (         mapl.asm):03473                 RTS
                      (         mapl.asm):03474         ;* PERFORM A RESET
38B3                  (         mapl.asm):03475         DOREST
38B3 3506             (         mapl.asm):03476                 PULS    A,B                               ;GET PC
38B5 FD3C8E           (         mapl.asm):03477                 STD     TEMP4                             ;SAVE VALUE
38B8                  (         mapl.asm):03478         DORES1
38B8 10BE3CA0         (         mapl.asm):03479                 LDY     SAVSTK                            ;CKECK FOR STACK EMPTY
38BC 108C4000         (         mapl.asm):03480                 CMPY    #STACK                            ;ARE WE AT TOP?
38C0 2704             (         mapl.asm):03481                 BEQ     CLALL                             ;IF SO, CLEAR IT
38C2 8DD5             (         mapl.asm):03482                 BSR     REL1                              ;RELEASE THIS BUNCH
38C4 20F2             (         mapl.asm):03483                 BRA     DORES1                            ;AND CONTINUE
38C6                  (         mapl.asm):03484         CLALL
38C6 CCCC00           (         mapl.asm):03485                 LDD     #HIRAM                            ;TOP OF RAM
38C9 FD3CA2           (         mapl.asm):03486                 STD     RAMTOP                            ;SET UP RAM TOP
38CC CC3A3E           (         mapl.asm):03487                 LDD     #IOTA0                            ;POINT TO NULL VECTOR
38CF FD3C94           (         mapl.asm):03488                 STD     PARM                              ;SET UP PARAMETER VALUE
38D2 7F3C82           (         mapl.asm):03489                 CLR     LEVEL                             ;SET LEVEL ZERO
38D5 6E9F3C8E         (         mapl.asm):03490                 JMP     [TEMP4]                           ;RETURN TO CALLER
                      (         mapl.asm):03491         ;* ')STATUS' COMMAND
38D9                  (         mapl.asm):03492         STATUS
38D9 17EB7E           (         mapl.asm):03493                 LBSR    DSPSTR                            ;DISPLAY STRING
38DC 574F524B53504143 (         mapl.asm):03494                 FCN     'WORKSPACE NAME: '
     45204E414D453A20
     00
38ED 17FE30           (         mapl.asm):03495                 LBSR    DWSID                             ;DISPLAY IT
38F0 17EB67           (         mapl.asm):03496                 LBSR    DSPSTR                            ;DISPLAY STRING
38F3 53594D424F4C5320 (         mapl.asm):03497                 FCN     'SYMBOLS IN USE: '
     494E205553453A20
     00
3904 108E0000         (         mapl.asm):03498                 LDY     #$0                               ;INDICATE ZERO SYMBOLS
3908 8E400A           (         mapl.asm):03499                 LDX     #SYMTAB                           ;POINT TO START OF TABLE
390B                  (         mapl.asm):03500         STSYM
390B E680             (         mapl.asm):03501                 LDB     ,X+                               ;GET STARTING VALUE
390D C41F             (         mapl.asm):03502                 ANDB    #$1F                              ;MASK TYPE BITS
390F 2707             (         mapl.asm):03503                 BEQ     STSY1                             ;END OF TABLE
3911 3121             (         mapl.asm):03504                 LEAY    1,Y                               ;THIS IS ONE
3913 CB03             (         mapl.asm):03505                 ADDB    #3                                ;OFFSET FOR SYMBOL TABLE ENTRIES
3915 3A               (         mapl.asm):03506                 ABX                                       ;     ADVANCE
3916 20F3             (         mapl.asm):03507                 BRA     STSYM                             ;CONTINUE LOOKING
3918                  (         mapl.asm):03508         STSY1
3918 1F20             (         mapl.asm):03509                 TFR     Y,D                               ;COPY TO D
391A 17F5E1           (         mapl.asm):03510                 LBSR    DECOUT                            ;DISPLAY IT
391D 3410             (         mapl.asm):03511                 PSHS    X                                 ;SAVE X
391F 17EB38           (         mapl.asm):03512                 LBSR    DSPSTR                            ;DISPLAY STRING
3922 0D               (         mapl.asm):03513                 FCB     $0D
3923 53594D424F4C2054 (         mapl.asm):03514                 FCN     'SYMBOL TABLE SIZE: '
     41424C452053495A
     453A2000
3937 FC4008           (         mapl.asm):03515                 LDD     FREMEM                            ;POINT TO END OF SYMBOL TABLE
393A 83400B           (         mapl.asm):03516                 SUBD    #SYMTAB+1       CONVERT TO SIMPLE OFFSET
393D 17F5BE           (         mapl.asm):03517                 LBSR    DECOUT                            ;DISPLAY IT
3940 17EB17           (         mapl.asm):03518                 LBSR    DSPSTR                            ;DISPLAY STRING
3943 0D               (         mapl.asm):03519                 FCB     $0D
3944 53594D424F4C2054 (         mapl.asm):03520                 FCN     'SYMBOL TABLE FREE: '
     41424C4520465245
     453A2000
3958 FC4008           (         mapl.asm):03521                 LDD     FREMEM                            ;GET FREE MEMORY SPACE
395B A3E1             (         mapl.asm):03522                 SUBD    ,S++                              ;CONVERT TO BINARY VALUE
395D 17F59E           (         mapl.asm):03523                 LBSR    DECOUT                            ;DISPLAY
3960 17EAF7           (         mapl.asm):03524                 LBSR    DSPSTR                            ;DISPLAY STRING
3963 0D               (         mapl.asm):03525                 FCB     $0D
3964 574F524B53504143 (         mapl.asm):03526                 FCN     'WORKSPACE REMAINING: '
     452052454D41494E
     494E473A2000
397A FC3CA2           (         mapl.asm):03527                 LDD     RAMTOP                            ;POINT TO TOP OF RAM
397D B34000           (         mapl.asm):03528                 SUBD    FREE                              ;CONVERT TO FREE SPACE
3980 17F57B           (         mapl.asm):03529                 LBSR    DECOUT                            ;DISPLAY
3983 16EAEC           (         mapl.asm):03530                 LBRA    LFCR                              ;NEW LINE
                      (         mapl.asm):03531         ;* UNKNOWN SYSTEM COMMAND
3986                  (         mapl.asm):03532         UNCMD
3986 17EADD           (         mapl.asm):03533                 LBSR    SYSMSG
3989 494E434F52524543 (         mapl.asm):03534                 FCN     'INCORRECT COMMAND'
     5420434F4D4D414E
     4400
399B 39               (         mapl.asm):03535                 RTS
                      (         mapl.asm):03536         ;* SYSTEM ERROR HAS OCCURED
399C                  (         mapl.asm):03537         SYSERR
399C 3436             (         mapl.asm):03538                 PSHS    A,B,X,Y
399E 17EAC5           (         mapl.asm):03539                 LBSR    SYSMSG
39A1 53595354454D2045 (         mapl.asm):03540                 FCN     'SYSTEM ERROR'
     52524F5200
39AE 3506             (         mapl.asm):03541                 PULS    A,B                               ;; Get D
39B0 3F               (         mapl.asm):03542                 SWI
39B1 1B               (         mapl.asm):03543                 FCB     27
39B2 3F               (         mapl.asm):03544                 SWI
39B3 15               (         mapl.asm):03545                 FCB     21
39B4 3506             (         mapl.asm):03546                 PULS    A,B                               ;; Get X
39B6 3F               (         mapl.asm):03547                 SWI
39B7 1B               (         mapl.asm):03548                 FCB     27
39B8 3F               (         mapl.asm):03549                 SWI
39B9 15               (         mapl.asm):03550                 FCB     21
39BA 3506             (         mapl.asm):03551                 PULS    A,B                               ;; Get Y
39BC 3F               (         mapl.asm):03552                 SWI
39BD 1B               (         mapl.asm):03553                 FCB     27
39BE 3F               (         mapl.asm):03554                 SWI
39BF 15               (         mapl.asm):03555                 FCB     21
39C0 3506             (         mapl.asm):03556                 PULS    A,B                               ;; Get PC
39C2 3F               (         mapl.asm):03557                 SWI
39C3 1B               (         mapl.asm):03558                 FCB     27
39C4 3F               (         mapl.asm):03559                 SWI
39C5 15               (         mapl.asm):03560                 FCB     21
39C6 1F40             (         mapl.asm):03561                 TFR     S,D                               ;; Get S
39C8 3F               (         mapl.asm):03562                 SWI
39C9 1B               (         mapl.asm):03563                 FCB     27
39CA 3F               (         mapl.asm):03564                 SWI
39CB 15               (         mapl.asm):03565                 FCB     21
39CC 1F30             (         mapl.asm):03566                 TFR     U,D                               ;; Get U
39CE 3F               (         mapl.asm):03567                 SWI
39CF 1B               (         mapl.asm):03568                 FCB     27
39D0 3F               (         mapl.asm):03569                 SWI
39D1 16               (         mapl.asm):03570                 FCB     22
39D2 16E6AB           (         mapl.asm):03571                 LBRA    CMD
                      (         mapl.asm):03572         ;*
                      (         mapl.asm):03573         ;* SYSTEM COMMAND TEXT TABLE
                      (         mapl.asm):03574         ;*
39D5                  (         mapl.asm):03575         CMDTAB
39D5 4F46             (         mapl.asm):03576                 FCC     'OF'
39D7 C6               (         mapl.asm):03577                 FCB     'F'+$80
39D8 3605             (         mapl.asm):03578                 FDB     OFF
39DA 434C4541         (         mapl.asm):03579                 FCC     'CLEA'
39DE D2               (         mapl.asm):03580                 FCB     'R'+$80
39DF 2027             (         mapl.asm):03581                 FDB     CLEAR
39E1 464E             (         mapl.asm):03582                 FCC     'FN'
39E3 D3               (         mapl.asm):03583                 FCB     'S'+$80
39E4 361B             (         mapl.asm):03584                 FDB     FNS
39E6 564152           (         mapl.asm):03585                 FCC     'VAR'
39E9 D3               (         mapl.asm):03586                 FCB     'S'+$80
39EA 3612             (         mapl.asm):03587                 FDB     VARS
39EC 4C424C           (         mapl.asm):03588                 FCC     'LBL'
39EF D3               (         mapl.asm):03589                 FCB     'S'+$80
39F0 360B             (         mapl.asm):03590                 FDB     LBLS
39F2 5359             (         mapl.asm):03591                 FCC     'SY'
39F4 D3               (         mapl.asm):03592                 FCB     'S'+$80
39F5 36B2             (         mapl.asm):03593                 FDB     SYSTEM
39F7 4C49             (         mapl.asm):03594                 FCC     'LI'
39F9 C2               (         mapl.asm):03595                 FCB     'B'+$80
39FA 36C8             (         mapl.asm):03596                 FDB     LIB
39FC 575349           (         mapl.asm):03597                 FCC     'WSI'
39FF C4               (         mapl.asm):03598                 FCB     'D'+$80
3A00 36F2             (         mapl.asm):03599                 FDB     WSID
3A02 534156           (         mapl.asm):03600                 FCC     'SAV'
3A05 C5               (         mapl.asm):03601                 FCB     'E'+$80
3A06 3743             (         mapl.asm):03602                 FDB     SAVE
3A08 4C4F41           (         mapl.asm):03603                 FCC     'LOA'
3A0B C4               (         mapl.asm):03604                 FCB     'D'+$80
3A0C 20BA             (         mapl.asm):03605                 FDB     LOAD
3A0E 44524F           (         mapl.asm):03606                 FCC     'DRO'
3A11 D0               (         mapl.asm):03607                 FCB     'P'+$80
3A12 210B             (         mapl.asm):03608                 FDB     DROP
3A14 45524153         (         mapl.asm):03609                 FCC     'ERAS'
3A18 C5               (         mapl.asm):03610                 FCB     'E'+$80
3A19 37B0             (         mapl.asm):03611                 FDB     ERASE
3A1B 53               (         mapl.asm):03612                 FCC     'S'
3A1C C9               (         mapl.asm):03613                 FCB     'I'+$80
3A1D 3869             (         mapl.asm):03614                 FDB     SI
3A1F 5245             (         mapl.asm):03615                 FCC     'RE'
3A21 CC               (         mapl.asm):03616                 FCB     'L'+$80
3A22 388F             (         mapl.asm):03617                 FDB     RELEAS
3A24 52455345         (         mapl.asm):03618                 FCC     'RESE'
3A28 D4               (         mapl.asm):03619                 FCB     'T'+$80
3A29 207D             (         mapl.asm):03620                 FDB     RESET
3A2B 434F4E54494E55   (         mapl.asm):03621                 FCC     'CONTINU'
3A32 C5               (         mapl.asm):03622                 FCB     'E'+$80
3A33 35FE             (         mapl.asm):03623                 FDB     CONCMD
3A35 535441           (         mapl.asm):03624                 FCC     'STA'
3A38 D4               (         mapl.asm):03625                 FCB     'T'+$80
3A39 38D9             (         mapl.asm):03626                 FDB     STATUS
3A3B 80               (         mapl.asm):03627                 FCB     $80
3A3C 3986             (         mapl.asm):03628                 FDB     UNCMD
                      (         mapl.asm):03629         ;* DEFAULT VECTOR STRING, EMPTY NUMERIC VECTOR
3A3E                  (         mapl.asm):03630         IOTA0
3A3E 01               (         mapl.asm):03631                 FCB     $01                               ;TYPE = NUMERIC
3A3F 0000             (         mapl.asm):03632                 FDB     0                                 ;LENGTH = ZERO
                      (         mapl.asm):03633         ;*
                      (         mapl.asm):03634         ;* STRINGS
                      (         mapl.asm):03635         ;*
3A41                  (         mapl.asm):03636         DEFNAM
3A41 2A2E41504C       (         mapl.asm):03637                 FCC     '*.APL'
3A46 0D               (         mapl.asm):03638                 FCB     $0D
3A47 65404C58         (         mapl.asm):03639                 FCC     'e@LX'
3A4B 0D               (         mapl.asm):03640                 FCB     $0D
     3A4A             (         mapl.asm):03641         LXNAME          = *-2
3A4C                  (         mapl.asm):03642         CONTIN
3A4C 434F4E54494E5545 (         mapl.asm):03643                 FCN     'CONTINUE.APL'
     2E41504C00
                      (         mapl.asm):03644         ;*
                      (         mapl.asm):03645         ;* STANDARD OPERATING SYSTEM INTERFACE, SUPPORTS
                      (         mapl.asm):03646         ;* OPERATING SYSTEM COMMANDS, AND FILE I/O
                      (         mapl.asm):03647         ;* ON ENTRY, 'X' POINT TO LEFT OPERAND, 'Y' POINTS TO RIGHT OPERAND
                      (         mapl.asm):03648         ;*
                      (         mapl.asm):03649         ;* FUNCTIONS:
                      (         mapl.asm):03650         ;*   0 - EXECUTE DOS COMMAND
                      (         mapl.asm):03651         ;*   1 - OPEN FILE/READ
                      (         mapl.asm):03652         ;*   2 - OPEN FILE/WRITE
                      (         mapl.asm):03653         ;*   3 - TEST FOR FILE EXISTANCE
                      (         mapl.asm):03654         ;*   4 - READ MEMORY (ADDR, ADDR, ADDR ...)
                      (         mapl.asm):03655         ;*   5 - WRITE MEMORY (ADDR, DATA, DATA ...)
                      (         mapl.asm):03656         ;*   6 - EXECUTE ssr (IN=ssr,AB,X,Y,U - OUT=RC,AB,X,Y,U)
                      (         mapl.asm):03657         ;*   <file>o<char>   - Write file
                      (         mapl.asm):03658         ;*   <file>o0       - Read file
                      (         mapl.asm):03659         ;*   <file>o1       - Close file
                      (         mapl.asm):03660         ;*   <file>o2       - Rewind file
                      (         mapl.asm):03661         ;*
3A59                  (         mapl.asm):03662         OSFUNC
3A59 A684             (         mapl.asm):03663                 LDA     ,X                                ;GET TYPE
3A5B 4A               (         mapl.asm):03664                 DECA                                      ;     INTEGER
3A5C 1026F8AC         (         mapl.asm):03665                 LBNE    CDOM                              ;ERROR
3A60 EC01             (         mapl.asm):03666                 LDD     1,X                               ;GET LENGTH
3A62 10830105         (         mapl.asm):03667                 CMPD    #261                              ;SPECIAL FILE STUFF?
3A66 10270103         (         mapl.asm):03668                 LBEQ    OSFILE                            ;ITS A FILE ACCESS
                      (         mapl.asm):03669         ;* NON FILE ACCESS
3A6A                  (         mapl.asm):03670         OSFNF
3A6A 10830001         (         mapl.asm):03671                 CMPD    #1                                ;FUNCTION CODE
3A6E 1026F893         (         mapl.asm):03672                 LBNE    CLEN                              ;OUT OF RAMGE
3A72 EC03             (         mapl.asm):03673                 LDD     3,X                               ;GET VALUE
3A74 4D               (         mapl.asm):03674                 TSTA                                      ;     HIGH ZERO?
3A75 1026F893         (         mapl.asm):03675                 LBNE    CDOM                              ;ERROR
                      (         mapl.asm):03676         ;* CHECK FOR EXECUTE OPERATING SYSTEM COMMAND
3A79 5D               (         mapl.asm):03677                 TSTB
3A7A 261E             (         mapl.asm):03678                 BNE     OSOPEN                            ;NO, TRY OPEN
3A7C 170134           (         mapl.asm):03679                 LBSR    OSROT                             ;ROTATE IT
3A7F 860D             (         mapl.asm):03680                 LDA     #$0D                              ;GET CR, TERMINATE COMMAND
3A81 A7C4             (         mapl.asm):03681                 STA     ,U                                ;SAVE IT
3A83 3123             (         mapl.asm):03682                 LEAY    3,Y                               ;POINT TO COMMAND
3A85 3F               (         mapl.asm):03683                 SWI
3A86 64               (         mapl.asm):03684                 FCB     100                               ;EXECUTE
3A87                  (         mapl.asm):03685         OSAVRC
3A87 2704             (         mapl.asm):03686                 BEQ     OSRCZ                             ;RC IS ZERO
3A89 1F89             (         mapl.asm):03687                 TFR     A,B                               ;COPY TO B
3A8B 2001             (         mapl.asm):03688                 BRA     OSRC1                             ;RETURN RC
3A8D                  (         mapl.asm):03689         OSRCZ
3A8D 5F               (         mapl.asm):03690                 CLRB                                      ;     SET ZERO RC
3A8E                  (         mapl.asm):03691         OSRC1
3A8E 4F               (         mapl.asm):03692                 CLRA                                      ;     CLEAR HIGH BYTE
3A8F                  (         mapl.asm):03693         OSRES
3A8F AE62             (         mapl.asm):03694                 LDX     2,S                               ;GET POINTER BACK
3A91 ED03             (         mapl.asm):03695                 STD     3,X                               ;SAVE VALUE
3A93 C601             (         mapl.asm):03696                 LDB     #1                                ;GET TYPE AND LENGTH
3A95 E784             (         mapl.asm):03697                 STB     ,X                                ;SAVE IT
3A97 ED01             (         mapl.asm):03698                 STD     1,X                               ;SAVE LENGTH
3A99 39               (         mapl.asm):03699                 RTS
                      (         mapl.asm):03700         ;* OPEN FILE FOR READ
3A9A                  (         mapl.asm):03701         OSOPEN
3A9A 5A               (         mapl.asm):03702                 DECB                                      ;     TEST FOR OPEN READ
3A9B 2619             (         mapl.asm):03703                 BNE     OSOPW                             ;NO, TRY FOR OPEN WRITE
3A9D 170113           (         mapl.asm):03704                 LBSR    OSROT                             ;SWAP IT
3AA0 6FC4             (         mapl.asm):03705                 CLR     ,U                                ;INDICATE END
3AA2 3123             (         mapl.asm):03706                 LEAY    3,Y                               ;PT TO TEXT
3AA4 3F               (         mapl.asm):03707                 SWI
3AA5 0A               (         mapl.asm):03708                 FCB     10                                ;GET IT
3AA6 26DF             (         mapl.asm):03709                 BNE     OSAVRC                            ;INVALID
3AA8 EE62             (         mapl.asm):03710                 LDU     2,S                               ;PT TO OPERAND
3AAA CC0105           (         mapl.asm):03711                 LDD     #261                              ;LENGTH
3AAD A7C0             (         mapl.asm):03712                 STA     ,U+                               ;SAVE TYPE
3AAF EDC1             (         mapl.asm):03713                 STD     ,U++                              ;SAVE LENGTH
3AB1 3F               (         mapl.asm):03714                 SWI
3AB2 37               (         mapl.asm):03715                 FCB     55                                ;OPEN FOR READ
3AB3 26D2             (         mapl.asm):03716                 BNE     OSAVRC                            ;INDICATE OK
3AB5 39               (         mapl.asm):03717                 RTS
                      (         mapl.asm):03718         ;* OPEN FILE FOR OUTPUT
3AB6                  (         mapl.asm):03719         OSOPW
3AB6 5A               (         mapl.asm):03720                 DECB                                      ;     OPEN FOR WRITE?
3AB7 2619             (         mapl.asm):03721                 BNE     OSTFIL                            ;NO, TRY CLOSE
3AB9 1700F7           (         mapl.asm):03722                 LBSR    OSROT                             ;SWAP IT
3ABC 6FC4             (         mapl.asm):03723                 CLR     ,U                                ;SET TERMINATOR
3ABE 3123             (         mapl.asm):03724                 LEAY    3,Y                               ;DO IT
3AC0 3F               (         mapl.asm):03725                 SWI
3AC1 0A               (         mapl.asm):03726                 FCB     10                                ;OK?
3AC2 26C3             (         mapl.asm):03727                 BNE     OSAVRC                            ;NO, GET UPSET
3AC4 EE62             (         mapl.asm):03728                 LDU     2,S                               ;PT TO OPERAND
3AC6 CC0105           (         mapl.asm):03729                 LDD     #261                              ;SIZE OPERAND
3AC9 A7C0             (         mapl.asm):03730                 STA     ,U+                               ;SET TYPE
3ACB EDC1             (         mapl.asm):03731                 STD     ,U++                              ;SAVE LENGTH
3ACD 3F               (         mapl.asm):03732                 SWI
3ACE 38               (         mapl.asm):03733                 FCB     56                                ;OPEN FILE FOR WRITE
3ACF 26B6             (         mapl.asm):03734                 BNE     OSAVRC                            ;SAVE RC
3AD1                  (         mapl.asm):03735         OSRM2
3AD1 39               (         mapl.asm):03736                 RTS
                      (         mapl.asm):03737         ;* TEST FOR FILE EXISTANCE
3AD2                  (         mapl.asm):03738         OSTFIL
3AD2 5A               (         mapl.asm):03739                 DECB                                      ;     TEST FOR FILE?
3AD3 260F             (         mapl.asm):03740                 BNE     OSRMEM                            ;NO, TRY NEXT
3AD5 1700DB           (         mapl.asm):03741                 LBSR    OSROT                             ;ROTATE OPERAND
3AD8 6FC4             (         mapl.asm):03742                 CLR     ,U                                ;SET DELIMITER
3ADA 3123             (         mapl.asm):03743                 LEAY    3,Y                               ;ADVANCE
3ADC 3F               (         mapl.asm):03744                 SWI
3ADD 0A               (         mapl.asm):03745                 FCB     10                                ;GET FILENAME
3ADE 26A7             (         mapl.asm):03746                 BNE     OSAVRC                            ;BAD, QUIT
3AE0 3F               (         mapl.asm):03747                 SWI
3AE1 44               (         mapl.asm):03748                 FCB     68                                ;LOOK FOR IT
3AE2 20A3             (         mapl.asm):03749                 BRA     OSAVRC                            ;SAVE RC
                      (         mapl.asm):03750         ;* READ MEMORY
3AE4                  (         mapl.asm):03751         OSRMEM
3AE4 A6A4             (         mapl.asm):03752                 LDA     ,Y                                ;INTEGER DATA ONLY
3AE6 8101             (         mapl.asm):03753                 CMPA    #1                                ;INTEGER?
3AE8 1026F820         (         mapl.asm):03754                 LBNE    CDOM                              ;ERROR, WRONG TYPE
3AEC 5A               (         mapl.asm):03755                 DECB                                      ;     READ MEMORY?
3AED 2618             (         mapl.asm):03756                 BNE     OSWMEM                            ;WRITE MEMORY
3AEF EC21             (         mapl.asm):03757                 LDD     1,Y                               ;GET LENGTH
3AF1 3406             (         mapl.asm):03758                 PSHS    A,B                               ;SAVE PTR
3AF3 3123             (         mapl.asm):03759                 LEAY    3,Y                               ;ADVANCE TO DATA
3AF5                  (         mapl.asm):03760         OSRM1
3AF5 ECE1             (         mapl.asm):03761                 LDD     ,S++                              ;GET COUNT
3AF7 27D8             (         mapl.asm):03762                 BEQ     OSRM2                             ;EXIT
3AF9 830001           (         mapl.asm):03763                 SUBD    #1                                ;REDUCE COUNT
3AFC EDE3             (         mapl.asm):03764                 STD     ,--S                              ;RESAVE
3AFE AEA4             (         mapl.asm):03765                 LDX     ,Y                                ;GET ADDRESS
3B00 E684             (         mapl.asm):03766                 LDB     ,X                                ;GET DATA
3B02 4F               (         mapl.asm):03767                 CLRA                                      ;     ZERO HIGH
3B03 EDA1             (         mapl.asm):03768                 STD     ,Y++                              ;SET VALUE
3B05 20EE             (         mapl.asm):03769                 BRA     OSRM1                             ;AND CONTINUE
                      (         mapl.asm):03770         ;* WRITE MEMORY
3B07                  (         mapl.asm):03771         OSWMEM
3B07 5A               (         mapl.asm):03772                 DECB                                      ;     WRITE MEMORY?
3B08 262B             (         mapl.asm):03773                 BNE     OSSSR                             ;NO, TRY OSR
3B0A EC21             (         mapl.asm):03774                 LDD     1,Y                               ;GET LENGTH
3B0C 1027F7F5         (         mapl.asm):03775                 LBEQ    CLEN                              ;ZERO LENGTH INVALID
3B10 830001           (         mapl.asm):03776                 SUBD    #1                                ;CONVERT
3B13 ED21             (         mapl.asm):03777                 STD     1,Y                               ;SET LENGTH TO L-1
3B15 3406             (         mapl.asm):03778                 PSHS    A,B                               ;SAVE REGS
3B17 59               (         mapl.asm):03779                 ROLB                                      ;     X2
3B18 48               (         mapl.asm):03780                 LSLA                                      ;     FOR INTEGER ENTRIES
3B19 3123             (         mapl.asm):03781                 LEAY    3,Y                               ;ADVANCE TO DATA
3B1B 31AB             (         mapl.asm):03782                 LEAY    D,Y                               ;POINT TO DATA
3B1D AEA4             (         mapl.asm):03783                 LDX     ,Y                                ;GET ADDRESS
3B1F                  (         mapl.asm):03784         OSWM1
3B1F ECE1             (         mapl.asm):03785                 LDD     ,S++                              ;GET COUNT
3B21 27AE             (         mapl.asm):03786                 BEQ     OSRM2                             ;END, EXIT
3B23 830001           (         mapl.asm):03787                 SUBD    #1                                ;REDUCE LENGTH
3B26 EDE3             (         mapl.asm):03788                 STD     ,--S                              ;RESAVE
3B28 ECA3             (         mapl.asm):03789                 LDD     ,--Y                              ;GET DATA TO WRITE
3B2A A684             (         mapl.asm):03790                 LDA     ,X                                ;GET OLD DATA
3B2C E780             (         mapl.asm):03791                 STB     ,X+                               ;WRITE NEW DATA
3B2E 1E89             (         mapl.asm):03792                 EXG     A,B                               ;SWAP
3B30 4F               (         mapl.asm):03793                 CLRA                                      ;     ZERO HIGH
3B31 EDA4             (         mapl.asm):03794                 STD     ,Y                                ;AND REWRITE
3B33 20EA             (         mapl.asm):03795                 BRA     OSWM1                             ;CONTINUE
                      (         mapl.asm):03796         ;* PERFORM A DOS SYSTEM REQUEST
3B35                  (         mapl.asm):03797         OSSSR
3B35 5A               (         mapl.asm):03798                 DECB                                      ;     IS THIS IT?
3B36 1026F7D2         (         mapl.asm):03799                 LBNE    CDOM                              ;NO, EXIT
3B3A EC21             (         mapl.asm):03800                 LDD     1,Y                               ;GET LENGTH
3B3C 10830005         (         mapl.asm):03801                 CMPD    #5                                ;FOUR ELEMENTS?
3B40 1026F7C1         (         mapl.asm):03802                 LBNE    CLEN                              ;LENGTH ERROR
3B44 EC2B             (         mapl.asm):03803                 LDD     11,Y                              ;GET SSR NUMBER
3B46 F73B53           (         mapl.asm):03804                 STB     OSSRNO+1        SET IT
3B49 EC29             (         mapl.asm):03805                 LDD     9,Y                               ;GET A,B
3B4B AE27             (         mapl.asm):03806                 LDX     7,Y                               ;GET X
3B4D EE23             (         mapl.asm):03807                 LDU     3,Y                               ;GET 'U'
3B4F 10AE25           (         mapl.asm):03808                 LDY     5,Y                               ;GET 'Y'
3B52                  (         mapl.asm):03809         OSSRNO
3B52 3F               (         mapl.asm):03810                 SWI
3B53 00               (         mapl.asm):03811                 FCB     0                                 ;SYSTEM REQUEST
3B54 3411             (         mapl.asm):03812                 PSHS    CC,X                              ;SAVE REGS
3B56 AE65             (         mapl.asm):03813                 LDX     5,S                               ;GET PTR TO DATA
3B58 EF03             (         mapl.asm):03814                 STU     3,X                               ;SAVE 'U'
3B5A 10AF05           (         mapl.asm):03815                 STY     5,X                               ;SAVE 'Y'
3B5D ED09             (         mapl.asm):03816                 STD     9,X                               ;SAVE 'A'+'B'
3B5F 1F89             (         mapl.asm):03817                 TFR     A,B                               ;B = RC
3B61 3521             (         mapl.asm):03818                 PULS    CC,Y                              ;RESTORE REGS
3B63 2601             (         mapl.asm):03819                 BNE     OSSR                              ;NON-ZERO
3B65 5F               (         mapl.asm):03820                 CLRB
3B66                  (         mapl.asm):03821         OSSR
3B66 4F               (         mapl.asm):03822                 CLRA                                      ;     ZERO HIGH
3B67 ED0B             (         mapl.asm):03823                 STD     11,X                              ;SET RC
3B69 10AF07           (         mapl.asm):03824                 STY     7,X                               ;SET 'X' VALUE
3B6C 39               (         mapl.asm):03825                 RTS
                      (         mapl.asm):03826         ;* ACCESSING A FILE
3B6D                  (         mapl.asm):03827         OSFILE
3B6D 3303             (         mapl.asm):03828                 LEAU    3,X                               ;SET UP FILE PTR
3B6F A6A0             (         mapl.asm):03829                 LDA     ,Y+                               ;TEST TYPE
3B71 2616             (         mapl.asm):03830                 BNE     OSFFUN                            ;FILE FUNCTIONS
                      (         mapl.asm):03831         ;* WRITE FILE
3B73 AEA0             (         mapl.asm):03832                 LDX     ,Y+                               ;GET LENGTH
3B75 270C             (         mapl.asm):03833                 BEQ     OSWR2                             ;NULL LINE
3B77                  (         mapl.asm):03834         OSWR1
3B77 1F10             (         mapl.asm):03835                 TFR     X,D                               ;COPY IT
3B79 A6AB             (         mapl.asm):03836                 LDA     D,Y                               ;GET CHARACTER
3B7B 3F               (         mapl.asm):03837                 SWI
3B7C 3D               (         mapl.asm):03838                 FCB     61                                ;WRITE CHAR
3B7D 265E             (         mapl.asm):03839                 BNE     OSAVR2                            ;ERROR, RETURN CODE
3B7F 301F             (         mapl.asm):03840                 LEAX    -1,X                              ;REDUCE COUNT
3B81 26F4             (         mapl.asm):03841                 BNE     OSWR1                             ;AND CONTINUE
3B83                  (         mapl.asm):03842         OSWR2
3B83 860D             (         mapl.asm):03843                 LDA     #$0D                              ;CR
3B85 3F               (         mapl.asm):03844                 SWI
3B86 3D               (         mapl.asm):03845                 FCB     61                                ;WRITE CHARACTER
3B87 2054             (         mapl.asm):03846                 BRA     OSAVR2                            ;AND EXIT
                      (         mapl.asm):03847         ;* OTHER FILE FUNCTIONS
3B89                  (         mapl.asm):03848         OSFFUN
3B89 ECA1             (         mapl.asm):03849                 LDD     ,Y++                              ;GET LENGTH
3B8B 10830001         (         mapl.asm):03850                 CMPD    #1                                ;PROPER?
3B8F 1026F772         (         mapl.asm):03851                 LBNE    CLEN                              ;NO
3B93 ECA4             (         mapl.asm):03852                 LDD     ,Y                                ;GET VALUE
3B95 4D               (         mapl.asm):03853                 TSTA
3B96 1026F772         (         mapl.asm):03854                 LBNE    CDOM                              ;OUT OF RAMGE
                      (         mapl.asm):03855         ;* READ DATA FILE FILE
3B9A 5D               (         mapl.asm):03856                 TSTB                                      ;     ZERO?
3B9B 263B             (         mapl.asm):03857                 BNE     OSFCLO                            ;CLOSE FILE
3B9D 6F3D             (         mapl.asm):03858                 CLR     -3,Y                              ;INDICATE CHARACTER
3B9F 8EFFFF           (         mapl.asm):03859                 LDX     #-1                               ;START WITH -1
3BA2                  (         mapl.asm):03860         OSRE1
3BA2 3F               (         mapl.asm):03861                 SWI
3BA3 3B               (         mapl.asm):03862                 FCB     59                                ;READ CHARACTER FROM FILE
3BA4 2637             (         mapl.asm):03863                 BNE     OSAVR2                            ;ERROR
3BA6 A7A0             (         mapl.asm):03864                 STA     ,Y+                               ;SAVE IN DATA AREA
3BA8 3001             (         mapl.asm):03865                 LEAX    1,X                               ;INCREASE LENGTH
3BAA 810D             (         mapl.asm):03866                 CMPA    #$0D                              ;CR?
3BAC 26F4             (         mapl.asm):03867                 BNE     OSRE1                             ;CONTINUE
3BAE 10AE62           (         mapl.asm):03868                 LDY     2,S                               ;GET PTR BACK
3BB1 AF21             (         mapl.asm):03869                 STX     1,Y                               ;SET LENGTH
                      (         mapl.asm):03870         ;* ROTATE OPERAND VALUE(Y)
3BB3                  (         mapl.asm):03871         OSROT
3BB3 3420             (         mapl.asm):03872                 PSHS    Y                                 ;SAVE REGISTERS
3BB5 6DA4             (         mapl.asm):03873                 TST     ,Y                                ;WHAT FORM ARE WE
3BB7 1026F751         (         mapl.asm):03874                 LBNE    CDOM                              ;REVERSING CHARACTER ARRAY
3BBB EC21             (         mapl.asm):03875                 LDD     1,Y                               ;GET LENGTH
3BBD 2717             (         mapl.asm):03876                 BEQ     OSREND                            ;NOTHING TO DO
3BBF 3023             (         mapl.asm):03877                 LEAX    3,Y                               ;GET START OF VECTOR
3BC1 318B             (         mapl.asm):03878                 LEAY    D,X                               ;SKIP TO END
3BC3 1F23             (         mapl.asm):03879                 TFR     Y,U                               ;COPY IT
3BC5                  (         mapl.asm):03880         OSREV
3BC5 A6A2             (         mapl.asm):03881                 LDA     ,-Y                               ;GET CHARACTER
3BC7 E680             (         mapl.asm):03882                 LDB     ,X+                               ;AND GET OTHER CHARACTER
3BC9 3410             (         mapl.asm):03883                 PSHS    X                                 ;SAVE POSITION
3BCB 10ACE1           (         mapl.asm):03884                 CMPY    ,S++                              ;ARE WE THERE?
3BCE 2506             (         mapl.asm):03885                 BLO     OSREND                            ;IF SO, EXIT
3BD0 E7A4             (         mapl.asm):03886                 STB     ,Y                                ;SET NEW VALUE
3BD2 A71F             (         mapl.asm):03887                 STA     -1,X                              ;AND NEW VALUE HERE
3BD4 20EF             (         mapl.asm):03888                 BRA     OSREV                             ;CONTINUE REVERSING
3BD6                  (         mapl.asm):03889         OSREND
3BD6 35A0             (         mapl.asm):03890                 PULS    Y,PC                              ;RESTORE REGISTERS
                      (         mapl.asm):03891         ;* CLOSE FILE
3BD8                  (         mapl.asm):03892         OSFCLO
3BD8 5A               (         mapl.asm):03893                 DECB
3BD9 2605             (         mapl.asm):03894                 BNE     OSFREW                            ;TRY REWIND
3BDB 3F               (         mapl.asm):03895                 SWI
3BDC 39               (         mapl.asm):03896                 FCB     57                                ;CLOSE FILE
3BDD                  (         mapl.asm):03897         OSAVR2
3BDD 16FEA7           (         mapl.asm):03898                 LBRA    OSAVRC                            ;AND RETURN
                      (         mapl.asm):03899         ;* REWIND FILE
3BE0                  (         mapl.asm):03900         OSFREW
3BE0 5A               (         mapl.asm):03901                 DECB
3BE1 1026F727         (         mapl.asm):03902                 LBNE    CDOM                              ;NOT REWIND, EXIT
3BE5 3F               (         mapl.asm):03903                 SWI
3BE6 3E               (         mapl.asm):03904                 FCB     62                                ;REWIND FILE
3BE7 20F4             (         mapl.asm):03905                 BRA     OSAVR2                            ;RETURN CODE

Symbol Table:
[ G] ADROP                            2A9D
[ G] APL                              2000
[ G] ASC0                             2742
[ G] ASC1                             2799
[ G] ASC2                             275C
[ G] ASC3                             2769
[ G] ASC4                             277B
[ G] ASC5                             279E
[ G] ASC6                             27AA
[ G] ASC7                             27BB
[ G] ASC8                             2749
[ G] ASI1                             3208
[ G] ASI2                             3254
[ G] ASI3                             3245
[ G] ASI4                             325C
[ G] ASN1                             31B1
[ G] ASN2                             31BE
[ G] ASN8                             31D9
[ G] ASN89                            31CD
[ G] ASN9                             31C5
[ G] ASSFLG                           3CA4
[ G] ASSIGN                           3194
[ G] ATOM                             306F
[ G] AV1                              307B
[ G] BADSYM                           24D6
[ G] BRANCH                           2866
[ G] BREAK                            33CF
[ G] BRK0                             33E6
[ G] BRKMSG                           339B
[ G] BUFSIZ                           4006
[ G] CALL1                            331B
[ G] CALLEN                           3313
[ G] CCHK                             336B
[ G] CDOM                             330C
[ G] CEQ1                             2CC6
[ G] CEQ2                             2CAC
[ G] CEQ3                             2D27
[ G] CEQ4                             2CE2
[ G] CEQ5                             2D02
[ G] CEQ6                             2D3A
[ G] CEQ7                             2D44
[ G] CEQU                             2CA2
[ G] CEQU1                            2CD7
[ G] CEQU2                            2CF1
[ G] CHKENT                           250E
[ G] CHKV                             251A
[ G] CHRI                             2FB1
[ G] CHRI1                            2FB9
[ G] CHRMV                            3344
[ G] CHROK                            244E
[ G] CHROUT                           2EEB
[ G] CID                              206C
[ G] CIDX                             2FDA
[ G] CL2                              3361
[ G] CL3                              3365
[ G] CL4                              3373
[ G] CL5                              3359
[ G] CLALL                            38C6
[ G] CLEAR                            2027
[ G] CLEN                             3305
[ G] CLER1                            202C
[ G] CLMSG                            2069
[ G] CLOOK                            3357
[ G] CLRGO                            2046
[ G] CMD                              2080
[ G] CMD1                             2108
[ G] CMDTAB                           39D5
[ G] CMP1                             28B5
[ G] CMP2                             28CD
[ G] CMP3                             28DE
[ G] CMP4                             2907
[ G] CMP5                             291A
[ G] CMP6                             28F7
[ G] CMP9                             28EE
[ G] CMPA                             28AD
[ G] CMPB                             28BC
[ G] CMPC                             28D4
[ G] CMPD                             28E4
[ G] CMPE                             290D
[ G] CMPF                             2921
[ G] CMPZ                             28FD
[ G] CON1                             29F7
[ G] CON2                             29EF
[ G] CON3                             29FC
[ G] CON4                             29FE
[ G] CONCMD                           35FE
[ G] CONTIN                           3A4C
[ G] CPYF1                            21A1
[ G] CPYFUN                           2191
[ G] CRE1                             255E
[ G] CRE2                             256A
[ G] CRE3                             256B
[ G] CRE4                             2579
[ G] CRED1                            215F
[ G] CRESYM                           2554
[ G] CREV                             26C8
[ G] CSYNT                            292E
[ G] DCEQU                            2D4B
[ G] DCNEQ                            2D56
[ G] DCR0                             2D5C
[ G] DCR1                             2D51
[ G] DEC1                             2F06
[ G] DEC2                             2F15
[ G] DECOUT                           2EFE
[ G] DECS                             2835
[ G] DECS1                            285B
[ G] DECS2                            2831
[ G] DEFCLR                           2043
[ G] DEFERR                           2128
[ G] DEFNAM                           3A41
[ G] DEL1                             23C7
[ G] DEL2                             23D1
[ G] DEL3                             23D9
[ G] DELCHR                           2428
[ G] DELETE                           23C3
[ G] DETD3                            2509
[ G] DIS1                             2EDE
[ G] DIS2                             2EF3
[ G] DISP                             2219
[ G] DISPLY                           2ECC
[ G] DIV                              25AC
[ G] DIV1                             25B4
[ G] DIV2                             25B6
[ G] DIV3                             25CB
[ G] DIVREM                           3C9C
[ G] DOD1                             2D65
[ G] DOD2                             2D73
[ G] DODYA                            2D75
[ G] DODYA1                           2C94
[ G] DOEX1                            2660
[ G] DOEXPR                           2616
[ G] DOMAIN                           3405
[ G] DOMMSG                           3387
[ G] DORES1                           38B8
[ G] DOREST                           38B3
[ G] DOSENT                           36C2
[ G] DOTAB                            2DEF
[ G] DROP                             210B
[ G] DRP1                             2AC2
[ G] DS71                             27FB
[ G] DS72                             280B
[ G] DSIP1                            2662
[ G] DSIP2                            2673
[ G] DSIP3                            26A4
[ G] DSIP4                            26DF
[ G] DSIP5                            271A
[ G] DSIP6                            272C
[ G] DSIP7                            27DB
[ G] DSIP8                            2816
[ G] DSP1                             245C
[ G] DSP2                             2464
[ G] DSPLIN                           2365
[ G] DSPNAM                           3483
[ G] DSPSTR                           245A
[ G] DWSID                            3720
[ G] DYADD                            2E14
[ G] DYADIC                           29C0
[ G] DYAND                            2E60
[ G] DYCEIL                           2E4B
[ G] DYDIV                            2E2C
[ G] DYEQ                             2EA4
[ G] DYFLOR                           2E57
[ G] DYFNS                            2D60
[ G] DYGE                             2E8D
[ G] DYGT                             2E7B
[ G] DYLE                             2E97
[ G] DYLT                             2E84
[ G] DYMOD                            2E3D
[ G] DYMUL                            2E22
[ G] DYNE                             2EAD
[ G] DYOR                             2E69
[ G] DYRTS                            2E56
[ G] DYSUB                            2E1B
[ G] DYSWP                            2E52
[ G] DYXOR                            2E72
[ G] EDC1                             222D
[ G] EDC2                             2203
[ G] EDC3                             2216
[ G] EDC4                             2248
[ G] EDC5                             2245
[ G] EDCMD                            21F0
[ G] EDCP                             228D
[ G] EDCX                             228A
[ G] EDCZ                             2261
[ G] EDIT                             2119
[ G] EDTLIN                           21A7
[ G] EDTRUN                           21A5
[ G] EDX1                             218A
[ G] EFUN1                            3584
[ G] EFUN2                            35BF
[ G] EFUN3                            359A
[ G] EFUN4                            35C5
[ G] EFUN5                            35D6
[ G] EFUN6                            35D1
[ G] EFUNC                            3580
[ G] EFUPOT                           359E
[ G] ENDEXP                           2653
[ G] ENDST                            254F
[ G] ENM1                             2470
[ G] EQU1                             2C97
[ G] EQU9                             2D17
[ G] EQUTST                           2C6F
[ G] ERANXT                           37FB
[ G] ERASE                            37B0
[ G] ERASYM                           37DD
[ G] ERR0                             3436
[ G] ERR01                            344C
[ G] ERR1                             344D
[ G] ERR2                             345A
[ G] ERR3                             3466
[ G] ERR4                             346E
[ G] ERR5                             3458
[ G] ERR9                             3476
[ G] ERRDEF                           21DC
[ G] ERRFLG                           3CA5
[ G] ERROR                            3412
[ G] ERRP                             3489
[ G] EX1                              2614
[ G] EXEC                             3C83
[ G] EXEX                             25F3
[ G] EXEXE                            2604
[ G] EXP1                             262A
[ G] EXPR                             25ED
[ G] EXTSPC                           2385
[ G] FIL1                             25D2
[ G] FIL2                             25DC
[ G] FILNAM                           25D0
[ G] FND1                             239D
[ G] FND2                             23AC
[ G] FND3                             23BA
[ G] FND4                             23BE
[ G] FNDEOF                           23DB
[ G] FNDL1                            2399
[ G] FNDLIN                           2396
[ G] FNGO                             3506
[ G] FNGOX                            353A
[ G] FNGOZ                            352A
[ G] FNS                              361B
[ G] FNS1                             362C
[ G] FNS2                             3676
[ G] FNS3                             367F
[ G] FNS4                             3688
[ G] FNS5                             368B
[ G] FNS6                             368C
[ G] FNS7                             369A
[ G] FNS8                             36AB
[ G] FNST1                            3617
[ G] FNXLIN                           3540
[ G] FREE                             4000
[ G] FREMEM                           4008
[ G] FREOFF                           3813
[ G] FRMOUT                           31FD
[ G] FUNC                             34A0
[ G] FUNFND                           2170
[ G] FUNGT                            3509
[ G] FUNVAL                           2EB6
[ G] GET1                             2410
[ G] GETC2                            300B
[ G] GETC3                            301D
[ G] GETC4                            3027
[ G] GETC5                            3017
[ G] GETCHR                           2442
[ G] GETD1                            24E1
[ G] GETD2                            24FD
[ G] GETDEC                           24D7
[ G] GETDIG                           24D9
[ G] GETLF                            2408
[ G] GETLIN                           240B
[ G] GETN0                            2FE1
[ G] GETN1                            2FEF
[ G] GETPRM                           2F22
[ G] GETRAM                           2402
[ G] GETV0                            2F49
[ G] GETV1                            3000
[ G] GETV2                            3032
[ G] GETV3                            3092
[ G] GETV4                            30C8
[ G] GETV5                            30AC
[ G] GETV6                            30C2
[ G] GETV7                            30BF
[ G] GETV9                            302A
[ G] GETVAL                           2F30
[ G] GOT1                             3561
[ G] GOTO                             3C98
[ G] GOTOK                            355B
[ G] HIRAM                            CC00
[ G] IASS                             3268
[ G] ID                               3CA8
[ G] IDA0                             32B2
[ G] IDA1                             32B6
[ G] IDA2                             32E4
[ G] IDA3                             32F6
[ G] INCLIN                           21D2
[ G] INDEX                            340F
[ G] INDMSG                           3395
[ G] INIWS                            20AA
[ G] INN1                             3114
[ G] INN2                             313E
[ G] INNP3                            315F
[ G] INNUM                            310E
[ G] INPBRK                           2436
[ G] INPSTK                           3CA6
[ G] INS1                             23E5
[ G] INS2                             23F0
[ G] INS3                             23FA
[ G] INSERT                           23E2
[ G] INTER                            30EA
[ G] INTER1                           3102
[ G] INTER2                           310A
[ G] INW0                             3640
[ G] INW1                             3648
[ G] INW2                             365F
[ G] INW3                             3657
[ G] INW4                             3668
[ G] INW5                             3659
[ G] IOT1                             2694
[ G] IOTA0                            3A3E
[ G] IOTZ                             269F
[ G] KREAD                            30D8
[ G] LBLS                             360B
[ G] LCV1                             3502
[ G] LCVAR                            34E4
[ G] LDGO                             20C5
[ G] LENGTH                           340A
[ G] LENMSG                           338E
[ G] LEVEL                            3C82
[ G] LFCR                             2472
[ G] LGOTO                            31DE
[ G] LIB                              36C8
[ G] LIB1                             36D3
[ G] LIB2                             36D6
[ G] LIB3                             36F1
[ G] LINCT                            3C96
[ G] LOA1                             20CC
[ G] LOA2                             20DD
[ G] LOAD                             20BA
[ G] LOOKUP                           250B
[ G] LXNAME                           3A4A
[ G] MEMBER                           2B4A
[ G] MEMC0                            2BB0
[ G] MEMC1                            2BB3
[ G] MEMC2                            2BB5
[ G] MEMCHR                           2B9F
[ G] MEMCX                            2BA8
[ G] MEMEND                           2BC4
[ G] MEML0                            2B89
[ G] MEML1                            2B8C
[ G] MEML2                            2B8E
[ G] MEMLP                            2B77
[ G] MEMLX                            2B80
[ G] MULT                             258C
[ G] MV1                              3336
[ G] MVRTS                            3352
[ G] MVWRK                            331F
[ G] NAMOK                            2139
[ G] NAMPTR                           3C9A
[ G] NEWV                             3232
[ G] NOBRA                            2881
[ G] NOC1                             244F
[ G] NOER1                            22D8
[ G] NOESPC                           2388
[ G] NOEXEC                           280E
[ G] NOFUNE                           35BB
[ G] NOINT1                           357B
[ G] NOLF                             36B1
[ G] NOLOKI                           2323
[ G] NOMOVE                           3868
[ G] NOSUSP                           38A3
[ G] NOSYM                            2543
[ G] NOTF1                            37DA
[ G] NOTFNS                           37CD
[ G] NOTSI                            3733
[ G] NULOUT                           2EFC
[ G] NUMI                             2F8E
[ G] NV1                              2FAD
[ G] NXTOPR                           2636
[ G] OFF                              3605
[ G] OKDISP                           3429
[ G] OKRTS                            249C
[ G] OPSYS                            2C58
[ G] ORIGIN                           4002
[ G] OSAVR2                           3BDD
[ G] OSAVRC                           3A87
[ G] OSEND                            DBFF
[ G] OSFCLO                           3BD8
[ G] OSFFUN                           3B89
[ G] OSFILE                           3B6D
[ G] OSFNF                            3A6A
[ G] OSFREW                           3BE0
[ G] OSFUNC                           3A59
[ G] OSOPEN                           3A9A
[ G] OSOPW                            3AB6
[ G] OSRAM                            2000
[ G] OSRC1                            3A8E
[ G] OSRCZ                            3A8D
[ G] OSRE1                            3BA2
[ G] OSREND                           3BD6
[ G] OSRES                            3A8F
[ G] OSREV                            3BC5
[ G] OSRM1                            3AF5
[ G] OSRM2                            3AD1
[ G] OSRMEM                           3AE4
[ G] OSROT                            3BB3
[ G] OSSR                             3B66
[ G] OSSRNO                           3B52
[ G] OSSSR                            3B35
[ G] OSTFIL                           3AD2
[ G] OSUTIL                           D000
[ G] OSWM1                            3B1F
[ G] OSWMEM                           3B07
[ G] OSWR1                            3B77
[ G] OSWR2                            3B83
[ G] OULI                             238A
[ G] OULX                             2395
[ G] PARM                             3C94
[ G] PROCMD                           2105
[ G] PUTCHR                           2478
[ G] PUTOUT                           247C
[ G] RAM                              3C00
[ G] RAMTOP                           3CA2
[ G] RE2                              22DB
[ G] REBRK                            33A5
[ G] RED1                             2984
[ G] RED2                             2961
[ G] RED3                             297F
[ G] RED4                             2979
[ G] RED5                             29A2
[ G] RED6                             29BA
[ G] RED8                             299B
[ G] RED9                             2992
[ G] REDUC                            2935
[ G] REL1                             3899
[ G] RELEAS                           388F
[ G] RESAVE                           22B1
[ G] RESET                            207D
[ G] RET0                             2E94
[ G] RET1                             2E9E
[ G] RETX                             2EA0
[ G] REV1                             26B8
[ G] REV2                             26DA
[ G] REV3                             26CA
[ G] RIF0                             22EC
[ G] RIF1                             22EE
[ G] RIF2                             2307
[ G] RIF3                             230E
[ G] RIF4                             232D
[ G] RIF5                             2345
[ G] RIF6                             2351
[ G] RMS1                             3825
[ G] RMS11                            3835
[ G] RMS2                             384B
[ G] RMS3                             385B
[ G] RMSYM                            381B
[ G] RND1                             26F0
[ G] RND2                             2715
[ G] RND3                             270D
[ G] ROM                              2000
[ G] SAV1                             3777
[ G] SAV2                             37A4
[ G] SAV3                             3768
[ G] SAV4                             3771
[ G] SAV5                             377A
[ G] SAV6                             3751
[ G] SAV7                             375D
[ G] SAVE                             3743
[ G] SAVFRE                           3864
[ G] SAVSTK                           3CA0
[ G] SEARCH                           2A08
[ G] SEED                             4004
[ G] SER1                             2A88
[ G] SER2                             2A49
[ G] SER3                             2A58
[ G] SER5                             2A5D
[ G] SER6                             2A96
[ G] SER7                             2A83
[ G] SER8                             2A6E
[ G] SFN1                             24AA
[ G] SFNUM                            24A8
[ G] SFS1                             24B7
[ G] SFSYM                            24B5
[ G] SI                               3869
[ G] SI1                              3879
[ G] SKBK                             249F
[ G] SKBKP                            249D
[ G] SKIP                             248E
[ G] SKP                              2483
[ G] SPACE                            247F
[ G] SRCSY                            3620
[ G] STACK                            4000
[ G] STATUS                           38D9
[ G] STSY1                            3918
[ G] STSYM                            390B
[ G] SY1                              2468
[ G] SY5                              3082
[ G] SYMSG                            337A
[ G] SYMTAB                           400A
[ G] SYNTAX                           33FB
[ G] SYS1                             3048
[ G] SYS2                             3051
[ G] SYS3                             305D
[ G] SYS4                             3066
[ G] SYS9                             3089
[ G] SYSERR                           399C
[ G] SYSMSG                           2466
[ G] SYSPRM                           30CC
[ G] SYST1                            36C4
[ G] SYSTEM                           36B2
[ G] SYSX                             308B
[ G] SYSX1                            30E8
[ G] TAK1                             2B0E
[ G] TAK12                            2B1E
[ G] TAK2                             2B28
[ G] TAK3                             2B20
[ G] TAK4                             2B30
[ G] TAK41                            2B40
[ G] TAK5                             2B42
[ G] TAKE                             2AC9
[ G] TEMP                             3C84
[ G] TEMP0                            3C86
[ G] TEMP1                            3C88
[ G] TEMP2                            3C8A
[ G] TEMP3                            3C8C
[ G] TEMP4                            3C8E
[ G] TEMP5                            3C90
[ G] TEROUT                           31F1
[ G] TRAVEL                           2887
[ G] TSC2                             2DD8
[ G] TSCAL2                           2DC7
[ G] TSCALE                           2DAB
[ G] TSL2                             2DB6
[ G] TXTPTR                           3C9E
[ G] TXTTMP                           3C92
[ G] UNCMD                            3986
[ G] VALMSG                           3381
[ G] VALNUM                           24C2
[ G] VALOK                            24D4
[ G] VALSYM                           24CC
[ G] VALUE                            3400
[ G] VARS                             3612
[ G] WSFUL                            33EE
[ G] WSID                             36F2
[ G] WSID1                            3719
[ G] WSID2                            3718
[ G] WSID3                            3711
[ G] WSID4                            3725
[ G] WSID5                            372F
[ G] WSISET                           370C
[ G] XLAC0                            2C38
[ G] XLAC1                            2C3E
[ G] XLACHR                           2C27
[ G] XLACX                            2C30
[ G] XLAEND                           2C53
[ G] XLAL0                            2C0A
[ G] XLAL1                            2C10
[ G] XLALP                            2BF8
[ G] XLALX                            2C01
[ G] XLATE                            2BC9
[ G] ZX1                              2D93
[ G] ZX2                              2DA6
