                      (     ttypatch.asm):00001         ;        TITLE   TERMINAL DEFINITION EDITOR
                      (     ttypatch.asm):00002         ;*
                      (     ttypatch.asm):00003         ;* TTYPATCH: Terminal definition editor
                      (     ttypatch.asm):00004         ;*
                      (     ttypatch.asm):00005         ;* Copyright 1983-2005 Dave Dunfield
                      (     ttypatch.asm):00006         ;* All rights reserved.
                      (     ttypatch.asm):00007         ;*
     2000             (     ttypatch.asm):00008         OSRAM           = $2000                           ;APPLICATION RAM AREA
     DBFF             (     ttypatch.asm):00009         OSEND           = $DBFF                           ;END OF GENERAL RAM
     D000             (     ttypatch.asm):00010         OSUTIL          = $D000                           ;UTILITY ADDRESS SPACE
     0019             (     ttypatch.asm):00011         NSIZE           = 25                              ;MAXIMUM NAME WIDTH
     0019             (     ttypatch.asm):00012         ISIZE           = 25                              ;MAXIMUM ITEM SIZE
     000D             (     ttypatch.asm):00013         INUM            = 13                              ;# INPUT ENTRIES
     000F             (     ttypatch.asm):00014         FNUM            = 15                              ;# FUNCTION ENTRIES
     0008             (     ttypatch.asm):00015         ONUM            = 8                               ;# OUTPUT ENTRIES
                      (     ttypatch.asm):00016         ;*
                      (     ttypatch.asm):00017                 ORG     0
0000                  (     ttypatch.asm):00018         DPREFIX
0000                  (     ttypatch.asm):00019                 RMB     8                                 ;DIRECTORY PREFIX
0008                  (     ttypatch.asm):00020         FNAME
0008                  (     ttypatch.asm):00021                 RMB     8                                 ;FILE NAME
0010                  (     ttypatch.asm):00022         FTYPE
0010                  (     ttypatch.asm):00023                 RMB     3                                 ;FILE TYPE
0013                  (     ttypatch.asm):00024         DSKADR
0013                  (     ttypatch.asm):00025                 RMB     2                                 ;DISK SECTOR ADDRESS
0015                  (     ttypatch.asm):00026         LODADR
0015                  (     ttypatch.asm):00027                 RMB     2                                 ;LOAD ADDRESS
0017                  (     ttypatch.asm):00028         FPROT
0017                  (     ttypatch.asm):00029                 RMB     1                                 ;PROTECTION BITS
                      (     ttypatch.asm):00030         ;*
                      (     ttypatch.asm):00031                 ORG     $2000
2000 813F             (     ttypatch.asm):00032                 CMPA    #'?'                              ;QUESTION?
2002 2612             (     ttypatch.asm):00033                 BNE     MAIN                              ;NO, ITS OK
2004 3F               (     ttypatch.asm):00034                 SWI
2005 19               (     ttypatch.asm):00035                 FCB     25                                ;DISPLAY MESSAGE
2006 5573653A20747479 (     ttypatch.asm):00036                 FCN     'Use: ttypatch'
     706174636800
2014 3F               (     ttypatch.asm):00037                 SWI
2015 00               (     ttypatch.asm):00038                 FCB     0
2016                  (     ttypatch.asm):00039         MAIN
2016 3F               (     ttypatch.asm):00040                 SWI
2017 19               (     ttypatch.asm):00041                 FCB     25                                ;DISPLAY MESSAGE
2018 20202020202A2A2A (     ttypatch.asm):00042                 FCC     '     *** TTY patch utility ***'
     2054545920706174
     6368207574696C69
     7479202A2A2A
2036 0A0D             (     ttypatch.asm):00043                 FCB     $0A,$0D
2038 4361727269616765 (     ttypatch.asm):00044                 FCC     'Carriage-return to exit a Sub-Menu'
     2D72657475726E20
     746F206578697420
     61205375622D4D65
     6E75
205A 0A00             (     ttypatch.asm):00045                 FCB     $0A,0
                      (     ttypatch.asm):00046         ;* ZERO INITIALIZED DATA
205C                  (     ttypatch.asm):00047         MAIN1
205C BD21C7           (     ttypatch.asm):00048                 JSR     CLRAM
                      (     ttypatch.asm):00049         ;* MAIN MENU
205F                  (     ttypatch.asm):00050         MAIN2
205F 10CE2A81         (     ttypatch.asm):00051                 LDS     #STACK                            ;POINT TO STACK
2063 8E23F1           (     ttypatch.asm):00052                 LDX     #MMENU                            ;POINT TO MAIN MENU
2066 C631             (     ttypatch.asm):00053                 LDB     #'1'                              ;ZERO COUNT
2068                  (     ttypatch.asm):00054         MAIN3
2068 A684             (     ttypatch.asm):00055                 LDA     ,X                                ;MORE DATA
206A 2717             (     ttypatch.asm):00056                 BEQ     MAIN4                             ;NO, NONE
206C 3F               (     ttypatch.asm):00057                 SWI
206D 18               (     ttypatch.asm):00058                 FCB     24                                ;OUTPUT STRING
206E 20202000         (     ttypatch.asm):00059                 FCN     '   '                             ;SPACE OVER MENU
2072 1F98             (     ttypatch.asm):00060                 TFR     B,A                               ;GET VALUE
2074 3F               (     ttypatch.asm):00061                 SWI
2075 21               (     ttypatch.asm):00062                 FCB     33                                ;OUTPUT
2076 3F               (     ttypatch.asm):00063                 SWI
2077 18               (     ttypatch.asm):00064                 FCB     24                                ;OUTPUT STRING
2078 202D2000         (     ttypatch.asm):00065                 FCN     ' - '
207C 3F               (     ttypatch.asm):00066                 SWI
207D 17               (     ttypatch.asm):00067                 FCB     23                                ;DISPLAY TEXT
207E 3F               (     ttypatch.asm):00068                 SWI
207F 16               (     ttypatch.asm):00069                 FCB     22                                ;NEW LINE
2080 5C               (     ttypatch.asm):00070                 INCB                                      ;     ADVANCE COUNT
2081 20E5             (     ttypatch.asm):00071                 BRA     MAIN3                             ;AND DO NEXT
2083                  (     ttypatch.asm):00072         MAIN4
2083 3F               (     ttypatch.asm):00073                 SWI
2084 18               (     ttypatch.asm):00074                 FCB     24                                ;OUTPUT STRING
2085 46756E6374696F6E (     ttypatch.asm):00075                 FCN     'Function? '
     3F2000
2090 3F               (     ttypatch.asm):00076                 SWI
2091 22               (     ttypatch.asm):00077                 FCB     34                                ;GET CHAR
                      (     ttypatch.asm):00078         ;* FUNCTION SELECTED
2092                  (     ttypatch.asm):00079         MAIN5
2092 3F               (     ttypatch.asm):00080                 SWI
2093 21               (     ttypatch.asm):00081                 FCB     33                                ;ECHO
2094 3F               (     ttypatch.asm):00082                 SWI
2095 16               (     ttypatch.asm):00083                 FCB     22                                ;NEW LINE
                      (     ttypatch.asm):00084         ;* '1' - INPUT KEYS
2096 8031             (     ttypatch.asm):00085                 SUBA    #'1'                              ;CONVERT
2098 2608             (     ttypatch.asm):00086                 BNE     MAIN6                             ;NO, TRY NEXT
209A 8E2527           (     ttypatch.asm):00087                 LDX     #INAMES                           ;POINT TO INPUT NAMES
209D CE2699           (     ttypatch.asm):00088                 LDU     #IDATA                            ;POINT TO DATA AREA
20A0 2014             (     ttypatch.asm):00089                 BRA     SUBMEN                            ;DO SUBMENU
                      (     ttypatch.asm):00090         ;* '2' - FUNCTION KEYS
20A2                  (     ttypatch.asm):00091         MAIN6
20A2 4A               (     ttypatch.asm):00092                 DECA                                      ;     DEFINE FUNCTION?
20A3 2608             (     ttypatch.asm):00093                 BNE     MAIN7                             ;NO, TRY NEXT
20A5 8E25AE           (     ttypatch.asm):00094                 LDX     #FNAMES                           ;POINT TO NAMES
20A8 CE27DE           (     ttypatch.asm):00095                 LDU     #FDATA                            ;POINT TO DATA
20AB 2009             (     ttypatch.asm):00096                 BRA     SUBMEN                            ;DO SUB MENU
                      (     ttypatch.asm):00097         ;* '3' - OUTPUT STRINGS
20AD                  (     ttypatch.asm):00098         MAIN7
20AD 4A               (     ttypatch.asm):00099                 DECA                                      ;     DEFINE OUTPUT?
20AE 260E             (     ttypatch.asm):00100                 BNE     MAIN9                             ;NO, TRY NEXT
20B0 8E2487           (     ttypatch.asm):00101                 LDX     #ONAMES                           ;POINT TO PUTPUT NAMES
20B3 CE2955           (     ttypatch.asm):00102                 LDU     #ODATA                            ;POINT TO OUTPUT DATA
20B6                  (     ttypatch.asm):00103         SUBMEN
20B6 86FF             (     ttypatch.asm):00104                 LDA     #-1                               ;INSURE NO XY
20B8 BD21D5           (     ttypatch.asm):00105                 JSR     DMENU                             ;DO THE MENU
20BB 7E205F           (     ttypatch.asm):00106                 JMP     MAIN2                             ;AND RETURN
                      (     ttypatch.asm):00107         ;* '5' - LOAD SETTINGS
20BE                  (     ttypatch.asm):00108         MAIN9
20BE 4A               (     ttypatch.asm):00109                 DECA                                      ;     IS IT LOAD?
20BF 2645             (     ttypatch.asm):00110                 BNE     MAIN10                            ;NO, TRY NEXT
20C1 BD2170           (     ttypatch.asm):00111                 JSR     LDPGM                             ;LOAD THE FILE
                      (     ttypatch.asm):00112         ;* OUTPUT KEYS INTO MEMORY
20C4 BD21C7           (     ttypatch.asm):00113                 JSR     CLRAM                             ;ZERO THE RAM DATABASE
20C7 CE2955           (     ttypatch.asm):00114                 LDU     #ODATA                            ;POINT TO OUTPUT DATA
20CA C608             (     ttypatch.asm):00115                 LDB     #ONUM                             ;GET # ENTRIES
20CC                  (     ttypatch.asm):00116         MAIN9A
20CC 3444             (     ttypatch.asm):00117                 PSHS    B,U                               ;SAVE REG
20CE EC81             (     ttypatch.asm):00118                 LDD     ,X++                              ;GET ADDRESS
20D0 B32696           (     ttypatch.asm):00119                 SUBD    FLOAD                             ;CONVERT
20D3 C32A81           (     ttypatch.asm):00120                 ADDD    #LOAD                             ;TO READ ADDRESS
20D6 1F02             (     ttypatch.asm):00121                 TFR     D,Y                               ;'Y' = PTR TO ENTRY
20D8                  (     ttypatch.asm):00122         MAIN9B
20D8 A6A0             (     ttypatch.asm):00123                 LDA     ,Y+                               ;GET CHAR
20DA A7C0             (     ttypatch.asm):00124                 STA     ,U+                               ;WRITE IT OUT
20DC 2A06             (     ttypatch.asm):00125                 BPL     MAIN9C                            ;ITS OK
20DE A6A0             (     ttypatch.asm):00126                 LDA     ,Y+                               ;GET CHAR
20E0 A7C0             (     ttypatch.asm):00127                 STA     ,U+                               ;WRITE IT OUT
20E2 20F4             (     ttypatch.asm):00128                 BRA     MAIN9B                            ;AND CONTINUE
20E4                  (     ttypatch.asm):00129         MAIN9C
20E4 26F2             (     ttypatch.asm):00130                 BNE     MAIN9B                            ;AND PROCEED
20E6 3544             (     ttypatch.asm):00131                 PULS    B,U                               ;RESTORE 'U'
20E8 33C819           (     ttypatch.asm):00132                 LEAU    ISIZE,U                           ;ADVANCE TO NEXT
20EB 5A               (     ttypatch.asm):00133                 DECB                                      ;     REDUCE COUNT
20EC 26DE             (     ttypatch.asm):00134                 BNE     MAIN9A                            ;KEEP GOING
                      (     ttypatch.asm):00135         ;* COPY INPUT & FUNCTION KEYS
20EE CE2699           (     ttypatch.asm):00136                 LDU     #IDATA                            ;POINT TO INPUT DATA
20F1 C61C             (     ttypatch.asm):00137                 LDB     #INUM+FNUM      GET # KEYS
20F3                  (     ttypatch.asm):00138         MAIN9D
20F3 3440             (     ttypatch.asm):00139                 PSHS    U                                 ;SAVE ENTRY
20F5                  (     ttypatch.asm):00140         MAIN9E
20F5 A680             (     ttypatch.asm):00141                 LDA     ,X+                               ;GET CHAR
20F7 A7C0             (     ttypatch.asm):00142                 STA     ,U+                               ;WRITE IT
20F9 26FA             (     ttypatch.asm):00143                 BNE     MAIN9E                            ;PROCEED
20FB 3540             (     ttypatch.asm):00144                 PULS    U                                 ;RESTORE U
20FD 33C819           (     ttypatch.asm):00145                 LEAU    ISIZE,U                           ;OFFSET BY SIZE
2100 5A               (     ttypatch.asm):00146                 DECB                                      ;     REDUCE COUNT
2101 26F0             (     ttypatch.asm):00147                 BNE     MAIN9D                            ;AND PROCEED
2103 7E205F           (     ttypatch.asm):00148                 JMP     MAIN2                             ;AND PROCEED
                      (     ttypatch.asm):00149         ;* '6' - SAVE SETTINGS
2106                  (     ttypatch.asm):00150         MAIN10
2106 4A               (     ttypatch.asm):00151                 DECA                                      ;     SAVE ?
2107 2652             (     ttypatch.asm):00152                 BNE     MAIN11                            ;NO, TRY NEXT
2109 BD2170           (     ttypatch.asm):00153                 JSR     LDPGM                             ;LOAD PROGRAM INTO RAM
210C 338810           (     ttypatch.asm):00154                 LEAU    ONUM*2,X                          ;'U'= OUTPUT PTR
                      (     ttypatch.asm):00155         ;* COPY INPUT & FUNCTION KEYS
210F 108E2699         (     ttypatch.asm):00156                 LDY     #IDATA                            ;POINT TO INPUT DATA
2113 C61C             (     ttypatch.asm):00157                 LDB     #INUM+FNUM      GET # KEYS
2115                  (     ttypatch.asm):00158         MAIN10A
2115 3420             (     ttypatch.asm):00159                 PSHS    Y                                 ;SAVE FOR LATER
2117                  (     ttypatch.asm):00160         MAIN10B
2117 A6A0             (     ttypatch.asm):00161                 LDA     ,Y+                               ;GET CHAR
2119 A7C0             (     ttypatch.asm):00162                 STA     ,U+                               ;WRITE IT OUT
211B 26FA             (     ttypatch.asm):00163                 BNE     MAIN10B                           ;AND PROCEED
211D 3520             (     ttypatch.asm):00164                 PULS    Y                                 ;RESTORE 'Y'
211F 31A819           (     ttypatch.asm):00165                 LEAY    ISIZE,Y                           ;SKIP IT
2122 5A               (     ttypatch.asm):00166                 DECB                                      ;     REDUCE COUNT
2123 26F0             (     ttypatch.asm):00167                 BNE     MAIN10A                           ;COPY THEM ALL
2125 6FC0             (     ttypatch.asm):00168                 CLR     ,U+                               ;INDICATE END OF INPUTS
                      (     ttypatch.asm):00169         ;* COPY OUTPUT STRINGS
2127 108E2955         (     ttypatch.asm):00170                 LDY     #ODATA                            ;POINT TO OUTPUT DATA
212B C608             (     ttypatch.asm):00171                 LDB     #ONUM                             ;GET # OUTPUTS
212D                  (     ttypatch.asm):00172         MAIN10C
212D 3424             (     ttypatch.asm):00173                 PSHS    B,Y                               ;SAVE REGS
212F 1F30             (     ttypatch.asm):00174                 TFR     U,D                               ;GET ADDRESS
2131 832A81           (     ttypatch.asm):00175                 SUBD    #LOAD                             ;CONVERT TO ZERO OFFSET
2134 F32696           (     ttypatch.asm):00176                 ADDD    FLOAD                             ;CONVERT TO PGM OFFSET
2137 ED81             (     ttypatch.asm):00177                 STD     ,X++                              ;SAVE VECTOR
2139                  (     ttypatch.asm):00178         MAIN10D
2139 A6A0             (     ttypatch.asm):00179                 LDA     ,Y+                               ;GET CHAR
213B A7C0             (     ttypatch.asm):00180                 STA     ,U+                               ;WRITE CHAR
213D 2A06             (     ttypatch.asm):00181                 BPL     MAIN10E                           ;ITS OK
213F A6A0             (     ttypatch.asm):00182                 LDA     ,Y+                               ;GET CHAR
2141 A7C0             (     ttypatch.asm):00183                 STA     ,U+                               ;WRITE IT
2143 20F4             (     ttypatch.asm):00184                 BRA     MAIN10D                           ;AND PROCEED
2145                  (     ttypatch.asm):00185         MAIN10E
2145 26F2             (     ttypatch.asm):00186                 BNE     MAIN10D                           ;DO THEM ALL
2147 3524             (     ttypatch.asm):00187                 PULS    B,Y                               ;RESTORE REGISTER
2149 31A819           (     ttypatch.asm):00188                 LEAY    ISIZE,Y                           ;ADVANCE TO NEXT
214C 5A               (     ttypatch.asm):00189                 DECB                                      ;     REDUCE COUNT
214D 26DE             (     ttypatch.asm):00190                 BNE     MAIN10C                           ;AND PROCEED
                      (     ttypatch.asm):00191         ;* RE-SAVE THE FILE
214F 8E2A81           (     ttypatch.asm):00192                 LDX     #LOAD                             ;POINT TO LOAD ADDRESS
2152 F62698           (     ttypatch.asm):00193                 LDB     FSIZE                             ;GET FILE SIZE
2155 4F               (     ttypatch.asm):00194                 CLRA                                      ;     ZERO HIGH
2156 3F               (     ttypatch.asm):00195                 SWI
2157 36               (     ttypatch.asm):00196                 FCB     54                                ;SAVE THE FILE
2158 7E205F           (     ttypatch.asm):00197                 JMP     MAIN2                             ;AND PROCEED
                      (     ttypatch.asm):00198         ;* EXIT THE PROGRAM
215B                  (     ttypatch.asm):00199         MAIN11
215B 4A               (     ttypatch.asm):00200                 DECA                                      ;     TEST FOR EXIT
215C 2603             (     ttypatch.asm):00201                 BNE     MAIN12                            ;NO, REPORT ERROR
215E 4F               (     ttypatch.asm):00202                 CLRA                                      ;     ZERO RC
215F 3F               (     ttypatch.asm):00203                 SWI
2160 00               (     ttypatch.asm):00204                 FCB     0
                      (     ttypatch.asm):00205         ;*
2161                  (     ttypatch.asm):00206         MAIN12
2161 3F               (     ttypatch.asm):00207                 SWI
2162 19               (     ttypatch.asm):00208                 FCB     25                                ;ISSUE MESSAGE
2163 2A2A4552524F522A (     ttypatch.asm):00209                 FCN     '**ERROR**'
     2A00
216D 7E205F           (     ttypatch.asm):00210                 JMP     MAIN2                             ;AND PROCEED
                      (     ttypatch.asm):00211         ;* LOAD FILE INTO MEMORY
2170                  (     ttypatch.asm):00212         LDPGM
2170 3F               (     ttypatch.asm):00213                 SWI
2171 18               (     ttypatch.asm):00214                 FCB     24                                ;DISPLAY PROMPT
2172 46696C656E616D65 (     ttypatch.asm):00215                 FCN     'Filename? '
     3F2000
217D 3F               (     ttypatch.asm):00216                 SWI
217E 03               (     ttypatch.asm):00217                 FCB     3                                 ;GET INPUT LINE
217F 3F               (     ttypatch.asm):00218                 SWI
2180 04               (     ttypatch.asm):00219                 FCB     4                                 ;MORE DATA?
2181 2741             (     ttypatch.asm):00220                 BEQ     LODERR                            ;NO, EXIT
2183 3F               (     ttypatch.asm):00221                 SWI
2184 0A               (     ttypatch.asm):00222                 FCB     10                                ;GET FILENAME
2185 263D             (     ttypatch.asm):00223                 BNE     LODERR                            ;ERROR
2187 3F               (     ttypatch.asm):00224                 SWI
2188 46               (     ttypatch.asm):00225                 FCB     70                                ;LOCATE FILE
2189 2639             (     ttypatch.asm):00226                 BNE     LODERR                            ;ERROR
218B EC8815           (     ttypatch.asm):00227                 LDD     LODADR,X        GET LOAD ADDRESS
218E FD2696           (     ttypatch.asm):00228                 STD     FLOAD                             ;WRITE IT OUT
2191 EC8813           (     ttypatch.asm):00229                 LDD     DSKADR,X        GET DISK ADDRESS
2194 8E2A81           (     ttypatch.asm):00230                 LDX     #LOAD                             ;GET INPUT ADDRESS
2197 3F               (     ttypatch.asm):00231                 SWI
2198 4E               (     ttypatch.asm):00232                 FCB     78                                ;LOAD CHAIN
2199 1F10             (     ttypatch.asm):00233                 TFR     X,D                               ;'A' = # 256 BYTE BLOCKS
219B 832A81           (     ttypatch.asm):00234                 SUBD    #LOAD                             ;CONVERT TO OFFSET
219E 44               (     ttypatch.asm):00235                 LSRA                                      ;     'A' = # 512 BYTE BLOCKS
219F B72698           (     ttypatch.asm):00236                 STA     FSIZE                             ;SET FILE SIZE
21A2 B62A81           (     ttypatch.asm):00237                 LDA     >LOAD                             ;GET FIRST INST.
21A5 81BE             (     ttypatch.asm):00238                 CMPA    #$BE                              ;IS IT 'LDX >'
21A7 2615             (     ttypatch.asm):00239                 BNE     LODBAD                            ;BAD FILE
21A9 FC2A84           (     ttypatch.asm):00240                 LDD     >LOAD+3                           ;GET FOLLOWING INST
21AC 10833F17         (     ttypatch.asm):00241                 CMPD    #$3F17                            ;IS IT 'SSR 23'
21B0 260C             (     ttypatch.asm):00242                 BNE     LODBAD                            ;BAD FILE
21B2 FC2A82           (     ttypatch.asm):00243                 LDD     LOAD+1                            ;GET ADDRESS
21B5 B32696           (     ttypatch.asm):00244                 SUBD    FLOAD                             ;CONVERT TO ZERO OFFSET
21B8 C32A81           (     ttypatch.asm):00245                 ADDD    #LOAD                             ;OFFSET TO SCREEN POSITION
21BB 1F01             (     ttypatch.asm):00246                 TFR     D,X                               ;SET UP 'X'
21BD 39               (     ttypatch.asm):00247                 RTS
                      (     ttypatch.asm):00248         ;* FILE FORMAT IS INVALID
21BE                  (     ttypatch.asm):00249         LODBAD
21BE 108E23D5         (     ttypatch.asm):00250                 LDY     #BADFIL                           ;POINT TO MESSAGE
21C2 3F               (     ttypatch.asm):00251                 SWI
21C3 34               (     ttypatch.asm):00252                 FCB     52                                ;ISSUE MESSAGE
21C4                  (     ttypatch.asm):00253         LODERR
21C4 7E205F           (     ttypatch.asm):00254                 JMP     MAIN2                             ;AND PROCEED
                      (     ttypatch.asm):00255         ;*
                      (     ttypatch.asm):00256         ;* CLEAR THE RAM DATABASE
                      (     ttypatch.asm):00257         ;*
21C7                  (     ttypatch.asm):00258         CLRAM
21C7 3410             (     ttypatch.asm):00259                 PSHS    X                                 ;SAVE REG
21C9 8E2699           (     ttypatch.asm):00260                 LDX     #IDATA                            ;POINT TO IT
21CC                  (     ttypatch.asm):00261         CLR1
21CC 6F80             (     ttypatch.asm):00262                 CLR     ,X+                               ;ZERO BYTE
21CE 8C2A1D           (     ttypatch.asm):00263                 CMPX    #IEND                             ;ARE WE OVER?
21D1 25F9             (     ttypatch.asm):00264                 BLO     CLR1                              ;NO, KEEP GOING
21D3 3590             (     ttypatch.asm):00265                 PULS    X,PC                              ;RESTORE & RETURN
                      (     ttypatch.asm):00266         ;*
                      (     ttypatch.asm):00267         ;* DISPLAY MENU OF SELECTIONS(X), DATA AREA(U)
                      (     ttypatch.asm):00268         ;*
21D5                  (     ttypatch.asm):00269         DMENU
21D5 3452             (     ttypatch.asm):00270                 PSHS    A,X,U                             ;SAVE REGISTER
21D7                  (     ttypatch.asm):00271         DMENU0
21D7 6FE4             (     ttypatch.asm):00272                 CLR     ,S                                ;ZERO COUNT
21D9 EE61             (     ttypatch.asm):00273                 LDU     1,S                               ;GET TABLE ADDRESS
21DB                  (     ttypatch.asm):00274         DMENU1
21DB A6C4             (     ttypatch.asm):00275                 LDA     ,U                                ;MORE ENTRIES?
21DD 273A             (     ttypatch.asm):00276                 BEQ     DMENU4                            ;NO, NONE
21DF 3F               (     ttypatch.asm):00277                 SWI
21E0 18               (     ttypatch.asm):00278                 FCB     24                                ;SPACE OVER
21E1 20202000         (     ttypatch.asm):00279                 FCN     '   '                             ;OVER
21E5 A6E4             (     ttypatch.asm):00280                 LDA     ,S                                ;GET INDEX CHAR
21E7 8B41             (     ttypatch.asm):00281                 ADDA    #'A'                              ;OFFSET
21E9 3F               (     ttypatch.asm):00282                 SWI
21EA 21               (     ttypatch.asm):00283                 FCB     33                                ;DISPLAY
21EB 3F               (     ttypatch.asm):00284                 SWI
21EC 18               (     ttypatch.asm):00285                 FCB     24                                ;SEPERATOR
21ED 202D2000         (     ttypatch.asm):00286                 FCN     ' - '
21F1 5F               (     ttypatch.asm):00287                 CLRB                                      ;     ZERO COUNT
21F2                  (     ttypatch.asm):00288         DMENU2
21F2 A6C0             (     ttypatch.asm):00289                 LDA     ,U+                               ;GET CHAR
21F4 2705             (     ttypatch.asm):00290                 BEQ     DMENU3                            ;MORE, QUIT
21F6 5C               (     ttypatch.asm):00291                 INCB                                      ;     ADVANCE COUNT
21F7 3F               (     ttypatch.asm):00292                 SWI
21F8 21               (     ttypatch.asm):00293                 FCB     33                                ;DISPLAY
21F9 20F7             (     ttypatch.asm):00294                 BRA     DMENU2                            ;DO THEM ALL
21FB                  (     ttypatch.asm):00295         DMENU3
21FB 3F               (     ttypatch.asm):00296                 SWI
21FC 15               (     ttypatch.asm):00297                 FCB     21                                ;DISPLAY SPACE
21FD 5C               (     ttypatch.asm):00298                 INCB                                      ;     ADVANCE COUNT
21FE C119             (     ttypatch.asm):00299                 CMPB    #NSIZE                            ;ARE WE OVER?
2200 25F9             (     ttypatch.asm):00300                 BLO     DMENU3                            ;DO THEM ALL
2202 3F               (     ttypatch.asm):00301                 SWI
2203 18               (     ttypatch.asm):00302                 FCB     24                                ;SEPERATOR
2204 3A2000           (     ttypatch.asm):00303                 FCN     ': '
2207 A6E4             (     ttypatch.asm):00304                 LDA     ,S                                ;GET ITEM NUMBER
2209 C619             (     ttypatch.asm):00305                 LDB     #ISIZE                            ;GET ITEM SIZE
220B 3D               (     ttypatch.asm):00306                 MUL                                       ;     CALCULATE OFFSET
220C E363             (     ttypatch.asm):00307                 ADDD    3,S                               ;GET ADDRESS
220E 1F01             (     ttypatch.asm):00308                 TFR     D,X                               ;GET ADDRESS
2210 BD2257           (     ttypatch.asm):00309                 JSR     DISDAT                            ;DISPLAY IT
2213 3F               (     ttypatch.asm):00310                 SWI
2214 16               (     ttypatch.asm):00311                 FCB     22                                ;NEW LINE
2215 6CE4             (     ttypatch.asm):00312                 INC     ,S                                ;NEXT ITEM
2217 20C2             (     ttypatch.asm):00313                 BRA     DMENU1                            ;AND PROCEED
                      (     ttypatch.asm):00314         ;* WE HAVE END OF LIST, GET SELECTION
2219                  (     ttypatch.asm):00315         DMENU4
2219 3F               (     ttypatch.asm):00316                 SWI
221A 18               (     ttypatch.asm):00317                 FCB     24                                ;DISPLAY PROMPT
221B 53656C6563743F20 (     ttypatch.asm):00318                 FCN     'Select? '
     00
2224                  (     ttypatch.asm):00319         DMENU5
2224 3F               (     ttypatch.asm):00320                 SWI
2225 22               (     ttypatch.asm):00321                 FCB     34                                ;GET CHAR
2226 810D             (     ttypatch.asm):00322                 CMPA    #$0D                              ;ESCAPE
2228 2729             (     ttypatch.asm):00323                 BEQ     DMENU9                            ;ABORT
222A 1F89             (     ttypatch.asm):00324                 TFR     A,B                               ;GET CHAR
222C C45F             (     ttypatch.asm):00325                 ANDB    #$5F                              ;CONVERT TO UPPER
222E C041             (     ttypatch.asm):00326                 SUBB    #'A'                              ;CONVERT TO OFFSET
2230 E1E4             (     ttypatch.asm):00327                 CMPB    ,S                                ;ARE WE OK
2232 24F0             (     ttypatch.asm):00328                 BHS     DMENU5                            ;NO, REQUEST NEXT
                      (     ttypatch.asm):00329         ;* WE HAVE SELECTION
2234 3404             (     ttypatch.asm):00330                 PSHS    B                                 ;SAVE FOR LATER
2236 AE62             (     ttypatch.asm):00331                 LDX     2,S                               ;GET TEXT PTR BACK
2238                  (     ttypatch.asm):00332         DMENU6
2238 5A               (     ttypatch.asm):00333                 DECB                                      ;     REDUCE COUNT
2239 2B06             (     ttypatch.asm):00334                 BMI     DMENU8                            ;WE HAVE IT
223B                  (     ttypatch.asm):00335         DMENU7
223B A680             (     ttypatch.asm):00336                 LDA     ,X+                               ;GET CHAR
223D 26FC             (     ttypatch.asm):00337                 BNE     DMENU7                            ;PROCEED
223F 20F7             (     ttypatch.asm):00338                 BRA     DMENU6                            ;TEST NEXT
                      (     ttypatch.asm):00339         ;* WE FOUND TITLE
2241                  (     ttypatch.asm):00340         DMENU8
2241 3F               (     ttypatch.asm):00341                 SWI
2242 17               (     ttypatch.asm):00342                 FCB     23                                ;DISPLAY TITLE
2243 3F               (     ttypatch.asm):00343                 SWI
2244 16               (     ttypatch.asm):00344                 FCB     22                                ;NEW LINE
2245 3504             (     ttypatch.asm):00345                 PULS    B                                 ;RESTORE NUMBER
2247 8619             (     ttypatch.asm):00346                 LDA     #ISIZE                            ;GET ITEM SIZE
2249 3D               (     ttypatch.asm):00347                 MUL                                       ;     CALCULATE OFFSET
224A E363             (     ttypatch.asm):00348                 ADDD    3,S                               ;INCLUDE ADDRESS
224C 1F01             (     ttypatch.asm):00349                 TFR     D,X                               ;GET CHAR
224E 8D34             (     ttypatch.asm):00350                 BSR     GETSTR                            ;GET STRING
2250 7E21D7           (     ttypatch.asm):00351                 JMP     DMENU0                            ;NEXT MENU
2253                  (     ttypatch.asm):00352         DMENU9
2253 3F               (     ttypatch.asm):00353                 SWI
2254 16               (     ttypatch.asm):00354                 FCB     22                                ;NEW LINE
2255 35D2             (     ttypatch.asm):00355                 PULS    A,X,U,PC                          ;RESTORE & RETURN
                      (     ttypatch.asm):00356         ;*
                      (     ttypatch.asm):00357         ;* DISPLAY DATA LINE(X)
                      (     ttypatch.asm):00358         ;*
2257                  (     ttypatch.asm):00359         DISDAT
2257 5F               (     ttypatch.asm):00360                 CLRB                                      ;     ZERO COUNT
2258                  (     ttypatch.asm):00361         DISD1
2258 A680             (     ttypatch.asm):00362                 LDA     ,X+                               ;GET CHAR
225A 2727             (     ttypatch.asm):00363                 BEQ     DISD5                             ;END, EXIT
225C 2A20             (     ttypatch.asm):00364                 BPL     DISD4                             ;NORMAL CHAR
225E 1F89             (     ttypatch.asm):00365                 TFR     A,B                               ;'B' = CHAR
2260 3F               (     ttypatch.asm):00366                 SWI
2261 18               (     ttypatch.asm):00367                 FCB     24                                ;OUTPUT
2262 3C00             (     ttypatch.asm):00368                 FCN     '<'
2264 8658             (     ttypatch.asm):00369                 LDA     #'X'                              ;ASSUME 'X'
2266 C540             (     ttypatch.asm):00370                 BITB    #%01000000                        ;TEST
2268 2702             (     ttypatch.asm):00371                 BEQ     DISD2                             ;ASSUMPTION CORRECT
226A 8659             (     ttypatch.asm):00372                 LDA     #'Y'                              ;FIX MISTAKE
226C                  (     ttypatch.asm):00373         DISD2
226C 3F               (     ttypatch.asm):00374                 SWI
226D 21               (     ttypatch.asm):00375                 FCB     33                                ;DISPLAY IT
226E 8642             (     ttypatch.asm):00376                 LDA     #'B'                              ;ASSUME BINARY
2270 C520             (     ttypatch.asm):00377                 BITB    #%00100000                        ;TEST
2272 2702             (     ttypatch.asm):00378                 BEQ     DISD3                             ;ASSUMPTION CORRECT
2274 8644             (     ttypatch.asm):00379                 LDA     #'D'                              ;FIX MISTAKE
2276                  (     ttypatch.asm):00380         DISD3
2276 3F               (     ttypatch.asm):00381                 SWI
2277 21               (     ttypatch.asm):00382                 FCB     33                                ;DISPLAY IT
2278 A680             (     ttypatch.asm):00383                 LDA     ,X+                               ;GET VALUE
227A 3F               (     ttypatch.asm):00384                 SWI
227B 1C               (     ttypatch.asm):00385                 FCB     28                                ;DISPLAY IT
227C 863E             (     ttypatch.asm):00386                 LDA     #'>'                              ;INDICATE SPECIAL
                      (     ttypatch.asm):00387         ;* NORMAL CHAR TO DISPLAY
227E                  (     ttypatch.asm):00388         DISD4
227E BD23B3           (     ttypatch.asm):00389                 JSR     PUTCHR                            ;DISPLAY
2281 20D5             (     ttypatch.asm):00390                 BRA     DISD1                             ;AND BACK
2283                  (     ttypatch.asm):00391         DISD5
2283 39               (     ttypatch.asm):00392                 RTS
                      (     ttypatch.asm):00393         ;*
                      (     ttypatch.asm):00394         ;* READ STRING(X) FROM KEYBOARD WITH SPECIALS
                      (     ttypatch.asm):00395         ;*
2284                  (     ttypatch.asm):00396         GETSTR
2284 5F               (     ttypatch.asm):00397                 CLRB                                      ;     ZERO LOW
2285                  (     ttypatch.asm):00398         GETS1
2285 3F               (     ttypatch.asm):00399                 SWI
2286 22               (     ttypatch.asm):00400                 FCB     34                                ;READ CHARACTER
2287 810D             (     ttypatch.asm):00401                 CMPA    #$0D                              ;SPECIAL CHARACTER
2289 2708             (     ttypatch.asm):00402                 BEQ     GETS2                             ;YES, IT IS
228B A785             (     ttypatch.asm):00403                 STA     B,X                               ;WRITE IT
228D 5C               (     ttypatch.asm):00404                 INCB                                      ;     ADVANCE
228E BD23B3           (     ttypatch.asm):00405                 JSR     PUTCHR                            ;DISPLAY IT
2291 20F2             (     ttypatch.asm):00406                 BRA     GETS1                             ;AND PROCEED
                      (     ttypatch.asm):00407         ;*SPECIAL KEY PRESSED
2293                  (     ttypatch.asm):00408         GETS2
2293 3F               (     ttypatch.asm):00409                 SWI
2294 18               (     ttypatch.asm):00410                 FCB     24                                ;OUTPUT MESSAGE
2295 0A0D             (     ttypatch.asm):00411                 FCB     $0A,$0D
2297 284429656C657465 (     ttypatch.asm):00412                 FCN     '(D)elete (C)ontinue (E)nter-CR (H)exchar (Q)uit '
     202843296F6E7469
     6E7565202845296E
     7465722D43522028
     4829657863686172
     2028512975697420
     00
22C8 8C296E           (     ttypatch.asm):00413                 CMPX    #GDATA                            ;SPECIAL CASE
22CB 2611             (     ttypatch.asm):00414                 BNE     GETS3                             ;NO, ITS NOT
22CD 3F               (     ttypatch.asm):00415                 SWI
22CE 18               (     ttypatch.asm):00416                 FCB     24                                ;MORE TEXT
22CF 2858296F75742028 (     ttypatch.asm):00417                 FCN     '(X)out (Y)out '
     59296F75742000
22DE                  (     ttypatch.asm):00418         GETS3
22DE 863F             (     ttypatch.asm):00419                 LDA     #'?'                              ;PROMPT
22E0 3F               (     ttypatch.asm):00420                 SWI
22E1 21               (     ttypatch.asm):00421                 FCB     33                                ;DISPLAY IT
22E2 3F               (     ttypatch.asm):00422                 SWI
22E3 22               (     ttypatch.asm):00423                 FCB     34                                ;GET CHARACTER
22E4 3F               (     ttypatch.asm):00424                 SWI
22E5 21               (     ttypatch.asm):00425                 FCB     33                                ;ECHO
22E6 845F             (     ttypatch.asm):00426                 ANDA    #$5F                              ;CONVERT TO CAPS
                      (     ttypatch.asm):00427         ;* 'C'ONTINUE ENTRY
22E8 8143             (     ttypatch.asm):00428                 CMPA    #'C'                              ;CONTINUE
22EA 2708             (     ttypatch.asm):00429                 BEQ     GETS3A                            ;YES, PROCEED
                      (     ttypatch.asm):00430         ;* 'D'ELETE PREVIOUS CHARACTER
22EC 8144             (     ttypatch.asm):00431                 CMPA    #'D'                              ;DELETE?
22EE 2611             (     ttypatch.asm):00432                 BNE     GETS4                             ;NO, TRY NEXT
22F0 5D               (     ttypatch.asm):00433                 TSTB                                      ;     AT ZERO?
22F1 2701             (     ttypatch.asm):00434                 BEQ     GETS3A                            ;YES, EXIT
22F3 5A               (     ttypatch.asm):00435                 DECB                                      ;     BACKUP
22F4                  (     ttypatch.asm):00436         GETS3A
22F4 6F85             (     ttypatch.asm):00437                 CLR     B,X                               ;ZERO CHAR
22F6 3F               (     ttypatch.asm):00438                 SWI
22F7 16               (     ttypatch.asm):00439                 FCB     22                                ;NEW LINE
22F8 3414             (     ttypatch.asm):00440                 PSHS    B,X
22FA BD2257           (     ttypatch.asm):00441                 JSR     DISDAT                            ;DISPLAY IT
22FD 3514             (     ttypatch.asm):00442                 PULS    B,X
22FF 2084             (     ttypatch.asm):00443                 BRA     GETS1                             ;AND PROCEED
                      (     ttypatch.asm):00444         ;* 'E' INSERT ESCAPE ECHARACTER
2301                  (     ttypatch.asm):00445         GETS4
2301 8145             (     ttypatch.asm):00446                 CMPA    #'E'                              ;ESCAPE?
2303 2607             (     ttypatch.asm):00447                 BNE     GETS6                             ;NO, TRY NEXT
2305 860D             (     ttypatch.asm):00448                 LDA     #$0D                              ;GET ESCAPE
2307                  (     ttypatch.asm):00449         GETS4A
2307 A785             (     ttypatch.asm):00450                 STA     B,X                               ;SAVE IT
2309 5C               (     ttypatch.asm):00451                 INCB                                      ;     ADVANCE COUNT
230A 20E8             (     ttypatch.asm):00452                 BRA     GETS3A                            ;AND PROCEED
                      (     ttypatch.asm):00453         ;* 'Q'UIT
230C                  (     ttypatch.asm):00454         GETS6
230C 8151             (     ttypatch.asm):00455                 CMPA    #'Q'                              ;QUIT?
230E 2605             (     ttypatch.asm):00456                 BNE     GETS7                             ;NO, TRY NEXT
2310 3F               (     ttypatch.asm):00457                 SWI
2311 16               (     ttypatch.asm):00458                 FCB     22                                ;NEW LINE
2312 6F85             (     ttypatch.asm):00459                 CLR     B,X                               ;ZERO END
2314 39               (     ttypatch.asm):00460                 RTS
                      (     ttypatch.asm):00461         ;* 'H'EXIDECIMAL CHARSCTERS
2315                  (     ttypatch.asm):00462         GETS7
2315 8148             (     ttypatch.asm):00463                 CMPA    #'H'                              ;HEX?
2317 2767             (     ttypatch.asm):00464                 BEQ     GETS10B                           ;YES, ITS OK
                      (     ttypatch.asm):00465         ;* 'X' AND 'Y' OFFSETS
2319 8C296E           (     ttypatch.asm):00466                 CMPX    #GDATA                            ;SPECIAL CASE
231C 2707             (     ttypatch.asm):00467                 BEQ     GETS8                             ;YES
231E                  (     ttypatch.asm):00468         GETS7A
231E 8607             (     ttypatch.asm):00469                 LDA     #7                                ;BEEP
2320 3F               (     ttypatch.asm):00470                 SWI
2321 21               (     ttypatch.asm):00471                 FCB     33                                ;DISPLAY
2322 7E2293           (     ttypatch.asm):00472                 JMP     GETS2                             ;AND PROCEED
2325                  (     ttypatch.asm):00473         GETS8
2325 8158             (     ttypatch.asm):00474                 CMPA    #'X'                              ;IS IT 'X'?
2327 2604             (     ttypatch.asm):00475                 BNE     GETS9                             ;NO, TRY NEXT
2329 8680             (     ttypatch.asm):00476                 LDA     #%10000000                        ;INDICATE 'X' ENTRY
232B 2006             (     ttypatch.asm):00477                 BRA     GETS10                            ;AND PROCEED
232D                  (     ttypatch.asm):00478         GETS9
232D 8159             (     ttypatch.asm):00479                 CMPA    #'Y'                              ;IS IT 'Y'
232F 26ED             (     ttypatch.asm):00480                 BNE     GETS7A                            ;REPORT ERROR
2331 86C0             (     ttypatch.asm):00481                 LDA     #%11000000                        ;INDICATE 'Y' ENTRY
2333                  (     ttypatch.asm):00482         GETS10
2333 3404             (     ttypatch.asm):00483                 PSHS    B                                 ;SAVE IT FOR LATER
2335 1F89             (     ttypatch.asm):00484                 TFR     A,B                               ;'B' = REGISTER
2337 3F               (     ttypatch.asm):00485                 SWI
2338 18               (     ttypatch.asm):00486                 FCB     24                                ;DISPLAY
2339 0A0D             (     ttypatch.asm):00487                 FCB     $0A,$0D                           ;OUTPUT MESSAGE
233B 284229696E617279 (     ttypatch.asm):00488                 FCN     '(B)inary (D)ecimal? '
     202844296563696D
     616C3F2000
2350 3F               (     ttypatch.asm):00489                 SWI
2351 22               (     ttypatch.asm):00490                 FCB     34                                ;GET CHAR
2352 3F               (     ttypatch.asm):00491                 SWI
2353 21               (     ttypatch.asm):00492                 FCB     33                                ;ECHO
2354 845F             (     ttypatch.asm):00493                 ANDA    #$5F                              ;CONVERT TO UPPER
2356 8142             (     ttypatch.asm):00494                 CMPA    #'B'                              ;BINARY
2358 2706             (     ttypatch.asm):00495                 BEQ     GETS10A                           ;YES, ITS OK
235A 8144             (     ttypatch.asm):00496                 CMPA    #'D'                              ;DECIMAL?
235C 26C0             (     ttypatch.asm):00497                 BNE     GETS7A                            ;ERROR
235E CA20             (     ttypatch.asm):00498                 ORB     #%00100000      SET TO 'DECIMAL'
2360                  (     ttypatch.asm):00499         GETS10A
2360 1F98             (     ttypatch.asm):00500                 TFR     B,A                               ;'A' = VALUE
2362 3504             (     ttypatch.asm):00501                 PULS    B                                 ;RESTORE POSITION
2364 A785             (     ttypatch.asm):00502                 STA     B,X                               ;WRITE IT
2366 5C               (     ttypatch.asm):00503                 INCB                                      ;     ADVANCE
2367 3F               (     ttypatch.asm):00504                 SWI
2368 18               (     ttypatch.asm):00505                 FCB     24                                ;OUTPUT MESSAGE
2369 0A0D             (     ttypatch.asm):00506                 FCB     $0A,$0D
236B 4F66667365742076 (     ttypatch.asm):00507                 FCN     'Offset value (hex)? '
     616C756520286865
     78293F2000
2380                  (     ttypatch.asm):00508         GETS10B
2380 8D0D             (     ttypatch.asm):00509                 BSR     GETDIG                            ;GET DIGIT
2382 48               (     ttypatch.asm):00510                 LSLA
2383 48               (     ttypatch.asm):00511                 LSLA
2384 48               (     ttypatch.asm):00512                 LSLA
2385 48               (     ttypatch.asm):00513                 LSLA
2386 3402             (     ttypatch.asm):00514                 PSHS    A
2388 8D05             (     ttypatch.asm):00515                 BSR     GETDIG                            ;GET NEXT
238A AAE0             (     ttypatch.asm):00516                 ORA     ,S+                               ;INCLUDE
238C 7E2307           (     ttypatch.asm):00517                 JMP     GETS4A                            ;AND PROCEED
                      (     ttypatch.asm):00518         ;* GET HEX DIGIT
238F                  (     ttypatch.asm):00519         GETDIG
238F 3F               (     ttypatch.asm):00520                 SWI
2390 22               (     ttypatch.asm):00521                 FCB     34                                ;GET CHAR
2391 8130             (     ttypatch.asm):00522                 CMPA    #'0'                              ;IN RANGE?
2393 2518             (     ttypatch.asm):00523                 BLO     GETD2                             ;ERROR
2395 8139             (     ttypatch.asm):00524                 CMPA    #'9'                              ;IN RANGE?
2397 230F             (     ttypatch.asm):00525                 BLS     GETD1                             ;YES, ITS OK
2399 845F             (     ttypatch.asm):00526                 ANDA    #$5F                              ;CONVERT TO UPPER
239B 8141             (     ttypatch.asm):00527                 CMPA    #'A'                              ;IN RANGE?
239D 250E             (     ttypatch.asm):00528                 BLO     GETD2                             ;ERROR
239F 8146             (     ttypatch.asm):00529                 CMPA    #'F'                              ;IN RANGE?
23A1 220A             (     ttypatch.asm):00530                 BHI     GETD2                             ;NO, ERROR
23A3 3F               (     ttypatch.asm):00531                 SWI
23A4 21               (     ttypatch.asm):00532                 FCB     33                                ;ECHO
23A5 8037             (     ttypatch.asm):00533                 SUBA    #'0'+7                            ;CONVERT
23A7 39               (     ttypatch.asm):00534                 RTS
23A8                  (     ttypatch.asm):00535         GETD1
23A8 3F               (     ttypatch.asm):00536                 SWI
23A9 21               (     ttypatch.asm):00537                 FCB     33                                ;ECHO
23AA 8030             (     ttypatch.asm):00538                 SUBA    #'0'                              ;CONVERT TO BINARY
23AC 39               (     ttypatch.asm):00539                 RTS
23AD                  (     ttypatch.asm):00540         GETD2
23AD 8607             (     ttypatch.asm):00541                 LDA     #7                                ;ERROR
23AF 3F               (     ttypatch.asm):00542                 SWI
23B0 21               (     ttypatch.asm):00543                 FCB     33                                ;DISPLAY
23B1 20DC             (     ttypatch.asm):00544                 BRA     GETDIG                            ;AND PROCEED
                      (     ttypatch.asm):00545         ;*
                      (     ttypatch.asm):00546         ;* DISPLAY CHARACTER IN SPECIAL FORM
                      (     ttypatch.asm):00547         ;*
23B3                  (     ttypatch.asm):00548         PUTCHR
23B3 3402             (     ttypatch.asm):00549                 PSHS    A                                 ;SAVE REG
23B5 8120             (     ttypatch.asm):00550                 CMPA    #' '                              ;CONTROL CODE?
23B7 240A             (     ttypatch.asm):00551                 BHS     PUTC1                             ;NO, TRY NEXT
23B9 865E             (     ttypatch.asm):00552                 LDA     #'^'                              ;INDICATE CONTROL
23BB 3F               (     ttypatch.asm):00553                 SWI
23BC 21               (     ttypatch.asm):00554                 FCB     33                                ;OUTPUT
23BD A6E4             (     ttypatch.asm):00555                 LDA     ,S                                ;GET CHAR
23BF 8B40             (     ttypatch.asm):00556                 ADDA    #'@'                              ;CONVERT
23C1 200E             (     ttypatch.asm):00557                 BRA     PUTC2                             ;AND DISPLAY
23C3                  (     ttypatch.asm):00558         PUTC1
23C3 817F             (     ttypatch.asm):00559                 CMPA    #$7F                              ;IN RANGE?
23C5 250A             (     ttypatch.asm):00560                 BLO     PUTC2                             ;NO, ITS OK
23C7 863C             (     ttypatch.asm):00561                 LDA     #'<'                              ;OPENING
23C9 3F               (     ttypatch.asm):00562                 SWI
23CA 21               (     ttypatch.asm):00563                 FCB     33                                ;DISPLAY
23CB A6E4             (     ttypatch.asm):00564                 LDA     ,S                                ;GET CHAR
23CD 3F               (     ttypatch.asm):00565                 SWI
23CE 1C               (     ttypatch.asm):00566                 FCB     28                                ;DISPLAY
23CF 863E             (     ttypatch.asm):00567                 LDA     #'>'                              ;CLOSING
23D1                  (     ttypatch.asm):00568         PUTC2
23D1 3F               (     ttypatch.asm):00569                 SWI
23D2 21               (     ttypatch.asm):00570                 FCB     33                                ;DISPLAY
23D3 3582             (     ttypatch.asm):00571                 PULS    A,PC                              ;RESTORE & RETURN
                      (     ttypatch.asm):00572         ;*
                      (     ttypatch.asm):00573         ;* MISC. STRINGS AND CONSTANTS
                      (     ttypatch.asm):00574         ;*
23D5                  (     ttypatch.asm):00575         BADFIL
23D5 43616E6E6F74206C (     ttypatch.asm):00576                 FCN     'Cannot locate TTY interface'
     6F63617465205454
     5920696E74657266
     61636500
                      (     ttypatch.asm):00577         ;* MAIN MENU ITEMS
23F1                  (     ttypatch.asm):00578         MMENU
23F1 5374616E64617264 (     ttypatch.asm):00579                 FCN     'Standard key definitions'
     206B657920646566
     696E6974696F6E73
     00
240A 46756E6374696F6E (     ttypatch.asm):00580                 FCN     'Function key definitions'
     206B657920646566
     696E6974696F6E73
     00
2423 436F6E74726F6C20 (     ttypatch.asm):00581                 FCN     'Control code definitions'
     636F646520646566
     696E6974696F6E73
     00
243C 4C6F616420736574 (     ttypatch.asm):00582                 FCN     'Load settings from program'
     74696E6773206672
     6F6D2070726F6772
     616D00
2457 5361766520736574 (     ttypatch.asm):00583                 FCN     'Save settings to program'
     74696E677320746F
     2070726F6772616D
     00
2470 4578697420545459 (     ttypatch.asm):00584                 FCN     'Exit TTYPATCH utility'
     5041544348207574
     696C69747900
2486 00               (     ttypatch.asm):00585                 FCB     0
                      (     ttypatch.asm):00586         ;* OUTPUT STRING NAMES
2487                  (     ttypatch.asm):00587         ONAMES
2487 5465726D696E616C (     ttypatch.asm):00588                 FCN     'Terminal initialization'
     20696E697469616C
     697A6174696F6E00
249F 437572736F722070 (     ttypatch.asm):00589                 FCN     'Cursor positioning'
     6F736974696F6E69
     6E6700
24B2 436C656172207363 (     ttypatch.asm):00590                 FCN     'Clear screen'
     7265656E00
24BF 436C65617220746F (     ttypatch.asm):00591                 FCN     'Clear to end of line'
     20656E64206F6620
     6C696E6500
24D4 436C65617220746F (     ttypatch.asm):00592                 FCN     'Clear to end of screen'
     20656E64206F6620
     73637265656E00
24EB 5370656369616C20 (     ttypatch.asm):00593                 FCN     'Special effect ON'
     656666656374204F
     4E00
24FD 5370656369616C20 (     ttypatch.asm):00594                 FCN     'Special effect OFF'
     656666656374204F
     464600
2510 5363726F6C6C2073 (     ttypatch.asm):00595                 FCN     'Scroll screen forward'
     637265656E20666F
     727761726400
2526 00               (     ttypatch.asm):00596                 FCB     0
                      (     ttypatch.asm):00597         ;* INPUT STRING NAMES
2527                  (     ttypatch.asm):00598         INAMES
2527 437572736F722075 (     ttypatch.asm):00599                 FCN     'Cursor up'
     7000
2531 437572736F722064 (     ttypatch.asm):00600                 FCN     'Cursor down'
     6F776E00
253D 437572736F722072 (     ttypatch.asm):00601                 FCN     'Cursor right'
     6967687400
254A 437572736F72206C (     ttypatch.asm):00602                 FCN     'Cursor left'
     65667400
2556 5061676520757000 (     ttypatch.asm):00603                 FCN     'Page up'
255E 5061676520646F77 (     ttypatch.asm):00604                 FCN     'Page down'
     6E00
2568 5061676520726967 (     ttypatch.asm):00605                 FCN     'Page right'
     687400
2573 50616765206C6566 (     ttypatch.asm):00606                 FCN     'Page left'
     7400
257D 486F6D6500       (     ttypatch.asm):00607                 FCN     'Home'
2582 456E6400         (     ttypatch.asm):00608                 FCN     'End'
2586 44656C6574652063 (     ttypatch.asm):00609                 FCN     'Delete character'
     6861726163746572
     00
2597 44656C6574652070 (     ttypatch.asm):00610                 FCN     'Delete previous'
     726576696F757300
25A7 436C65617200     (     ttypatch.asm):00611                 FCN     'Clear'
25AD 00               (     ttypatch.asm):00612                 FCB     0
                      (     ttypatch.asm):00613         ;* FUNCTION KEY NAMES
25AE                  (     ttypatch.asm):00614         FNAMES
25AE 46756E6374696F6E (     ttypatch.asm):00615                 FCN     'Function key 1'
     206B6579203100
25BD 46756E6374696F6E (     ttypatch.asm):00616                 FCN     'Function key 2'
     206B6579203200
25CC 46756E6374696F6E (     ttypatch.asm):00617                 FCN     'Function key 3'
     206B6579203300
25DB 46756E6374696F6E (     ttypatch.asm):00618                 FCN     'Function key 4'
     206B6579203400
25EA 46756E6374696F6E (     ttypatch.asm):00619                 FCN     'Function key 5'
     206B6579203500
25F9 46756E6374696F6E (     ttypatch.asm):00620                 FCN     'Function key 6'
     206B6579203600
2608 46756E6374696F6E (     ttypatch.asm):00621                 FCN     'Function key 7'
     206B6579203700
2617 46756E6374696F6E (     ttypatch.asm):00622                 FCN     'Function key 8'
     206B6579203800
2626 46756E6374696F6E (     ttypatch.asm):00623                 FCN     'Function key 9'
     206B6579203900
2635 46756E6374696F6E (     ttypatch.asm):00624                 FCN     'Function key 10'
     206B657920313000
2645 46756E6374696F6E (     ttypatch.asm):00625                 FCN     'Function key 11'
     206B657920313100
2655 46756E6374696F6E (     ttypatch.asm):00626                 FCN     'Function key 12'
     206B657920313200
2665 46756E6374696F6E (     ttypatch.asm):00627                 FCN     'Function key 13'
     206B657920313300
2675 46756E6374696F6E (     ttypatch.asm):00628                 FCN     'Function key 14'
     206B657920313400
2685 46756E6374696F6E (     ttypatch.asm):00629                 FCN     'Function key 15'
     206B657920313500
2695 00               (     ttypatch.asm):00630                 FCB     0
                      (     ttypatch.asm):00631         ;*
                      (     ttypatch.asm):00632         ;* MISC VARIABLES
                      (     ttypatch.asm):00633         ;*
2696                  (     ttypatch.asm):00634         FLOAD
2696 2A81             (     ttypatch.asm):00635                 FDB     LOAD                              ;PGM LOAD ADDRESS
2698                  (     ttypatch.asm):00636         FSIZE
2698 00               (     ttypatch.asm):00637                 FCB     0
                      (     ttypatch.asm):00638         ;*
                      (     ttypatch.asm):00639         ;* FUNCTION KEY EDIT AREA
                      (     ttypatch.asm):00640         ;*
2699                  (     ttypatch.asm):00641         IDATA
2699                  (     ttypatch.asm):00642                 RMB     ISIZE*INUM
27DE                  (     ttypatch.asm):00643         FDATA
27DE                  (     ttypatch.asm):00644                 RMB     ISIZE*FNUM
2955                  (     ttypatch.asm):00645         ODATA
2955                  (     ttypatch.asm):00646                 RMB     ISIZE*ONUM
     296E             (     ttypatch.asm):00647         GDATA           = ODATA+ISIZE
2A1D                  (     ttypatch.asm):00648         IEND
2A1D                  (     ttypatch.asm):00649                 RMB     100                               ;END OF INIT, STACK SPACE
     2A81             (     ttypatch.asm):00650         STACK           = *
                      (     ttypatch.asm):00651         ;*
                      (     ttypatch.asm):00652         ;* PROGRAM LOAD ADDRESS
                      (     ttypatch.asm):00653         ;*
     2A81             (     ttypatch.asm):00654         LOAD            = *                               ;LOAD ADDRESS

Symbol Table:
[ G] BADFIL                           23D5
[ G] CLR1                             21CC
[ G] CLRAM                            21C7
[ G] DISD1                            2258
[ G] DISD2                            226C
[ G] DISD3                            2276
[ G] DISD4                            227E
[ G] DISD5                            2283
[ G] DISDAT                           2257
[ G] DMENU                            21D5
[ G] DMENU0                           21D7
[ G] DMENU1                           21DB
[ G] DMENU2                           21F2
[ G] DMENU3                           21FB
[ G] DMENU4                           2219
[ G] DMENU5                           2224
[ G] DMENU6                           2238
[ G] DMENU7                           223B
[ G] DMENU8                           2241
[ G] DMENU9                           2253
[ G] DPREFIX                          0000
[ G] DSKADR                           0013
[ G] FDATA                            27DE
[ G] FLOAD                            2696
[ G] FNAME                            0008
[ G] FNAMES                           25AE
[ G] FNUM                             000F
[ G] FPROT                            0017
[ G] FSIZE                            2698
[ G] FTYPE                            0010
[ G] GDATA                            296E
[ G] GETD1                            23A8
[ G] GETD2                            23AD
[ G] GETDIG                           238F
[ G] GETS1                            2285
[ G] GETS10                           2333
[ G] GETS10A                          2360
[ G] GETS10B                          2380
[ G] GETS2                            2293
[ G] GETS3                            22DE
[ G] GETS3A                           22F4
[ G] GETS4                            2301
[ G] GETS4A                           2307
[ G] GETS6                            230C
[ G] GETS7                            2315
[ G] GETS7A                           231E
[ G] GETS8                            2325
[ G] GETS9                            232D
[ G] GETSTR                           2284
[ G] IDATA                            2699
[ G] IEND                             2A1D
[ G] INAMES                           2527
[ G] INUM                             000D
[ G] ISIZE                            0019
[ G] LDPGM                            2170
[ G] LOAD                             2A81
[ G] LODADR                           0015
[ G] LODBAD                           21BE
[ G] LODERR                           21C4
[ G] MAIN                             2016
[ G] MAIN1                            205C
[ G] MAIN10                           2106
[ G] MAIN10A                          2115
[ G] MAIN10B                          2117
[ G] MAIN10C                          212D
[ G] MAIN10D                          2139
[ G] MAIN10E                          2145
[ G] MAIN11                           215B
[ G] MAIN12                           2161
[ G] MAIN2                            205F
[ G] MAIN3                            2068
[ G] MAIN4                            2083
[ G] MAIN5                            2092
[ G] MAIN6                            20A2
[ G] MAIN7                            20AD
[ G] MAIN9                            20BE
[ G] MAIN9A                           20CC
[ G] MAIN9B                           20D8
[ G] MAIN9C                           20E4
[ G] MAIN9D                           20F3
[ G] MAIN9E                           20F5
[ G] MMENU                            23F1
[ G] NSIZE                            0019
[ G] ODATA                            2955
[ G] ONAMES                           2487
[ G] ONUM                             0008
[ G] OSEND                            DBFF
[ G] OSRAM                            2000
[ G] OSUTIL                           D000
[ G] PUTC1                            23C3
[ G] PUTC2                            23D1
[ G] PUTCHR                           23B3
[ G] STACK                            2A81
[ G] SUBMEN                           20B6
