                      (       search.asm):00001         ;*
                      (       search.asm):00002         ;* SEARCH: Global file search for text or binary strings
                      (       search.asm):00003         ;*
                      (       search.asm):00004         ;* Copyright 1983-2005 Dave Dunfield
                      (       search.asm):00005         ;* All rights reserved.
                      (       search.asm):00006         ;*
                      (       search.asm):00007         ;* DIRECTORY STRUCTURE
     2000             (       search.asm):00008         OSRAM           = $2000                           ;APPLICATION RAM AREA
     DBFF             (       search.asm):00009         OSEND           = $DBFF                           ;END OF GENERAL RAM
     D000             (       search.asm):00010         OSUTIL          = $D000                           ;UTILITY ADDRESS SPACE
                      (       search.asm):00011                 ORG     0
0000                  (       search.asm):00012         DPREFIX
0000                  (       search.asm):00013                 RMB     8
0008                  (       search.asm):00014         DNAME
0008                  (       search.asm):00015                 RMB     8
0010                  (       search.asm):00016         DTYPE
0010                  (       search.asm):00017                 RMB     3
0013                  (       search.asm):00018         DDADR
0013                  (       search.asm):00019                 RMB     2
0015                  (       search.asm):00020         DRADR
0015                  (       search.asm):00021                 RMB     2
0017                  (       search.asm):00022         DATTR
0017                  (       search.asm):00023                 RMB     1
                      (       search.asm):00024         ;* FILE ATTRIBUTES
     0080             (       search.asm):00025         RPERM=%10000000
     0040             (       search.asm):00026         WPERM=%01000000
     0020             (       search.asm):00027         EPERM=%00100000
     0010             (       search.asm):00028         DPERM=%00010000
                      (       search.asm):00029         ;*
     0000             (       search.asm):00030         DIRLOC=0                                          ;DIRECTORY STARTS HERE
                      (       search.asm):00031         ;*
                      (       search.asm):00032                 ORG     OSUTIL                            ;UTILITY SPACE
D000                  (       search.asm):00033         SEARCH
D000 813F             (       search.asm):00034                 CMPA    #'?'                              ;QUERY REQUEST?
D002 2642             (       search.asm):00035                 BNE     QUAL                              ;NO, LOOK FOR QUALIFIERS
D004 3F               (       search.asm):00036                 SWI
D005 19               (       search.asm):00037                 FCB     25
D006 5573653A20534541 (       search.asm):00038                 FCC     'Use: SEARCH[/BINARY/CASE/HEX/TOTAL]'
     5243485B2F42494E
     4152592F43415345
     2F4845582F544F54
     414C5D
D029 203C66696C657370 (       search.asm):00039                 FCN     ' <filespec> <search string>'
     65633E203C736561
     7263682073747269
     6E673E00
D045 39               (       search.asm):00040                 RTS
                      (       search.asm):00041         ;* PERFORM SEARCH
                      (       search.asm):00042         ;* PARSE FOR COMMAND QUALIFIERS
D046                  (       search.asm):00043         QUAL
D046 A6A4             (       search.asm):00044                 LDA     ,Y                                ;GET CHAR FROM COMMAND LINE
D048 812F             (       search.asm):00045                 CMPA    #'/'                              ;IS IT A QUALIFIER?
D04A 265E             (       search.asm):00046                 BNE     MAIN                              ;NO, DO PGM
D04C 308D027D         (       search.asm):00047                 LEAX    QTABLE,PCR      POINT TO QUALIFIER TABLE
D050 3F               (       search.asm):00048                 SWI
D051 12               (       search.asm):00049                 FCB     18                                ;LOOK IT UP
D052 C104             (       search.asm):00050                 CMPB    #QMAX                             ;IS IT IN RANGE
D054 2408             (       search.asm):00051                 BHS     QERR                              ;IF SO, IT'S INVALID
D056 308D028E         (       search.asm):00052                 LEAX    QFLAGS,PCR      POINT TO QUALIFIER FLAGS
D05A 6F85             (       search.asm):00053                 CLR     B,X                               ;SET THE FLAG
D05C 20E8             (       search.asm):00054                 BRA     QUAL                              ;LOOK FOR ANOTHER QUALIFIER
D05E                  (       search.asm):00055         QERR
D05E 3F               (       search.asm):00056                 SWI
D05F 18               (       search.asm):00057                 FCB     24                                ;DISPLAY MESSAGE
D060 496E76616C696420 (       search.asm):00058                 FCN     /Invalid qualifier: '/
     7175616C69666965
     723A202700
D075 A6A0             (       search.asm):00059                 LDA     ,Y+                               ;GET CHARACTER
D077 A6A0             (       search.asm):00060                 LDA     ,Y+                               ;GET CHARACTER
D079 A6A0             (       search.asm):00061                 LDA     ,Y+                               ;GET CHARACTER
D07B A6A0             (       search.asm):00062                 LDA     ,Y+                               ;GET CHARACTER
D07D A6A0             (       search.asm):00063                 LDA     ,Y+                               ;GET CHARACTER
D07F A6A0             (       search.asm):00064                 LDA     ,Y+                               ;GET CHARACTER
D081 A6A0             (       search.asm):00065                 LDA     ,Y+                               ;GET CHARACTER
D083 A6A0             (       search.asm):00066                 LDA     ,Y+                               ;GET CHARACTER
D085 A6A0             (       search.asm):00067                 LDA     ,Y+                               ;GET CHARACTER
D087 A6A0             (       search.asm):00068                 LDA     ,Y+                               ;GET CHARACTER
D089 A6A0             (       search.asm):00069                 LDA     ,Y+                               ;GET CHARACTER
D08B A6A0             (       search.asm):00070                 LDA     ,Y+                               ;GET CHARACTER
D08D A6A0             (       search.asm):00071                 LDA     ,Y+                               ;GET CHARACTER
D08F                  (       search.asm):00072         DSQU1
D08F 3F               (       search.asm):00073                 SWI
D090 21               (       search.asm):00074                 FCB     33                                ;DISPLAY
D091 A6A0             (       search.asm):00075                 LDA     ,Y+                               ;GET NEXT CHAR
D093 270C             (       search.asm):00076                 BEQ     GOABO                             ;NULL IS DELIMITER
D095 812F             (       search.asm):00077                 CMPA    #'/'                              ;START OF ANOTHER QUALIFIER?
D097 2708             (       search.asm):00078                 BEQ     GOABO                             ;IF SO, QUIT
D099 8120             (       search.asm):00079                 CMPA    #' '                              ;SPACE?
D09B 2704             (       search.asm):00080                 BEQ     GOABO                             ;IF SO, QUIT
D09D 810D             (       search.asm):00081                 CMPA    #$0D                              ;END OF LINE?
D09F 26EE             (       search.asm):00082                 BNE     DSQU1                             ;NO, KEEP DUMPING
D0A1                  (       search.asm):00083         GOABO
D0A1 3F               (       search.asm):00084                 SWI
D0A2 19               (       search.asm):00085                 FCB     25                                ;DISPLAY MESSAGE
D0A3 2700             (       search.asm):00086                 FCB     $27,0                             ;CHARACTERS TO DISPLAY
D0A5 8601             (       search.asm):00087                 LDA     #1                                ;INVALID OPERAND RETURN CODE
D0A7 1600B7           (       search.asm):00088                 LBRA    ABORT                             ;GIVE UP
                      (       search.asm):00089         ;* MAIN PROGRAM
D0AA                  (       search.asm):00090         MAIN
D0AA 3F               (       search.asm):00091                 SWI
D0AB 09               (       search.asm):00092                 FCB     9                                 ;GET PATTERN
D0AC 102600B1         (       search.asm):00093                 LBNE    ABORT                             ;BAD, GIVE UP
D0B0 A61F             (       search.asm):00094                 LDA     -1,X                              ;GET DRIVE
D0B2 3F               (       search.asm):00095                 SWI
D0B3 4C               (       search.asm):00096                 FCB     76                                ;Select this drive
D0B4 CED2FF           (       search.asm):00097                 LDU     #BUFFER                           ;POINT TO BUFFER
D0B7 7FD2F6           (       search.asm):00098                 CLR     BUFSIZ                            ;BUFFER SIZE INDICATOR
D0BA 7DD2E8           (       search.asm):00099                 TST     HEX                               ;IS STRING HEX
D0BD 2613             (       search.asm):00100                 BNE     STRIN                             ;NO, INPUT A STRING
                      (       search.asm):00101         ;* INPUT HEX BYTES TO SEARCH FOR
D0BF                  (       search.asm):00102         HEXIN
D0BF 3F               (       search.asm):00103                 SWI
D0C0 07               (       search.asm):00104                 FCB     7                                 ;GET HEX NUMBER
D0C1 1026009C         (       search.asm):00105                 LBNE    ABORT                             ;INVALID, QUIT
D0C5 1F10             (       search.asm):00106                 TFR     X,D                               ;COPY
D0C7 E7C0             (       search.asm):00107                 STB     ,U+                               ;SAVE IT
D0C9 7CD2F6           (       search.asm):00108                 INC     BUFSIZ                            ;ADVANCE SIZE
D0CC 3F               (       search.asm):00109                 SWI
D0CD 04               (       search.asm):00110                 FCB     4                                 ;MORE OPERANDS?
D0CE 26EF             (       search.asm):00111                 BNE     HEXIN                             ;GET NEXT OPERAND
D0D0 2024             (       search.asm):00112                 BRA     GOTOP                             ;WE HAVE OEPRAND
                      (       search.asm):00113         ;* INPUT A STRING VALUE
D0D2                  (       search.asm):00114         STRIN
D0D2 3F               (       search.asm):00115                 SWI
D0D3 04               (       search.asm):00116                 FCB     4                                 ;GET VALUE
D0D4 271B             (       search.asm):00117                 BEQ     BADSTR                            ;ITS BAD
D0D6 3121             (       search.asm):00118                 LEAY    1,Y                               ;SKIP IT
D0D8 B7D2F0           (       search.asm):00119                 STA     TEMP                              ;SAVE
D0DB A1A4             (       search.asm):00120                 CMPA    ,Y                                ;NULL STRING?
D0DD 2712             (       search.asm):00121                 BEQ     BADSTR                            ;ITS BAD
D0DF                  (       search.asm):00122         STR1
D0DF A6A0             (       search.asm):00123                 LDA     ,Y+                               ;GET CHAR FROM STRING
D0E1 270E             (       search.asm):00124                 BEQ     BADSTR                            ;ITS BAD
D0E3 B1D2F0           (       search.asm):00125                 CMPA    TEMP                              ;ARE WE AT END?
D0E6 270E             (       search.asm):00126                 BEQ     GOTOP                             ;WE HAVE IT
D0E8 7CD2F6           (       search.asm):00127                 INC     BUFSIZ                            ;ADVANCE
D0EB A7C0             (       search.asm):00128                 STA     ,U+                               ;SAVE
D0ED 810D             (       search.asm):00129                 CMPA    #$0D                              ;CR?
D0EF 26EE             (       search.asm):00130                 BNE     STR1                              ;NO, ITS OK
                      (       search.asm):00131         ;* STRING OPERAND IS INVALID
D0F1                  (       search.asm):00132         BADSTR
D0F1 3F               (       search.asm):00133                 SWI
D0F2 2B               (       search.asm):00134                 FCB     43                                ;INVALID OPERAND MESSAGE
D0F3 16006B           (       search.asm):00135                 LBRA    ABORT                             ;GO HOME
                      (       search.asm):00136         ;* WE HAVE SEARCH OPERAND
D0F6                  (       search.asm):00137         GOTOP
D0F6 CC0000           (       search.asm):00138                 LDD     #DIRLOC                           ;DIRECTORY STARTS HERE
D0F9                  (       search.asm):00139         SCAND
D0F9 FDD2F2           (       search.asm):00140                 STD     SECTOR                            ;SAVE DIRECTORY SECTOR
D0FC 8ED39F           (       search.asm):00141                 LDX     #DIRBUF                           ;POINT TO FREE SPACE
D0FF 3F               (       search.asm):00142                 SWI
D100 5C               (       search.asm):00143                 FCB     92                                ;READ DISK
D101 1026005C         (       search.asm):00144                 LBNE    ABORT                             ;DISK ERROR
D105                  (       search.asm):00145         SCAND1
D105 3F               (       search.asm):00146                 SWI
D106 13               (       search.asm):00147                 FCB     19                                ;DOES THIS ONE MATCH?
D107 275A             (       search.asm):00148                 BEQ     SCANF                             ;IF SO, SCAN THE FILE
D109                  (       search.asm):00149         NXTDIR
D109 308820           (       search.asm):00150                 LEAX    32,X                              ;SKIP TO NEXT
D10C 8CD59F           (       search.asm):00151                 CMPX    #DIRBUF+512     BEYOND END?
D10F 25F4             (       search.asm):00152                 BLO     SCAND1                            ;NO, WE ARE OK
D111 FCD2F2           (       search.asm):00153                 LDD     SECTOR                            ;GET SECTOR NUMBER
D114 3F               (       search.asm):00154                 SWI
D115 4D               (       search.asm):00155                 FCB     77                                ;GET NEXT SECTOR
D116 26E1             (       search.asm):00156                 BNE     SCAND                             ;CONTINUE IF MORE
D118 FCD2EC           (       search.asm):00157                 LDD     FMATCH                            ;DID ANY FILES MATCH?
D11B 2742             (       search.asm):00158                 BEQ     NOMAT                             ;NO, ERROR
D11D 10830001         (       search.asm):00159                 CMPD    #1                                ;SEARCHED ONLY ONE
D121 2739             (       search.asm):00160                 BEQ     SEREND                            ;IF SO, NO GRAND TOTAL
D123 3F               (       search.asm):00161                 SWI
D124 18               (       search.asm):00162                 FCB     24                                ;DISPLAY MSG
D125 5365617263686564 (       search.asm):00163                 FCN     'Searched '
     2000
D12F 3F               (       search.asm):00164                 SWI
D130 1A               (       search.asm):00165                 FCB     26                                ;DISPLAY
D131 3F               (       search.asm):00166                 SWI
D132 18               (       search.asm):00167                 FCB     24                                ;DISPLAY MSG
D133 2066696C65732C20 (       search.asm):00168                 FCN     ' files, for a total of '
     666F72206120746F
     74616C206F662000
D14B FCD2EE           (       search.asm):00169                 LDD     GMATCH                            ;GET GRAND TOTAL MATCHES
D14E 3F               (       search.asm):00170                 SWI
D14F 1A               (       search.asm):00171                 FCB     26                                ;DISPLAY
D150 3F               (       search.asm):00172                 SWI
D151 19               (       search.asm):00173                 FCB     25                                ;DISPLLY MESSAGE
D152 206D617463686573 (       search.asm):00174                 FCN     ' matches.'
     2E00
D15C                  (       search.asm):00175         SEREND
D15C 4F               (       search.asm):00176                 CLRA                                      ;     ZERO RETURN CODE
D15D 2002             (       search.asm):00177                 BRA     ABORT                             ;QUIT
D15F                  (       search.asm):00178         NOMAT
D15F 3F               (       search.asm):00179                 SWI
D160 2C               (       search.asm):00180                 FCB     44                                ;FILE NOT FOUND
D161                  (       search.asm):00181         ABORT
D161 3F               (       search.asm):00182                 SWI
D162 00               (       search.asm):00183                 FCB     0                                 ;GO HOME
                      (       search.asm):00184         ;* MATCHING FILE WAS FOUND, SEARCH IT
D163                  (       search.asm):00185         SCANF
D163 3410             (       search.asm):00186                 PSHS    X                                 ;SAVE POINTER INTO ENTRY
D165 FCD2EC           (       search.asm):00187                 LDD     FMATCH                            ;FILE MATCH,
D168 C30001           (       search.asm):00188                 ADDD    #1                                ;INCREMENT
D16B FDD2EC           (       search.asm):00189                 STD     FMATCH                            ;RESAVE
D16E 3F               (       search.asm):00190                 SWI
D16F 18               (       search.asm):00191                 FCB     24                                ;DISPLAY MESSAGE
D170 5363616E6E696E67 (       search.asm):00192                 FCN     'Scanning file: '
     2066696C653A2000
D180 3F               (       search.asm):00193                 SWI
D181 1F               (       search.asm):00194                 FCB     31                                ;DISPLAY
D182 A68817           (       search.asm):00195                 LDA     DATTR,X                           ;GET ATTRIBUTES
D185 8580             (       search.asm):00196                 BITA    #RPERM                            ;CAN WE READ
D187 261D             (       search.asm):00197                 BNE     PROTOK
D189 3F               (       search.asm):00198                 SWI
D18A 19               (       search.asm):00199                 FCB     25
D18B 202D2050726F7465 (       search.asm):00200                 FCN     ' - Protection violation'
     6374696F6E207669
     6F6C6174696F6E00
D1A3 16FF63           (       search.asm):00201                 LBRA    NXTDIR                            ;GET NEXT
D1A6                  (       search.asm):00202         PROTOK
D1A6 3F               (       search.asm):00203                 SWI
D1A7 16               (       search.asm):00204                 FCB     22                                ;NEW LINE
D1A8 4F               (       search.asm):00205                 CLRA
D1A9 5F               (       search.asm):00206                 CLRB
D1AA FDD2FD           (       search.asm):00207                 STD     BYTCT                             ;SAVE BYTE COUNT
D1AD FDD2F9           (       search.asm):00208                 STD     NMATCH                            ;SAVE NUMBER OF MATCHES
D1B0 5C               (       search.asm):00209                 INCB
D1B1 FDD2FB           (       search.asm):00210                 STD     LINCT                             ;CURRENT LINE COUNTER
                      (       search.asm):00211         ;* READ SECTORS FROM FILE, AND SCAN THEM
D1B4 EC8813           (       search.asm):00212                 LDD     DDADR,X                           ;GET DISK ADDRESS
D1B7                  (       search.asm):00213         SCSEC
D1B7 FDD2F4           (       search.asm):00214                 STD     FSEC                              ;SAVE
D1BA 8ED59F           (       search.asm):00215                 LDX     #WRKBUF                           ;POINT TO WORK BUFFER
D1BD BFD2F7           (       search.asm):00216                 STX     WRKPTR                            ;SAVE POINTER
D1C0 3F               (       search.asm):00217                 SWI
D1C1 5C               (       search.asm):00218                 FCB     92                                ;READ SECTOR
D1C2 269D             (       search.asm):00219                 BNE     ABORT                             ;INVALID
                      (       search.asm):00220         ;* SCAN 1K SECTOR(X) FOR CONTENTS OF BUFFER
D1C4 108ED34F         (       search.asm):00221                 LDY     #BUFF1                            ;POINT TO BUFFER
D1C8 F6D2F6           (       search.asm):00222                 LDB     BUFSIZ                            ;GET BUFFER SIZE
                      (       search.asm):00223         ;* FILL COMPARE BUFFER FROM FILE
D1CB                  (       search.asm):00224         SCAN1
D1CB 8D79             (       search.asm):00225                 BSR     RDFIL                             ;READ FILE
D1CD A7A0             (       search.asm):00226                 STA     ,Y+                               ;SAVE IN BUFFER
D1CF 5A               (       search.asm):00227                 DECB                                      ;     REDUCE COUNT
D1D0 26F9             (       search.asm):00228                 BNE     SCAN1                             ;CONTINUE
                      (       search.asm):00229         ;* COMPARE COMPARE BUFFER WITH FILE CONTENTS
D1D2                  (       search.asm):00230         SCAN2
D1D2 8ED2FF           (       search.asm):00231                 LDX     #BUFFER                           ;POINT TO BUFFER
D1D5 108ED34F         (       search.asm):00232                 LDY     #BUFF1                            ;POINT TO OTHER BUFFER
D1D9 F6D2F6           (       search.asm):00233                 LDB     BUFSIZ                            ;GET BUFFER SIZE
D1DC                  (       search.asm):00234         SCAN3
D1DC A680             (       search.asm):00235                 LDA     ,X+                               ;GET CHAR FROM BUFFER
D1DE A1A0             (       search.asm):00236                 CMPA    ,Y+                               ;COMPARE WITH OTHER
D1E0 2651             (       search.asm):00237                 BNE     SCAN4                             ;NO MATCH
D1E2 5A               (       search.asm):00238                 DECB                                      ;     REDUCE COUNT
D1E3 26F7             (       search.asm):00239                 BNE     SCAN3                             ;KEEP LOOKING
                      (       search.asm):00240         ;* STRING WAS FOUND
D1E5 FCD2F9           (       search.asm):00241                 LDD     NMATCH                            ;GET NUMBER OF MATCHES
D1E8 C30001           (       search.asm):00242                 ADDD    #1                                ;ADVANCE
D1EB FDD2F9           (       search.asm):00243                 STD     NMATCH                            ;RESAVE
D1EE B6D2EA           (       search.asm):00244                 LDA     TOTAL                             ;IS IT TOTAL ONLY?
D1F1 2740             (       search.asm):00245                 BEQ     SCAN4                             ;YES, DON'T DISPLAY
D1F3 B6D2E9           (       search.asm):00246                 LDA     BINARY                            ;BINARY ONLY?
D1F6 2713             (       search.asm):00247                 BEQ     BINDI                             ;IF DSO, DISPLAY OFFSET ONLY
D1F8 3F               (       search.asm):00248                 SWI
D1F9 18               (       search.asm):00249                 FCB     24                                ;DISPLAY MSG
D1FA 4C696E653A2000   (       search.asm):00250                 FCN     'Line: '
D201 FCD2FB           (       search.asm):00251                 LDD     LINCT                             ;GET LINE COUNTER
D204 3F               (       search.asm):00252                 SWI
D205 1A               (       search.asm):00253                 FCB     26                                ;DISPLAY
D206 3F               (       search.asm):00254                 SWI
D207 18               (       search.asm):00255                 FCB     24                                ;DISPLAY MSG
D208 2C2000           (       search.asm):00256                 FCN     ', '
D20B                  (       search.asm):00257         BINDI
D20B 3F               (       search.asm):00258                 SWI
D20C 18               (       search.asm):00259                 FCB     24
D20D 4F66667365743A20 (       search.asm):00260                 FCN     'Offset: '
     00
D216 F6D2F6           (       search.asm):00261                 LDB     BUFSIZ                            ;GET BUFFER SIZE
D219 4F               (       search.asm):00262                 CLRA                                      ;     ZERO HIGH
D21A 3406             (       search.asm):00263                 PSHS    A,B                               ;SAVE
D21C FCD2FD           (       search.asm):00264                 LDD     BYTCT                             ;GET BYTE COUNT
D21F A3E4             (       search.asm):00265                 SUBD    ,S                                ;CONVERT
D221 EDE4             (       search.asm):00266                 STD     ,S                                ;SAVE
D223 3F               (       search.asm):00267                 SWI
D224 1A               (       search.asm):00268                 FCB     26                                ;DISPLAY
D225 3F               (       search.asm):00269                 SWI
D226 18               (       search.asm):00270                 FCB     24                                ;DISPLAY MESSAGE
D227 20282400         (       search.asm):00271                 FCN     ' ($'
D22B 3506             (       search.asm):00272                 PULS    A,B                               ;RESTORE
D22D 3F               (       search.asm):00273                 SWI
D22E 1B               (       search.asm):00274                 FCB     27                                ;DISPLAY
D22F 3F               (       search.asm):00275                 SWI
D230 19               (       search.asm):00276                 FCB     25                                ;DISPLAY MESSAGE
D231 2900             (       search.asm):00277                 FCN     ')'
D233                  (       search.asm):00278         SCAN4
D233 8ED34F           (       search.asm):00279                 LDX     #BUFF1                            ;POINT TO COMPARE BUFFER
D236 F6D2F6           (       search.asm):00280                 LDB     BUFSIZ                            ;GET SIZE
D239                  (       search.asm):00281         SCAN5
D239 A601             (       search.asm):00282                 LDA     1,X                               ;GET CHAR
D23B A780             (       search.asm):00283                 STA     ,X+                               ;RESAVE
D23D 5A               (       search.asm):00284                 DECB                                      ;     REDUCE COUNT
D23E 26F9             (       search.asm):00285                 BNE     SCAN5                             ;CONTINUE
D240 8D04             (       search.asm):00286                 BSR     RDFIL                             ;READ A CHAR
D242 A71F             (       search.asm):00287                 STA     -1,X                              ;SAVE
D244 208C             (       search.asm):00288                 BRA     SCAN2                             ;CONTINUE
                      (       search.asm):00289         ;*
                      (       search.asm):00290         ;* RDFILE
                      (       search.asm):00291         ;*
D246                  (       search.asm):00292         RDFIL
D246 3414             (       search.asm):00293                 PSHS    B,X                               ;SAVE REG
D248 FCD2FD           (       search.asm):00294                 LDD     BYTCT                             ;GET BYTE COUNT
D24B C30001           (       search.asm):00295                 ADDD    #1                                ;ADVANCE
D24E FDD2FD           (       search.asm):00296                 STD     BYTCT                             ;RESAVE
D251 BED2F7           (       search.asm):00297                 LDX     WRKPTR                            ;GET POINTER
D254 8CD79F           (       search.asm):00298                 CMPX    #WRKBUF+512     ADVANCE
D257 2513             (       search.asm):00299                 BLO     RDFOK                             ;OK
D259 FCD2F4           (       search.asm):00300                 LDD     FSEC                              ;GET FILE SECTOR
D25C 3F               (       search.asm):00301                 SWI
D25D 4D               (       search.asm):00302                 FCB     77                                ;NEW SECTOR?
D25E 2735             (       search.asm):00303                 BEQ     FILEOF                            ;END OF FILE
D260 8ED59F           (       search.asm):00304                 LDX     #WRKBUF                           ;SET IT UP
D263 FDD2F4           (       search.asm):00305                 STD     FSEC                              ;RESAVE
D266 3F               (       search.asm):00306                 SWI
D267 5C               (       search.asm):00307                 FCB     92                                ;READ DISK
D268 1026FEF5         (       search.asm):00308                 LBNE    ABORT                             ;BAD
D26C                  (       search.asm):00309         RDFOK
D26C A680             (       search.asm):00310                 LDA     ,X+                               ;GET CHAR
D26E 2A05             (       search.asm):00311                 BPL     RDFO1                             ;NORMAL
D270 F6D2E9           (       search.asm):00312                 LDB     BINARY                            ;ARE WE TREATING AS BINARY
D273 2620             (       search.asm):00313                 BNE     FILEOF                            ;NO, END OF FILE
D275                  (       search.asm):00314         RDFO1
D275 BFD2F7           (       search.asm):00315                 STX     WRKPTR                            ;RESAVE POINTER
D278 810D             (       search.asm):00316                 CMPA    #$0D                              ;NEW LINE?
D27A 2608             (       search.asm):00317                 BNE     RDF1                              ;NO
D27C BED2FB           (       search.asm):00318                 LDX     LINCT                             ;GET LINE COUNT
D27F 3001             (       search.asm):00319                 LEAX    1,X                               ;ADVANCE
D281 BFD2FB           (       search.asm):00320                 STX     LINCT                             ;RESAVE
D284                  (       search.asm):00321         RDF1
D284 F6D2EB           (       search.asm):00322                 LDB     CASE                              ;IS LOWER CASE CONVERT ENABLED?
D287 260A             (       search.asm):00323                 BNE     RDF2                              ;NO, SKIP IT
D289 8161             (       search.asm):00324                 CMPA    #$61                              ;LOWER CASE?
D28B 2506             (       search.asm):00325                 BLO     RDF2                              ;NO, DON'T CONVERT
D28D 817A             (       search.asm):00326                 CMPA    #$7A                              ;LOWER CASE?
D28F 2202             (       search.asm):00327                 BHI     RDF2                              ;NO, DON'T CONVERT
D291 845F             (       search.asm):00328                 ANDA    #$5F                              ;CONVERT TO UPPER CASE
D293                  (       search.asm):00329         RDF2
D293 3594             (       search.asm):00330                 PULS    B,X,PC
D295                  (       search.asm):00331         FILEOF
D295 3265             (       search.asm):00332                 LEAS    5,S                               ;SKIP SAVED X AND PC
D297 3F               (       search.asm):00333                 SWI
D298 18               (       search.asm):00334                 FCB     24                                ;DISPLAY MESSAGE
D299 546F74616C206F66 (       search.asm):00335                 FCN     'Total of '
     2000
D2A3 FCD2F9           (       search.asm):00336                 LDD     NMATCH                            ;GET NUMBER OF MATCHES
D2A6 3F               (       search.asm):00337                 SWI
D2A7 1A               (       search.asm):00338                 FCB     26                                ;DISPLAY IN DECIMAL
D2A8 3F               (       search.asm):00339                 SWI
D2A9 19               (       search.asm):00340                 FCB     25                                ;DISPLAY MESSAGE
D2AA 206D617463686573 (       search.asm):00341                 FCN     ' matches were found.'
     207765726520666F
     756E642E00
D2BF FCD2EE           (       search.asm):00342                 LDD     GMATCH                            ;GET GRAND MATCH TOTAL
D2C2 F3D2F9           (       search.asm):00343                 ADDD    NMATCH                            ;ADD IN THIS MATCHES
D2C5 FDD2EE           (       search.asm):00344                 STD     GMATCH                            ;SAVE
D2C8 3510             (       search.asm):00345                 PULS    X                                 ;RESTORE POINTER
D2CA 16FE3C           (       search.asm):00346                 LBRA    NXTDIR
                      (       search.asm):00347         ;* STRINGS
D2CD                  (       search.asm):00348         QTABLE
D2CD 82               (       search.asm):00349                 FCB     $82
D2CE 2F484558         (       search.asm):00350                 FCC     '/HEX'                            ;HEX INPUT
D2D2 82               (       search.asm):00351                 FCB     $82
D2D3 2F42494E415259   (       search.asm):00352                 FCC     '/BINARY'       BINARY INPUT FILE
D2DA 82               (       search.asm):00353                 FCB     $82
D2DB 2F544F54414C     (       search.asm):00354                 FCC     '/TOTAL'        TOTAL MATCHES ONLY
D2E1 82               (       search.asm):00355                 FCB     $82
D2E2 2F43415345       (       search.asm):00356                 FCC     '/CASE'                           ;CASE CONVERSION
D2E7 80               (       search.asm):00357                 FCB     $80
     0004             (       search.asm):00358         QMAX            = 4
                      (       search.asm):00359         ;*
     D2E8             (       search.asm):00360         QFLAGS          = *
D2E8                  (       search.asm):00361         HEX
D2E8 FF               (       search.asm):00362                 FCB     $FF                               ;HEX INPUT STRING
D2E9                  (       search.asm):00363         BINARY
D2E9 FF               (       search.asm):00364                 FCB     $FF                               ;BINARY INPUT FILE
D2EA                  (       search.asm):00365         TOTAL
D2EA FF               (       search.asm):00366                 FCB     $FF                               ;DISPLAY TOTALS ONLY
D2EB                  (       search.asm):00367         CASE
D2EB FF               (       search.asm):00368                 FCB     $FF                               ;FORCE CASE CONVERSIONS
                      (       search.asm):00369         ;*
                      (       search.asm):00370         ;* LOCAL STORAGE
                      (       search.asm):00371         ;*
D2EC                  (       search.asm):00372         FMATCH
D2EC 0000             (       search.asm):00373                 FDB     0
D2EE                  (       search.asm):00374         GMATCH
D2EE 0000             (       search.asm):00375                 FDB     0
D2F0                  (       search.asm):00376         TEMP
D2F0                  (       search.asm):00377                 RMB     2
D2F2                  (       search.asm):00378         SECTOR
D2F2                  (       search.asm):00379                 RMB     2
D2F4                  (       search.asm):00380         FSEC
D2F4                  (       search.asm):00381                 RMB     2
D2F6                  (       search.asm):00382         BUFSIZ
D2F6                  (       search.asm):00383                 RMB     1
D2F7                  (       search.asm):00384         WRKPTR
D2F7                  (       search.asm):00385                 RMB     2
D2F9                  (       search.asm):00386         NMATCH
D2F9                  (       search.asm):00387                 RMB     2
D2FB                  (       search.asm):00388         LINCT
D2FB                  (       search.asm):00389                 RMB     2
D2FD                  (       search.asm):00390         BYTCT
D2FD                  (       search.asm):00391                 RMB     2
D2FF                  (       search.asm):00392         BUFFER
D2FF                  (       search.asm):00393                 RMB     80
D34F                  (       search.asm):00394         BUFF1
D34F                  (       search.asm):00395                 RMB     80
D39F                  (       search.asm):00396         DIRBUF
D39F                  (       search.asm):00397                 RMB     512
D59F                  (       search.asm):00398         WRKBUF
D59F                  (       search.asm):00399                 RMB     512

Symbol Table:
[ G] ABORT                            D161
[ G] BADSTR                           D0F1
[ G] BINARY                           D2E9
[ G] BINDI                            D20B
[ G] BUFF1                            D34F
[ G] BUFFER                           D2FF
[ G] BUFSIZ                           D2F6
[ G] BYTCT                            D2FD
[ G] CASE                             D2EB
[ G] DATTR                            0017
[ G] DDADR                            0013
[ G] DIRBUF                           D39F
[ G] DIRLOC                           0000
[ G] DNAME                            0008
[ G] DPERM                            0010
[ G] DPREFIX                          0000
[ G] DRADR                            0015
[ G] DSQU1                            D08F
[ G] DTYPE                            0010
[ G] EPERM                            0020
[ G] FILEOF                           D295
[ G] FMATCH                           D2EC
[ G] FSEC                             D2F4
[ G] GMATCH                           D2EE
[ G] GOABO                            D0A1
[ G] GOTOP                            D0F6
[ G] HEX                              D2E8
[ G] HEXIN                            D0BF
[ G] LINCT                            D2FB
[ G] MAIN                             D0AA
[ G] NMATCH                           D2F9
[ G] NOMAT                            D15F
[ G] NXTDIR                           D109
[ G] OSEND                            DBFF
[ G] OSRAM                            2000
[ G] OSUTIL                           D000
[ G] PROTOK                           D1A6
[ G] QERR                             D05E
[ G] QFLAGS                           D2E8
[ G] QMAX                             0004
[ G] QTABLE                           D2CD
[ G] QUAL                             D046
[ G] RDF1                             D284
[ G] RDF2                             D293
[ G] RDFIL                            D246
[ G] RDFO1                            D275
[ G] RDFOK                            D26C
[ G] RPERM                            0080
[ G] SCAN1                            D1CB
[ G] SCAN2                            D1D2
[ G] SCAN3                            D1DC
[ G] SCAN4                            D233
[ G] SCAN5                            D239
[ G] SCAND                            D0F9
[ G] SCAND1                           D105
[ G] SCANF                            D163
[ G] SCSEC                            D1B7
[ G] SEARCH                           D000
[ G] SECTOR                           D2F2
[ G] SEREND                           D15C
[ G] STR1                             D0DF
[ G] STRIN                            D0D2
[ G] TEMP                             D2F0
[ G] TOTAL                            D2EA
[ G] WPERM                            0040
[ G] WRKBUF                           D59F
[ G] WRKPTR                           D2F7
